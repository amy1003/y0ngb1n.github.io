<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ¨æ–Œçš„åšå®¢</title>
  
  <subtitle>æ¨æ–Œçš„åšå®¢</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://y0ngb1n.github.io/"/>
  <updated>2019-12-28T16:09:58.823Z</updated>
  <id>https://y0ngb1n.github.io/</id>
  
  <author>
    <name>[object Object]</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>åœ¨ Spring Boot é¡¹ç›®ä¸­ä½¿ç”¨ Swagger æ–‡æ¡£</title>
    <link href="https://y0ngb1n.github.io/a/swagger-2-documentation-for-spring-rest-api.html"/>
    <id>https://y0ngb1n.github.io/a/swagger-2-documentation-for-spring-rest-api.html</id>
    <published>2019-12-29T00:08:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®å·²æ‰˜ç®¡äº GitHubï¼š<a href="https://github.com/y0ngb1n/spring-boot-samples" target="_blank" rel="noopener">y0ngb1n/spring-boot-samples</a>ï¼Œæ¬¢è¿ Star, Fork ğŸ˜˜</p><hr><p>Swagger åˆç§°ä¸è¢œå“¥ï¼Œå·ç§°å¯ä»¥è®©ç¨‹åºå‘˜è¾¹å†™ä»£ç è¾¹ç”Ÿäº§æ¥å£æ–‡æ¡£ã€‚</p><h2 id="æ·»åŠ -swagger-2-ä¾èµ–"><a class="markdownIt-Anchor" href="#æ·»åŠ -swagger-2-ä¾èµ–"></a> æ·»åŠ  Swagger 2 ä¾èµ–</h2><p>åœ¨ <code>pom.xml</code> ä¸­æ·»åŠ  Swagger 2 æ‰€éœ€ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ -swagger-çš„-java-é…ç½®"><a class="markdownIt-Anchor" href="#æ·»åŠ -swagger-çš„-java-é…ç½®"></a> æ·»åŠ  Swagger çš„ Java é…ç½®</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger</span>2</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Docket <span class="title">api</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">      .apiInfo(apiInfo())</span><br><span class="line">      .select()</span><br><span class="line">      .apis(RequestHandlerSelectors.any())</span><br><span class="line">      .paths(PathSelectors.any())</span><br><span class="line">      .build();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="swagger-æ³¨è§£è¯´æ˜"><a class="markdownIt-Anchor" href="#swagger-æ³¨è§£è¯´æ˜"></a> Swagger æ³¨è§£è¯´æ˜</h3><p>Swagger é€šè¿‡æ³¨è§£è¡¨æ˜è¯¥æ¥å£ä¼šç”Ÿæˆæ–‡æ¡£ï¼ŒåŒ…æ‹¬æ¥å£åã€è¯·æ±‚æ–¹æ³•ã€å‚æ•°ã€è¿”å›ä¿¡æ¯çš„ç­‰ç­‰ã€‚</p><ul><li><code>@Api</code>ï¼šä¿®é¥°æ•´ä¸ªç±»ï¼Œæè¿° Controller çš„ä½œç”¨</li><li><code>@ApiOperation</code>ï¼šæè¿°ä¸€ä¸ªç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ–è€…è¯´ä¸€ä¸ªæ¥å£</li><li><code>@ApiParam</code>ï¼šå•ä¸ªå‚æ•°æè¿°</li><li><code>@ApiModel</code>ï¼šç”¨å¯¹è±¡æ¥æ¥æ”¶å‚æ•°</li><li><code>@ApiProperty</code>ï¼šç”¨å¯¹è±¡æ¥æ”¶å‚æ•°æ—¶ï¼Œæè¿°å¯¹è±¡çš„ä¸€ä¸ªå­—æ®µ</li><li><code>@ApiResponse</code>ï¼šHTTP å“åº”å…¶ä¸­ 1 ä¸ªæè¿°</li><li><code>@ApiResponses</code>ï¼šHTTP å“åº”æ•´ä½“æè¿°</li><li><code>@ApiIgnore</code>ï¼šä½¿ç”¨è¯¥æ³¨è§£å¿½ç•¥è¿™ä¸ªAPI</li><li><code>@ApiImplicitParam</code>ï¼šä¸€ä¸ªè¯·æ±‚å‚æ•°</li><li><code>@ApiImplicitParams</code>ï¼šå¤šä¸ªè¯·æ±‚å‚æ•°</li></ul><p>ä»¥ä¸Šè¿™äº›å°±æ˜¯æœ€å¸¸ç”¨çš„å‡ ä¸ªæ³¨è§£äº†ã€‚</p><p>å…·ä½“å…¶ä»–çš„æ³¨è§£ï¼ŒæŸ¥çœ‹ï¼š<a href="https://github.com/swagger-api/swagger-core/wiki/Annotations" target="_blank" rel="noopener">https://github.com/swagger-api/swagger-core/wiki/Annotations</a></p><p>æ›´å¤šè¯·å‚è€ƒ <a href="http://docs.swagger.io/swagger-core/apidocs/com/wordnik/swagger/annotations/package-summary.html" target="_blank" rel="noopener">Swagger æ³¨è§£æ–‡æ¡£</a></p><h3 id="æ·»åŠ -controller-model-æ¥æµ‹è¯•æ•ˆæœ"><a class="markdownIt-Anchor" href="#æ·»åŠ -controller-model-æ¥æµ‹è¯•æ•ˆæœ"></a> æ·»åŠ  Controllerã€Model æ¥æµ‹è¯•æ•ˆæœ</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Api</span>(value = <span class="string">"ç”¨æˆ·ç®¡ç†"</span>, description = <span class="string">"ç”¨æˆ·ä¿¡æ¯çš„ã€Œå¢ã€åˆ ã€æŸ¥ã€æ”¹ã€æ“ä½œ"</span>)</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(path = <span class="string">"/sample/users"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;Long, UserModel&gt; users = Collections.synchronizedMap(<span class="keyword">new</span> HashMap&lt;&gt;());</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ApiOperation</span>(value = <span class="string">"ç”¨æˆ·åˆ—è¡¨"</span>)</span><br><span class="line">  <span class="meta">@GetMapping</span>(path = <span class="string">"/"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;UserModel&gt; <span class="title">getUserList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;(users.values());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ApiOperation</span>(value = <span class="string">"åˆ›å»ºç”¨æˆ·"</span>, notes = <span class="string">"æ ¹æ® User å¯¹è±¡åˆ›å»ºç”¨æˆ·"</span>)</span><br><span class="line">  <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"user"</span>, value = <span class="string">"ç”¨æˆ·è¯¦ç»†å®ä½“"</span>, required = <span class="keyword">true</span>, dataTypeClass = UserModel.class)</span><br><span class="line">  <span class="meta">@PostMapping</span>(path = <span class="string">"/"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> UserModel <span class="title">createUser</span><span class="params">(@RequestBody UserModel user)</span> </span>&#123;</span><br><span class="line">    users.put(user.getId(), user);</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ApiOperation</span>(value = <span class="string">"ç”¨æˆ·è¯¦ç»†ä¿¡æ¯"</span>, notes = <span class="string">"æ ¹æ® ID è·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯"</span>)</span><br><span class="line">  <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"id"</span>, value = <span class="string">"ç”¨æˆ· ID"</span>, required = <span class="keyword">true</span>, dataType = <span class="string">"Long"</span>)</span><br><span class="line">  <span class="meta">@GetMapping</span>(path = <span class="string">"/&#123;id&#125;"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> UserModel <span class="title">getUser</span><span class="params">(@PathVariable Long id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> users.get(id);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ApiOperation</span>(value = <span class="string">"æ›´æ–°ç”¨æˆ·è¯¦ç»†ä¿¡æ¯"</span>, notes = <span class="string">"æ ¹æ® ID æŒ‡å®šæ›´æ–°å¯¹è±¡, å¹¶æ ¹æ® User ä¿¡æ¯æ¥æ›´æ–°ç”¨æˆ·è¯¦ç»†ä¿¡æ¯"</span>)</span><br><span class="line">  <span class="meta">@ApiImplicitParams</span>(&#123;</span><br><span class="line">      <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"id"</span>, value = <span class="string">"ç”¨æˆ· ID"</span>, required = <span class="keyword">true</span>, dataTypeClass = Long.class),</span><br><span class="line">      <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"user"</span>, value = <span class="string">"ç”¨æˆ·è¯¦ç»†å®ä½“"</span>, required = <span class="keyword">true</span>, dataTypeClass = UserModel.class)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="meta">@PutMapping</span>(path = <span class="string">"/&#123;id&#125;"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> UserModel <span class="title">updateUser</span><span class="params">(@PathVariable Long id, @RequestBody UserModel user)</span> </span>&#123;</span><br><span class="line">    UserModel updateUser = users.get(id);</span><br><span class="line">    updateUser.setName(user.getName());</span><br><span class="line">    updateUser.setAge(user.getAge());</span><br><span class="line">    updateUser.setEmail(user.getEmail());</span><br><span class="line">    users.put(id, updateUser);</span><br><span class="line">    <span class="keyword">return</span> updateUser;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ApiOperation</span>(value = <span class="string">"åˆ é™¤ç”¨æˆ·"</span>, notes = <span class="string">"æ ¹æ® ID æŒ‡å®šåˆ é™¤å¯¹è±¡"</span>)</span><br><span class="line">  <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"id"</span>, value = <span class="string">"ç”¨æˆ· ID"</span>, required = <span class="keyword">true</span>, dataType = <span class="string">"Long"</span>)</span><br><span class="line">  <span class="meta">@DeleteMapping</span>(path = <span class="string">"/&#123;id&#125;"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">deleteUser</span><span class="params">(@PathVariable Long id)</span> </span>&#123;</span><br><span class="line">    users.remove(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel</span>(value = <span class="string">"ç”¨æˆ·æ¨¡å‹"</span>, description = <span class="string">"ç”¨æˆ·è¯¦ç»†ä¿¡æ¯å®ä½“ç±»"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserModel</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ApiModelProperty</span>(value = <span class="string">"ç”¨æˆ· ID"</span>)</span><br><span class="line">  <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ApiModelProperty</span>(value = <span class="string">"åå­—"</span>, allowableValues = <span class="string">"y0ngb1n, tony"</span>)</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ApiModelProperty</span>(value = <span class="string">"å¹´é¾„"</span>, allowableValues = <span class="string">"range[1, 120]"</span>)</span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ApiModelProperty</span>(value = <span class="string">"é‚®ç®±"</span>)</span><br><span class="line">  <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥å¯åŠ¨é¡¹ç›®è¿›è¡ŒéªŒè¯æ˜¯å¦æˆåŠŸé›†æˆ Swagger 2 äº†ï¼Œå¯åŠ¨é¡¹ç›®åï¼Œåœ¨æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ° Swagger ä¸ºæˆ‘ä»¬æ·»åŠ äº†è®¿é—®ç«¯ç‚¹ <code>/v2/api-docs</code>ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">2019-12-28 22:19:53.880  INFO 11935 --- [main] pertySourcedRequestMappingHandlerMapping : Mapped URL path [/v2/api-docs] onto method [public org.springframework.http.ResponseEntity&lt;springfox.documentation.spring.web.json.Json&gt; springfox.documentation.swagger2.web.Swagger2Controller.getDocumentation(java.lang.String,javax.servlet.http.HttpServletRequest)]</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>é€šè¿‡æµè§ˆå™¨è®¿é—® <code>http://localhost:8080/v2/api-docs</code>ï¼Œå¯ä»¥å‘ç°è¿”å›çš„ç»“æœæ˜¯ä¸€æ®µ JSON ä¸²ï¼Œå¯è¯»æ€§éå¸¸å·®ã€‚å¹¸è¿çš„æ˜¯ Swagger 2 ä¸ºæˆ‘ä»¬æä¾›äº†å¯è§†åŒ–çš„äº¤äº’ç•Œé¢ SwaggerUIï¼Œä¸‹é¢æˆ‘ä»¬å°±ä¸€èµ·æ¥è¯•è¯•å§ã€‚</p><h2 id="æ·»åŠ -swagger-ui-ä¾èµ–"><a class="markdownIt-Anchor" href="#æ·»åŠ -swagger-ui-ä¾èµ–"></a> æ·»åŠ  Swagger UI ä¾èµ–</h2><p>åŒä¸Šé¢ä¸€æ ·ï¼Œåœ¨ <code>pom.xml</code> ä¸­æ·»åŠ  Swagger UI æ‰€éœ€ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ·»åŠ å®Œæˆåï¼Œé‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—® <code>http://localhost:8080/swagger-ui.html</code>ï¼Œä¾¿ä»¥çœ‹åˆ°ä¸‹é¢å°±æ•ˆæœï¼š</p><p><img src="https://i.loli.net/2019/12/28/ZfvNclUYmoLpkPb.png" alt="Swagger 2"></p><p>åˆ°è¿™é‡Œå°±é›†æˆ Swagger æˆåŠŸäº†ï¼Œæ›´å¤šé«˜é˜¶çš„æ“ä½œå°±ç­‰ç»§ç»­çœ‹æ–‡æ¡£æˆ–ä¸‹é¢çš„å‚è€ƒé“¾æ¥è¿›ä¸€æ­¥æ‘¸ç´¢äº†ï¼Œç¥å­¦ä¹ æ„‰å¿«ï¼</p><h2 id="ï¸-å‚è€ƒé“¾æ¥"><a class="markdownIt-Anchor" href="#ï¸-å‚è€ƒé“¾æ¥"></a> ğŸ”—ï¸ å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://www.baeldung.com/swagger-2-documentation-for-spring-rest-api" target="_blank" rel="noopener">https://www.baeldung.com/swagger-2-documentation-for-spring-rest-api</a></li><li><a href="https://www.tutorialspoint.com/spring_boot/spring_boot_enabling_swagger2.htm" target="_blank" rel="noopener">https://www.tutorialspoint.com/spring_boot/spring_boot_enabling_swagger2.htm</a></li><li><a href="http://blog.didispace.com/tags/Swagger/" target="_blank" rel="noopener">http://blog.didispace.com/tags/Swagger/</a></li><li><a href="https://www.ibm.com/developerworks/cn/java/j-using-swagger-in-a-spring-boot-project/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/java/j-using-swagger-in-a-spring-boot-project/index.html</a></li><li><a href="https://mp.weixin.qq.com/s/EYnL7T0yOgNXYIrBWBg8hg" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/EYnL7T0yOgNXYIrBWBg8hg</a></li><li><a href="https://github.com/dyc87112/swagger-butler" target="_blank" rel="noopener">https://github.com/dyc87112/swagger-butler</a></li><li><a href="https://github.com/SpringForAll/spring-boot-starter-swagger" target="_blank" rel="noopener">https://github.com/SpringForAll/spring-boot-starter-swagger</a></li><li><a href="https://blog.csdn.net/lilyssh/article/details/82944507" target="_blank" rel="noopener">https://blog.csdn.net/lilyssh/article/details/82944507</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;é¡¹ç›®å·²æ‰˜ç®¡äº GitHubï¼š&lt;a href=&quot;https://github.com/y0ngb1n/spring-boot-samples&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;y0ngb1n/spring-boot-samples&lt;/a&gt;ï¼Œæ¬¢è¿ 
      
    
    </summary>
    
    
      <category term="spring-boot" scheme="https://y0ngb1n.github.io/tags/spring-boot/"/>
    
      <category term="swagger" scheme="https://y0ngb1n.github.io/tags/swagger/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ Prometheus &amp; Grafana ç›‘æ§ä½ çš„ Spring Boot åº”ç”¨</title>
    <link href="https://y0ngb1n.github.io/a/monitoring-your-springboot-app-with-prometheus-grafana.html"/>
    <id>https://y0ngb1n.github.io/a/monitoring-your-springboot-app-with-prometheus-grafana.html</id>
    <published>2019-12-28T19:03:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®å·²æ‰˜ç®¡äº GitHubï¼š<a href="https://github.com/y0ngb1n/spring-boot-samples" target="_blank" rel="noopener">y0ngb1n/spring-boot-samples</a>ï¼Œæ¬¢è¿ Star, Fork ğŸ˜˜</p><hr><h2 id="å‡†å¤‡å·¥ä½œ"><a class="markdownIt-Anchor" href="#å‡†å¤‡å·¥ä½œ"></a> å‡†å¤‡å·¥ä½œ</h2><ul><li>Prometheus <code>v2.14.0</code></li><li>Grafana <code>v6.5.0</code></li></ul><p>ä½¿ç”¨ Docker éƒ¨ç½²ä¸Šé¢çš„åŸºç¡€ç¯å¢ƒï¼Œé…ç½®æ–‡ä»¶å¯è§ <a href="./docker-compose.yml"><code>docker-compose.yml</code></a>ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿›è¡Œä¸€é”®éƒ¨ç½²ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ£€æŸ¥é…ç½®</span></span><br><span class="line">docker-compose config</span><br><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡ï¼ˆ-d åå°å¯åŠ¨ï¼‰</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"><span class="comment"># åœæ­¢å¹¶æ¸…é™¤æœåŠ¡</span></span><br><span class="line">docker-compose down</span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ ä¾èµ–é¡¹"><a class="markdownIt-Anchor" href="#æ·»åŠ ä¾èµ–é¡¹"></a> æ·»åŠ ä¾èµ–é¡¹</h2><p><code>pom.xml</code></p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- å€ŸåŠ© Micrometer å¯¹æ¥ Prometheus ç›‘æ§ç³»ç»Ÿ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-registry-prometheus<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>application.yml</code></p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  application:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">monitoring-prometheus-grafana</span></span><br><span class="line"></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line"><span class="attr">  endpoints:</span></span><br><span class="line"><span class="attr">    web:</span></span><br><span class="line"><span class="attr">      exposure:</span></span><br><span class="line">        <span class="comment"># å°† Actuator çš„ /actuator/prometheus ç«¯ç‚¹æš´éœ²å‡ºæ¥</span></span><br><span class="line"><span class="attr">        include:</span> <span class="string">'prometheus'</span></span><br><span class="line"><span class="attr">  metrics:</span></span><br><span class="line"><span class="attr">    tags:</span> </span><br><span class="line"><span class="attr">      application:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="attr">  level:</span></span><br><span class="line">    <span class="string">io.github.y0ngb1n.*:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æ–¹å¼"><a class="markdownIt-Anchor" href="#ä½¿ç”¨æ–¹å¼"></a> ä½¿ç”¨æ–¹å¼</h2><p><strong>Step 1: å¯åŠ¨æœåŠ¡</strong></p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> mvn spring-boot:run</span></span><br><span class="line">...</span><br><span class="line">2019-12-08 22:28:11.916  INFO 36157 --- [           main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'</span><br><span class="line">2019-12-08 22:28:12.045  INFO 36157 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''</span><br><span class="line">2019-12-08 22:28:12.050  INFO 36157 --- [           main] i.g.y.m.p.PrometheusGrafanaApplication   : Started PrometheusGrafanaApplication in 20.638 seconds (JVM running for 27.154)</span><br></pre></td></tr></table></figure><p><strong>Step 2: è®¿é—® <code>/actuator/prometheus</code> ç«¯å£</strong></p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -sS http://127.0.0.1:8080/actuator/prometheus</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> HELP jvm_gc_memory_promoted_bytes_total Count of positive increases <span class="keyword">in</span> the size of the old generation memory pool before GC to after GC</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TYPE jvm_gc_memory_promoted_bytes_total counter</span></span><br><span class="line">jvm_gc_memory_promoted_bytes_total&#123;application="monitoring-prometheus-grafana",&#125; 9986992.0</span><br><span class="line"><span class="meta">#</span><span class="bash"> HELP jvm_threads_daemon_threads The current number of live daemon threads</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TYPE jvm_threads_daemon_threads gauge</span></span><br><span class="line">jvm_threads_daemon_threads&#123;application="monitoring-prometheus-grafana",&#125; 30.0</span><br><span class="line"><span class="meta">#</span><span class="bash"> HELP process_uptime_seconds The uptime of the Java virtual machine</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TYPE process_uptime_seconds gauge</span></span><br><span class="line">process_uptime_seconds&#123;application="monitoring-prometheus-grafana",&#125; 75.133</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h2 id="å°†åº”ç”¨ä¸-prometheus-å¯¹æ¥"><a class="markdownIt-Anchor" href="#å°†åº”ç”¨ä¸-prometheus-å¯¹æ¥"></a> å°†åº”ç”¨ä¸ Prometheus å¯¹æ¥</h2><p>æ·»åŠ  Prometheus çš„é…ç½®æ–‡ä»¶ï¼š<a href="./prometheus.yml"><code>prometheus.yml</code></a></p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="comment"># ä»»æ„å†™ï¼Œå»ºè®®è‹±æ–‡ï¼Œä¸è¦åŒ…å«ç‰¹æ®Šå­—ç¬¦</span></span><br><span class="line"><span class="attr">  - job_name:</span> <span class="string">'spring-boot-app'</span></span><br><span class="line">    <span class="comment"># å¤šä¹…é‡‡é›†ä¸€æ¬¡æ•°æ®</span></span><br><span class="line"><span class="attr">    scrape_interval:</span> <span class="number">15</span><span class="string">s</span></span><br><span class="line">    <span class="comment"># é‡‡é›†æ—¶çš„è¶…æ—¶æ—¶é—´</span></span><br><span class="line"><span class="attr">    scrape_timeout:</span> <span class="number">10</span><span class="string">s</span></span><br><span class="line">    <span class="comment"># é‡‡é›†çš„è·¯å¾„æ˜¯å•¥</span></span><br><span class="line"><span class="attr">    metrics_path:</span> <span class="string">'/actuator/prometheus'</span></span><br><span class="line">    <span class="comment"># é‡‡é›†æœåŠ¡çš„åœ°å€ï¼Œè®¾ç½®æˆ Spring Boot åº”ç”¨æ‰€åœ¨æœåŠ¡å™¨çš„å…·ä½“åœ°å€</span></span><br><span class="line"><span class="attr">    static_configs:</span></span><br><span class="line"><span class="attr">      - targets:</span> <span class="string">['192.168.31.44:8080']</span></span><br></pre></td></tr></table></figure><p>å¯ä½¿ç”¨ <code>ifconfig</code> æŸ¥çœ‹å®¿ä¸»æœºçš„ IP åœ°å€ï¼ŒPrometheus æœåŠ¡å™¨å°±ä¼šè‡ªåŠ¨æ¯éš”15ç§’è¯·æ±‚ <code>http://your-ip:8080/actuator/prometheus</code>ã€‚æ›´å¤šé…ç½®å‚è§ ğŸ‘‰<a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p><h3 id="æµ‹è¯•è®¿é—®-prometheus"><a class="markdownIt-Anchor" href="#æµ‹è¯•è®¿é—®-prometheus"></a> æµ‹è¯•è®¿é—® Prometheus</h3><p><strong>STEP 1</strong>ï¼šåœ¨æµè§ˆå™¨ä¸­è®¿é—® <code>http://localhost:9090</code></p><p><img src="https://i.loli.net/2019/12/08/D5lS8X7nJTAdyqe.png" alt="http://localhost:9090/graph" title="http://localhost:9090/graph"></p><p><strong>STEP 2</strong>ï¼šæŸ¥çœ‹ç›‘æ§æ•°æ®</p><ul><li>ç‚¹å‡» <code>Insert metric at cursor</code>ï¼Œå³å¯é€‰æ‹©ç›‘æ§æŒ‡æ ‡ï¼›</li><li>ç‚¹å‡» <code>Graph</code>ï¼Œå³å¯è®©æŒ‡æ ‡ä»¥å›¾è¡¨æ–¹å¼å±•ç¤ºï¼›</li><li>ç‚¹å‡» <code>Execute</code> æŒ‰é’®ï¼Œå³å¯çœ‹åˆ°ç±»ä¼¼ä¸‹å›¾çš„ç»“æœã€‚</li></ul><p><img src="https://i.loli.net/2019/12/08/UAsulByFPcC259M.png" alt="æŸ¥çœ‹ç›‘æ§æ•°æ®"></p><h2 id="é›†æˆ-grafana-å¯è§†åŒ–"><a class="markdownIt-Anchor" href="#é›†æˆ-grafana-å¯è§†åŒ–"></a> é›†æˆ Grafana å¯è§†åŒ–</h2><p>å‰é¢å·²ç»ä½¿ç”¨ <code>docker-compose</code> å¯åŠ¨äº† Grafanaï¼Œä¸‹é¢è¿›è¡Œé…ç½®ã€‚</p><p><strong>STEP 1</strong>ï¼šåœ¨æµè§ˆå™¨ä¸­è®¿é—® <code>http://localhost:3000</code>ï¼Œå¹¶ä½¿ç”¨åˆå§‹å¸å· <code>admin:admin</code> è¿›è¡Œç™»å½•</p><p><img src="https://i.loli.net/2019/12/28/kOZQLWhla1U5JzF.png" alt="Grafana Login Page"></p><p><strong>STEP 2</strong>ï¼šç‚¹å‡» <code>Add Data Source</code> è¿›è¡Œæ·»åŠ  Prometheus æ•°æ®æº</p><p><img src="https://i.loli.net/2019/12/28/FT9GiJ1uMz4ave2.png" alt="Add Data Source"></p><p><img src="https://i.loli.net/2019/12/28/BrbNdkWj7IUMA8O.png" alt="Prometheus Data Source"></p><p><img src="https://i.loli.net/2019/12/28/hQqbtoIRC1HuFBJ.png" alt="image.png"></p><p><strong>STEP 3</strong>ï¼šåˆ›å»º Dashboard</p><p><img src="https://i.loli.net/2019/12/28/iDkbPXwyvEVz6Jm.png" alt="New Dashboard"></p><p><img src="https://i.loli.net/2019/12/28/JdyO7aiwQgKjpqh.png" alt="Add Query"></p><ul><li>è®¾ç½®ç›‘æ§æŒ‡æ ‡</li></ul><p><img src="https://i.loli.net/2019/12/28/qE9TnzV4XkJaG3f.png" alt="Add Query"></p><ul><li>è®¾ç½® Dashboard ä¿¡æ¯</li></ul><p><img src="https://i.loli.net/2019/12/28/CfDSj3mV9HNt6rT.png" alt="Title"></p><ul><li>ä¿å­˜ Dashboard</li></ul><p><img src="https://i.loli.net/2019/12/28/BL9pnfAt6acK8HX.png" alt="Save Dashboard"></p><p>å¯ä»¥æ·»åŠ ä¸åŒçš„æŒ‡æ ‡ï¼ŒæŒ‡æ ‡çš„å–å€¼è¯¦è§ Spring Boot åº”ç”¨çš„ <code>/actuator/prometheus</code> ç«¯ç‚¹ã€‚é‡å¤ä»¥ä¸Šæ­¥éª¤æ“ä½œï¼Œå³å¯ä¸º Dashboard æ·»åŠ æ–°çš„å›¾è¡¨ã€‚</p><p>å¦‚æœä½ è§‰å¾—è‡ªå·±å®šåˆ¶ä¸€ä¸ª Dashboard è¿‡äºå¤æ‚äº†ï¼Œé‚£ä½ å¯ä»¥é€›ä¸€ä¸‹ <a href="https://grafana.com/grafana/dashboards" target="_blank" rel="noopener">Grafana çš„ Dashboard å¸‚åœº</a>ï¼ˆ<a href="https://grafana.com/grafana/dashboards%EF%BC%89%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%96%B9%E4%BE%BF%E5%BF%AB%E6%8D%B7%E5%9C%B0%E5%A4%8D%E7%94%A8%E5%88%AB%E4%BA%BA%E7%B2%BE%E7%BE%8E%E7%9A%84" target="_blank" rel="noopener">https://grafana.com/grafana/dashboardsï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥æ–¹ä¾¿å¿«æ·åœ°å¤ç”¨åˆ«äººç²¾ç¾çš„</a> Dashboard é¢æ¿äº†ã€‚</p><p><img src="https://grafana.com/static/img/grafana/showcase_visualize.jpg" alt="Demo"></p><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://www.callicoder.com/spring-boot-actuator-metrics-monitoring-dashboard-prometheus-grafana/" target="_blank" rel="noopener">https://www.callicoder.com/spring-boot-actuator-metrics-monitoring-dashboard-prometheus-grafana/</a></li><li><a href="http://www.itmuch.com/spring-boot/actuator-prometheus-grafana/%EF%BC%8Cby" target="_blank" rel="noopener">http://www.itmuch.com/spring-boot/actuator-prometheus-grafana/ï¼Œby</a> å‘¨ç«‹</li><li><a href="https://www.baeldung.com/spring-boot-self-hosted-monitoring" target="_blank" rel="noopener">https://www.baeldung.com/spring-boot-self-hosted-monitoring</a></li><li><a href="https://yunlzheng.gitbook.io/prometheus-book/" target="_blank" rel="noopener">https://yunlzheng.gitbook.io/prometheus-book/</a></li><li><a href="https://micrometer.io/docs/registry/prometheus" target="_blank" rel="noopener">https://micrometer.io/docs/registry/prometheus</a></li><li><a href="https://prometheus.io/docs/introduction/overview/" target="_blank" rel="noopener">https://prometheus.io/docs/introduction/overview/</a></li><li><a href="https://hub.docker.com/r/prom/prometheus/" target="_blank" rel="noopener">https://hub.docker.com/r/prom/prometheus/</a></li><li><a href="https://grafana.com/docs/grafana/latest/" target="_blank" rel="noopener">https://grafana.com/docs/grafana/latest/</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;é¡¹ç›®å·²æ‰˜ç®¡äº GitHubï¼š&lt;a href=&quot;https://github.com/y0ngb1n/spring-boot-samples&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;y0ngb1n/spring-boot-samples&lt;/a&gt;ï¼Œæ¬¢è¿ 
      
    
    </summary>
    
    
      <category term="spring-boot" scheme="https://y0ngb1n.github.io/tags/spring-boot/"/>
    
      <category term="monitoring" scheme="https://y0ngb1n.github.io/tags/monitoring/"/>
    
      <category term="prometheus" scheme="https://y0ngb1n.github.io/tags/prometheus/"/>
    
      <category term="grafana" scheme="https://y0ngb1n.github.io/tags/grafana/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot é…ç½®å¤šæ•°æ®æº</title>
    <link href="https://y0ngb1n.github.io/a/config-multi-datasource-with-spring-boot.html"/>
    <id>https://y0ngb1n.github.io/a/config-multi-datasource-with-spring-boot.html</id>
    <published>2019-09-20T20:30:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®å·²æ‰˜ç®¡äº GitHubï¼š<a href="https://github.com/y0ngb1n/spring-boot-samples" target="_blank" rel="noopener">y0ngb1n/spring-boot-samples</a>ï¼Œæ¬¢è¿ Star, Fork ğŸ˜˜</p><hr><h2 id="æ³¨æ„äº‹é¡¹"><a class="markdownIt-Anchor" href="#æ³¨æ„äº‹é¡¹"></a> æ³¨æ„äº‹é¡¹</h2><p><strong>ä¸åŒæ•°æ®æºçš„é…ç½®è¦åˆ†å¼€</strong></p><p>åœ¨ Spring ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸¤ä¸ªä¸åŒæ•°æ®æºçš„é…ç½®åˆ†å¼€ã€‚å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ª <code>foo-datasource</code> å’Œå¦ä¸€ä¸ª <code>bar-datasource</code>ï¼Œé‚£å°†è¿™ä¸¤ä¸ª DataSource çš„æ‰€æœ‰é…ç½®éƒ½è¦åˆ†å¼€ï¼Œä¸è¦å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·ï¼Œå°±ç®—å®ƒä»¬é™¤äº† <code>url</code> ä»¥å¤–å…¶å®ƒé…ç½®éƒ½ç›¸åŒï¼Œä¹Ÿå»ºè®®ä½ å°†å®ƒä»¬åˆ†å¼€é…ç½®ï¼Œè¿™æ ·ä¼šæ–¹ä¾¿æˆ‘ä»¬ä»¥åçš„é…ç½®ç®¡ç†ã€‚</p><p><strong>å…³æ³¨æ¯æ¬¡ä½¿ç”¨çš„æ•°æ®æº</strong></p><ul><li>æœ‰å¤šä¸ª DataSource æ—¶ç³»ç»Ÿå¦‚ä½•åˆ¤æ–­</li><li>å¯¹åº”çš„è®¾æ–½ï¼ˆäº‹åŠ¡ã€ORM ç­‰ï¼‰å¦‚ä½•é€‰æ‹© DataSource</li></ul><p>åœ¨ç¼–ç¨‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦æ ¼å¤–åœ°æ³¨æ„å½“å‰åœ¨æ“ä½œå“ªä¸€ä¸ªæ•°æ®æºï¼Œè¦å‘Šè¯‰æˆ‘ä»¬çš„ç³»ç»Ÿè¦ä½¿ç”¨å“ªä¸€ä¸ªæ•°æ®æºï¼Œäº‹åŠ¡ç®¡ç†åº”è¯¥å¯åœ¨å“ªä¸ªæ•°æ®æºä¸Šé¢ï¼›åŒæ—¶åœ°æˆ‘ä»¬ä¹Ÿè¦å‘Šè¯‰ç›¸å…³ ORMï¼ˆåƒ Hibernateã€MyBatis ç±»ä¼¼çš„è®¾æ–½ï¼‰æ­¤æ—¶æ˜¯åœ¨æ“ä½œå“ªä¸€ä¸ªæ•°æ®æºï¼Œå› ä¸ºè¿™äº›æ¡†æ¶å¹¶æ²¡æœ‰å¸®æˆ‘ä»¬è€ƒè™‘å¾—è¿™ä¹ˆå‘¨å…¨ï¼Œæ‰€ä»¥åœ¨ç¼–ç æ—¶ä¸€å®šè¦æ ¼å¤–åœ°å°å¿ƒã€‚</p><h2 id="å¤šæ•°æ®æºé…ç½®"><a class="markdownIt-Anchor" href="#å¤šæ•°æ®æºé…ç½®"></a> å¤šæ•°æ®æºé…ç½®</h2><p><strong>æ‰‹å·¥é…ç½®ä¸¤ç»„ DataSource åŠç›¸å…³å†…å®¹</strong></p><p>å¦‚æœæˆ‘ä»¬å®Œå…¨åœ°é æ‰‹å·¥çš„é…ç½®ï¼Œæ’é™¤æ‰æ•´ä¸ª Spring Boot ç›¸å…³çš„ä¾èµ–ï¼Œå…¨éƒ¨éƒ½äº¤ç”±è‡ªå·±æ¥é…ç½®è‚¯å®šæ˜¯å¯ä»¥çš„ã€‚</p><p>å¦‚æœè¿˜æ˜¯æƒ³ä¸ Spring Boot ç»“åˆåœ¨ä¸€èµ·çš„è¯å¯ä»¥å‚è€ƒä¸‹é¢çš„ä¸¤ç§æ–¹å¼ã€‚</p><p><strong>ä¸ Spring Boot ååŒå·¥ä½œï¼ˆäºŒé€‰ä¸€ï¼‰</strong></p><ul><li>æ–¹å¼ä¸€ï¼šé…ç½® <code>@Primary</code> ç±»å‹çš„ Bean</li><li>æ–¹å¼äºŒï¼šæ’é™¤ Spring Boot çš„è‡ªåŠ¨é…ç½®<ul><li><code>DataSourceAutoConfiguration</code></li><li><code>DataSourceTransactionManagerAutoConfiguration</code></li><li><code>JdbcTemplateAutoConfiguration</code></li></ul></li></ul><p><strong>æ–¹å¼ä¸€</strong>ï¼šSpring ä¼šæŠŠé…ç½®äº† <code>@Primary</code> çš„ Bean ä½œä¸ºä¸»è¦çš„ Beanï¼Œåœ¨åé¢ Spring Boot ç›¸å…³çš„è‡ªåŠ¨é…ç½®éƒ½ä¼šç¯ç»•è¿™ä¸ªæ ‡å¿—äº† <code>@Primary</code> çš„ DataSource è¿›è¡Œé…ç½®ã€‚</p><p><strong>æ–¹å¼äºŒ</strong>ï¼šå¦‚æœä½ è§‰å¾—è¿™ä¸¤ä¸ª Bean æ˜¯æ²¡æœ‰ä¸»æ¬¡ä¹‹åˆ†ã€è¿™ä¸¤ä¸ª DataSource éƒ½åŒç­‰é‡è¦çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ’é™¤æ‰æ–¹å¼äºŒæ‰€åˆ—ä¸¾çš„ Beanã€‚æŠŠå®ƒä»¬æ’é™¤æ‰ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­è‡ªå·±æ¥æ§åˆ¶å®ƒï¼Œå¯å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š</p><p>Step 01ï¼šæ’é™¤ Spring Boot çš„è‡ªåŠ¨é…ç½®</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span>(exclude = &#123;</span><br><span class="line">  DataSourceAutoConfiguration.class,</span><br><span class="line">  DataSourceTransactionManagerAutoConfiguration.class,</span><br><span class="line">  JdbcTemplateAutoConfiguration.class</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MultiDataSourceApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SpringApplication.run(MultiDataSourceApplication.class, args);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Step 02ï¼šæ·»åŠ  <code>foo</code>ã€<code>bar</code> æ•°æ®æºé…ç½®</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Foo DataSource</span></span><br><span class="line"><span class="attr">foo:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:h2:mem:foo</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">sa</span></span><br><span class="line"><span class="attr">    password:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Bar DataSource</span></span><br><span class="line"><span class="attr">bar:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:h2:mem:bar</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">sa</span></span><br><span class="line"><span class="attr">    password:</span></span><br></pre></td></tr></table></figure><p>Step 03: åˆ†åˆ«ä¸º <code>foo-datasource</code>ã€<code>bar-datasource</code> æ·»åŠ é…ç½®ï¼ŒåŠå¯¹åº”çš„äº‹åŠ¡ç®¡ç†å™¨</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MultiDataSourceConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//---------------------------------------------------------------------</span></span><br><span class="line">  <span class="comment">// Config Foo DataSource</span></span><br><span class="line">  <span class="comment">//---------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="meta">@ConfigurationProperties</span>(<span class="string">"foo.datasource"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> DataSourceProperties <span class="title">fooDataSourceProperties</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DataSourceProperties();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> DataSource <span class="title">fooDataSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    DataSourceProperties dataSourceProperties = fooDataSourceProperties();</span><br><span class="line">    log.info(<span class="string">"foo datasource: &#123;&#125;"</span>, dataSourceProperties.getUrl());</span><br><span class="line">    <span class="keyword">return</span> dataSourceProperties.initializeDataSourceBuilder().build();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="meta">@Resource</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> PlatformTransactionManager <span class="title">fooTxManager</span><span class="params">(DataSource fooDataSource)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DataSourceTransactionManager(fooDataSource);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//---------------------------------------------------------------------</span></span><br><span class="line">  <span class="comment">// Config Bar DataSource</span></span><br><span class="line">  <span class="comment">//---------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="meta">@ConfigurationProperties</span>(<span class="string">"bar.datasource"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> DataSourceProperties <span class="title">barDataSourceProperties</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DataSourceProperties();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> DataSource <span class="title">barDataSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    DataSourceProperties dataSourceProperties = barDataSourceProperties();</span><br><span class="line">    log.info(<span class="string">"bar datasource: &#123;&#125;"</span>, dataSourceProperties.getUrl());</span><br><span class="line">    <span class="keyword">return</span> dataSourceProperties.initializeDataSourceBuilder().build();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="meta">@Resource</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> PlatformTransactionManager <span class="title">barTxManager</span><span class="params">(DataSource barDataSource)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DataSourceTransactionManager(barDataSource);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Step 04: æ£€éªŒæ˜¯å¦é…ç½®æˆåŠŸ</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> mvn spring-boot:run</span></span><br><span class="line">...</span><br><span class="line">2019-09-18 23:57:21.649  INFO 15826 --- [           main] i.g.y.s.m.config.MultiDataSourceConfig   : foo datasource: jdbc:h2:mem:foo</span><br><span class="line">2019-09-18 23:57:21.708  INFO 15826 --- [           main] i.g.y.s.m.config.MultiDataSourceConfig   : bar datasource: jdbc:h2:mem:bar</span><br><span class="line">...</span><br><span class="line"><span class="meta">$</span><span class="bash"> curl -s http://localhost:8080/actuator/beans | jq</span></span><br><span class="line">&#123;</span><br><span class="line">  "contexts": &#123;</span><br><span class="line">    "application": &#123;</span><br><span class="line">      "beans": &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line">        "fooDataSourceProperties": &#123;</span><br><span class="line">          "aliases": [],</span><br><span class="line">          "scope": "singleton",</span><br><span class="line">          "type": "org.springframework.boot.autoconfigure.jdbc.DataSourceProperties",</span><br><span class="line">          "resource": "class path resource [io/github/y0ngb1n/samples/multidatasource/config/MultiDataSourceConfig.class]",</span><br><span class="line">          "dependencies": []</span><br><span class="line">        &#125;,</span><br><span class="line">        "fooDataSource": &#123;</span><br><span class="line">          "aliases": [],</span><br><span class="line">          "scope": "singleton",</span><br><span class="line">          "type": "com.zaxxer.hikari.HikariDataSource",</span><br><span class="line">          "resource": "class path resource [io/github/y0ngb1n/samples/multidatasource/config/MultiDataSourceConfig.class]",</span><br><span class="line">          "dependencies": [</span><br><span class="line">            "fooDataSourceProperties"</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        "fooTxManager": &#123;</span><br><span class="line">          "aliases": [],</span><br><span class="line">          "scope": "singleton",</span><br><span class="line">          "type": "org.springframework.jdbc.datasource.DataSourceTransactionManager",</span><br><span class="line">          "resource": "class path resource [io/github/y0ngb1n/samples/multidatasource/config/MultiDataSourceConfig.class]",</span><br><span class="line">          "dependencies": [</span><br><span class="line">            "fooDataSource"</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line">        "barDataSourceProperties": &#123;</span><br><span class="line">          "aliases": [],</span><br><span class="line">          "scope": "singleton",</span><br><span class="line">          "type": "org.springframework.boot.autoconfigure.jdbc.DataSourceProperties",</span><br><span class="line">          "resource": "class path resource [io/github/y0ngb1n/samples/multidatasource/config/MultiDataSourceConfig.class]",</span><br><span class="line">          "dependencies": []</span><br><span class="line">        &#125;,</span><br><span class="line">        "barDataSource": &#123;</span><br><span class="line">          "aliases": [],</span><br><span class="line">          "scope": "singleton",</span><br><span class="line">          "type": "com.zaxxer.hikari.HikariDataSource",</span><br><span class="line">          "resource": "class path resource [io/github/y0ngb1n/samples/multidatasource/config/MultiDataSourceConfig.class]",</span><br><span class="line">          "dependencies": [</span><br><span class="line">            "barDataSourceProperties"</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        "barTxManager": &#123;</span><br><span class="line">          "aliases": [],</span><br><span class="line">          "scope": "singleton",</span><br><span class="line">          "type": "org.springframework.jdbc.datasource.DataSourceTransactionManager",</span><br><span class="line">          "resource": "class path resource [io/github/y0ngb1n/samples/multidatasource/config/MultiDataSourceConfig.class]",</span><br><span class="line">          "dependencies": [</span><br><span class="line">            "barDataSource"</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line">        "multiDataSourceConfig": &#123;</span><br><span class="line">          "aliases": [],</span><br><span class="line">          "scope": "singleton",</span><br><span class="line">          "type": "io.github.y0ngb1n.samples.multidatasource.config.MultiDataSourceConfig$$EnhancerBySpringCGLIB$$63c24bed",</span><br><span class="line">          "resource": "file [/Users/yangbin/workspace/coding/Java/spring-boot-samples/spring-boot-samples-multi-datasource/target/classes/io/github/y0ngb1n/samples/multidatasource/config/MultiDataSourceConfig.class]",</span><br><span class="line">          "dependencies": []</span><br><span class="line">        &#125;,</span><br><span class="line">        ...</span><br><span class="line">      &#125;,</span><br><span class="line">      "parentId": null</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å¯ä»¥æŸ¥çœ‹åˆ° Spring ä¸­å„ Bean çš„ä¾èµ–å…³ç³»ã€‚</p><p>è¿™æ ·å°±å®Œæˆäº† Spring Boot ä¸­å¤šæ•°æ®æºçš„é…ç½®ã€‚å¦‚æœæˆ‘ä»¬è¿˜æœ‰æ›´å¤šçš„æ•°æ®æºçš„è¯ï¼Œé…ç½®ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œå‚è€ƒä¸Šé¢çš„é…ç½®å³å¯ã€‚</p><hr><h2 id="å‚è€ƒé“¾æ¥"><a class="markdownIt-Anchor" href="#å‚è€ƒé“¾æ¥"></a> å‚è€ƒé“¾æ¥</h2><ul><li><a href="http://gk.link/a/1029F" target="_blank" rel="noopener">http://gk.link/a/1029F</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;é¡¹ç›®å·²æ‰˜ç®¡äº GitHubï¼š&lt;a href=&quot;https://github.com/y0ngb1n/spring-boot-samples&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;y0ngb1n/spring-boot-samples&lt;/a&gt;ï¼Œæ¬¢è¿ 
      
    
    </summary>
    
    
      <category term="java" scheme="https://y0ngb1n.github.io/tags/java/"/>
    
      <category term="spring-boot" scheme="https://y0ngb1n.github.io/tags/spring-boot/"/>
    
      <category term="multi-datasource" scheme="https://y0ngb1n.github.io/tags/multi-datasource/"/>
    
  </entry>
  
  <entry>
    <title>GraphQL ä¸ Spring Boot çš„åˆä½“éªŒ</title>
    <link href="https://y0ngb1n.github.io/a/getting-started-with-graphql-and-spring-boot.html"/>
    <id>https://y0ngb1n.github.io/a/getting-started-with-graphql-and-spring-boot.html</id>
    <published>2019-08-24T20:37:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®å·²æ‰˜ç®¡äº GitHubï¼š<a href="https://github.com/y0ngb1n/spring-boot-samples" target="_blank" rel="noopener">y0ngb1n/spring-boot-samples</a>ï¼Œæ¬¢è¿ Star, Fork ğŸ˜˜</p><hr><blockquote><p>GraphQL æ—¢æ˜¯ä¸€ç§ç”¨äº API çš„æŸ¥è¯¢è¯­è¨€ä¹Ÿæ˜¯ä¸€ä¸ªæ»¡è¶³ä½ æ•°æ®æŸ¥è¯¢çš„è¿è¡Œæ—¶ã€‚ GraphQL å¯¹ä½ çš„ API ä¸­çš„æ•°æ®æä¾›äº†ä¸€å¥—æ˜“äºç†è§£çš„å®Œæ•´æè¿°ï¼Œä½¿å¾—å®¢æˆ·ç«¯èƒ½å¤Ÿå‡†ç¡®åœ°è·å¾—å®ƒéœ€è¦çš„æ•°æ®ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å†—ä½™ï¼Œä¹Ÿè®© API æ›´å®¹æ˜“åœ°éšç€æ—¶é—´æ¨ç§»è€Œæ¼”è¿›ï¼Œè¿˜èƒ½ç”¨äºæ„å»ºå¼ºå¤§çš„å¼€å‘è€…å·¥å…·ã€‚</p></blockquote><h2 id="å®šä¹‰-schema"><a class="markdownIt-Anchor" href="#å®šä¹‰-schema"></a> å®šä¹‰ Schema</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># src/main/resources/schema.graphql</span><br><span class="line">schema &#123;</span><br><span class="line">  query: Query</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Query &#123;</span><br><span class="line">  allBooks: [Book]</span><br><span class="line">  book(id: String): Book</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Book &#123;</span><br><span class="line">  isbn: String</span><br><span class="line">  title: String</span><br><span class="line">  publisher: String</span><br><span class="line">  authors: [String]</span><br><span class="line">  publishedDate: String</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ è½½å¹¶è§£æä¸Šé¢å®šä¹‰çš„-schema"><a class="markdownIt-Anchor" href="#åŠ è½½å¹¶è§£æä¸Šé¢å®šä¹‰çš„-schema"></a> åŠ è½½å¹¶è§£æä¸Šé¢å®šä¹‰çš„ Schema</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GraphQLService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Value</span>(<span class="string">"classpath:schema.graphql"</span>)</span><br><span class="line">  <span class="keyword">private</span> Resource resource;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Getter</span></span><br><span class="line">  <span class="keyword">private</span> GraphQL graphQL;</span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> AllBooksDataFetcher allBooksDataFetcher;</span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> BookDataFetcher bookDataFetcher;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@PostConstruct</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">loadSchema</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">// è·å–æœ¬åœ°å®šä¹‰çš„ Schema æ–‡ä»¶</span></span><br><span class="line">    File schemaFile = resource.getFile();</span><br><span class="line">    <span class="comment">// è§£æ Schema æ–‡ä»¶</span></span><br><span class="line">    TypeDefinitionRegistry typeRegistry = <span class="keyword">new</span> SchemaParser().parse(schemaFile);</span><br><span class="line">    RuntimeWiring wiring = buildRuntimeWiring();</span><br><span class="line">    GraphQLSchema schema = <span class="keyword">new</span> SchemaGenerator().makeExecutableSchema(typeRegistry, wiring);</span><br><span class="line">    graphQL = GraphQL.newGraphQL(schema).build();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> RuntimeWiring <span class="title">buildRuntimeWiring</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> RuntimeWiring.newRuntimeWiring()</span><br><span class="line">      .type(<span class="string">"Query"</span>, typeWiring -&gt; typeWiring</span><br><span class="line">        .dataFetcher(<span class="string">"allBooks"</span>, allBooksDataFetcher)</span><br><span class="line">        .dataFetcher(<span class="string">"book"</span>, bookDataFetcher)</span><br><span class="line">      ).build();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æä¾›-datafetcher"><a class="markdownIt-Anchor" href="#æä¾›-datafetcher"></a> æä¾› DataFetcher</h2><p>ç›¸å½“äºæä¾› Schema ä¸­çš„ Query å®ç°ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">type Query &#123;</span><br><span class="line">  allBooks: [Book]</span><br><span class="line">  book(id: String): Book</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AllBooksDataFetcher</code> å¯¹åº”å®ç° <code>allBooks: [Book]</code>ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AllBooksDataFetcher</span> <span class="keyword">implements</span> <span class="title">DataFetcher</span>&lt;<span class="title">List</span>&lt;<span class="title">Book</span>&gt;&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> BookRepository bookRepository;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">get</span><span class="params">(DataFetchingEnvironment dataFetchingEnvironment)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> bookRepository.findAll();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>BookDataFetcher</code> å¯¹åº”å®ç° <code>book(id: String): Book</code>ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookDataFetcher</span> <span class="keyword">implements</span> <span class="title">DataFetcher</span>&lt;<span class="title">Book</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> BookRepository bookRepository;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Book <span class="title">get</span><span class="params">(DataFetchingEnvironment dataFetchingEnvironment)</span> </span>&#123;</span><br><span class="line">    String isn = dataFetchingEnvironment.getArgument(<span class="string">"id"</span>);</span><br><span class="line">    <span class="keyword">return</span> bookRepository.findById(isn).orElse(<span class="keyword">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æä¾›-graphql-api"><a class="markdownIt-Anchor" href="#æä¾›-graphql-api"></a> æä¾› GraphQL API</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(path = <span class="string">"/v1/books"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> GraphQLService graphQLService;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@PostMapping</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> ResponseEntity&lt;Object&gt; <span class="title">getAllBooks</span><span class="params">(@RequestBody String query)</span> </span>&#123;</span><br><span class="line">    ExecutionResult execute = graphQLService.getGraphQL().execute(query);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(execute, HttpStatus.OK);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨å¹¶æµ‹è¯•"><a class="markdownIt-Anchor" href="#å¯åŠ¨å¹¶æµ‹è¯•"></a> å¯åŠ¨å¹¶æµ‹è¯•</h2><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> mvn install</span></span><br><span class="line">...</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">...</span><br><span class="line"><span class="meta">$</span><span class="bash"> mvn spring-boot:run</span></span><br><span class="line">...</span><br><span class="line">2019-08-24 19:35:11.700  INFO 14464 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''</span><br><span class="line">2019-08-24 19:35:11.702  INFO 14464 --- [           main] i.g.y.s.graphql.GraphQLApplication       : Started GraphQLApplication in 16.808 seconds (JVM running for 25.601)</span><br></pre></td></tr></table></figure><p><strong>æŸ¥è¯¢éƒ¨åˆ†å­—æ®µ</strong></p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -X POST \</span></span><br><span class="line">  http://127.0.0.1:8080/v1/books \</span><br><span class="line">  -H 'Content-Type: text/plain' \</span><br><span class="line">  -d '&#123;</span><br><span class="line">    allBooks &#123;</span><br><span class="line">      isbn</span><br><span class="line">      title</span><br><span class="line">  &#125;</span><br><span class="line">&#125;' | jq</span><br><span class="line"><span class="meta">  %</span><span class="bash"> Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100   579    0   524  100    55  34933   3666 --:--:-- --:--:-- --:--:-- 38600</span><br><span class="line">&#123;</span><br><span class="line">  "errors": [],</span><br><span class="line">  "data": &#123;</span><br><span class="line">    "allBooks": [</span><br><span class="line">      &#123;</span><br><span class="line">        "isbn": "9787111213826",</span><br><span class="line">        "title": "Java ç¼–ç¨‹æ€æƒ³ï¼ˆç¬¬4ç‰ˆï¼‰"</span><br><span class="line">      &#125;,</span><br><span class="line">      ...</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  "extensions": null,</span><br><span class="line">  "dataPresent": true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -X POST \</span></span><br><span class="line">  http://127.0.0.1:8080/v1/books \</span><br><span class="line">  -H 'Content-Type: text/plain' \</span><br><span class="line">  -d '&#123;</span><br><span class="line">    book(id: "9787121362132") &#123;</span><br><span class="line">      title</span><br><span class="line">  &#125;</span><br><span class="line">&#125;' | jq</span><br><span class="line"><span class="meta">  %</span><span class="bash"> Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100   210    0   159  100    51   1691    542 --:--:-- --:--:-- --:--:--  2234</span><br><span class="line">&#123;</span><br><span class="line">  "errors": [],</span><br><span class="line">  "data": &#123;</span><br><span class="line">    "book": &#123;</span><br><span class="line">      "title": "é«˜å¯ç”¨å¯ä¼¸ç¼©å¾®æœåŠ¡æ¶æ„ï¼šåŸºäº Dubboã€Spring Cloud å’Œ Service Mesh"</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "extensions": null,</span><br><span class="line">  "dataPresent": true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æŸ¥è¯¢å…¨éƒ¨å­—æ®µ</strong></p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -X POST \</span></span><br><span class="line">  http://127.0.0.1:8080/v1/books \</span><br><span class="line">  -H 'Content-Type: text/plain' \</span><br><span class="line">  -d '&#123;</span><br><span class="line">    allBooks &#123;</span><br><span class="line">      isbn</span><br><span class="line">      title</span><br><span class="line">      authors</span><br><span class="line">      publisher</span><br><span class="line">      publishedDate</span><br><span class="line">  &#125;</span><br><span class="line">&#125;' | jq</span><br><span class="line"><span class="meta">  %</span><span class="bash"> Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100  1139    0  1044  100    95    750     68  0:00:01  0:00:01 --:--:--   818</span><br><span class="line">&#123;</span><br><span class="line">  "errors": [],</span><br><span class="line">  "data": &#123;</span><br><span class="line">    "allBooks": [</span><br><span class="line">      &#123;</span><br><span class="line">        "isbn": "9787111213826",</span><br><span class="line">        "title": "Java ç¼–ç¨‹æ€æƒ³ï¼ˆç¬¬4ç‰ˆï¼‰",</span><br><span class="line">        "authors": [</span><br><span class="line">          "Bruce Eckel"</span><br><span class="line">        ],</span><br><span class="line">        "publisher": "æœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾",</span><br><span class="line">        "publishedDate": "2007-06-01"</span><br><span class="line">      &#125;,</span><br><span class="line">      ...</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  "extensions": null,</span><br><span class="line">  "dataPresent": true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -X POST \</span></span><br><span class="line">  http://127.0.0.1:8080/v1/books \</span><br><span class="line">  -H 'Content-Type: text/plain' \</span><br><span class="line">  -d '&#123;</span><br><span class="line">    book(id: "9787121362132") &#123;</span><br><span class="line">      title</span><br><span class="line">      authors</span><br><span class="line">      publisher</span><br><span class="line">      publishedDate</span><br><span class="line">  &#125;</span><br><span class="line">&#125;' | jq</span><br><span class="line"><span class="meta">  %</span><span class="bash"> Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100   421    0   320  100   101   312k    98k --:--:-- --:--:-- --:--:--  411k</span><br><span class="line">&#123;</span><br><span class="line">  "errors": [],</span><br><span class="line">  "data": &#123;</span><br><span class="line">    "book": &#123;</span><br><span class="line">      "title": "é«˜å¯ç”¨å¯ä¼¸ç¼©å¾®æœåŠ¡æ¶æ„ï¼šåŸºäº Dubboã€Spring Cloud å’Œ Service Mesh",</span><br><span class="line">      "authors": [</span><br><span class="line">        "ç¨‹è¶…",</span><br><span class="line">        "æ¢æ¡‚é’Š",</span><br><span class="line">        "ç§¦é‡‘å«",</span><br><span class="line">        "æ–¹å¿—æ–Œ",</span><br><span class="line">        "å¼ é€¸",</span><br><span class="line">        "æœçª",</span><br><span class="line">        "æ®·ç¦",</span><br><span class="line">        "è‚–å† å®‡"</span><br><span class="line">      ],</span><br><span class="line">      "publisher": "ç”µå­å·¥ä¸šå‡ºç‰ˆç¤¾",</span><br><span class="line">      "publishedDate": "2019-05-01"</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "extensions": null,</span><br><span class="line">  "dataPresent": true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æŸ¥è¯¢å¤šä¸ªæ•°æ®</strong></p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -X POST \</span></span><br><span class="line">  http://127.0.0.1:8080/v1/books \</span><br><span class="line">  -H 'Content-Type: text/plain' \</span><br><span class="line">  -d '&#123;</span><br><span class="line">    allBooks &#123;</span><br><span class="line">      isbn</span><br><span class="line">      title</span><br><span class="line">    &#125;</span><br><span class="line">    book(id: "9787121362132") &#123;</span><br><span class="line">      title</span><br><span class="line">      authors</span><br><span class="line">      publisher</span><br><span class="line">      publishedDate</span><br><span class="line">  &#125;</span><br><span class="line">&#125;' | jq</span><br><span class="line"><span class="meta">  %</span><span class="bash"> Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100   930    0   785  100   145   3866    714 --:--:-- --:--:-- --:--:--  4581</span><br><span class="line">&#123;</span><br><span class="line">  "errors": [],</span><br><span class="line">  "data": &#123;</span><br><span class="line">    "allBooks": [</span><br><span class="line">      &#123;</span><br><span class="line">        "isbn": "9787111213826",</span><br><span class="line">        "title": "Java ç¼–ç¨‹æ€æƒ³ï¼ˆç¬¬4ç‰ˆï¼‰"</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        "isbn": "9787111421900",</span><br><span class="line">        "title": "æ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºï¼šJVM é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬2ç‰ˆï¼‰"</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        "isbn": "9787115221704",</span><br><span class="line">        "title": "é‡æ„ æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ï¼ˆç¬¬2ç‰ˆï¼‰"</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        "isbn": "9787121362132",</span><br><span class="line">        "title": "é«˜å¯ç”¨å¯ä¼¸ç¼©å¾®æœåŠ¡æ¶æ„ï¼šåŸºäº Dubboã€Spring Cloud å’Œ Service Mesh"</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        "isbn": "9787302392644",</span><br><span class="line">        "title": "äººæœˆç¥è¯ï¼ˆ40å‘¨å¹´ä¸­æ–‡çºªå¿µç‰ˆï¼‰"</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    "book": &#123;</span><br><span class="line">      "title": "é«˜å¯ç”¨å¯ä¼¸ç¼©å¾®æœåŠ¡æ¶æ„ï¼šåŸºäº Dubboã€Spring Cloud å’Œ Service Mesh",</span><br><span class="line">      "authors": [</span><br><span class="line">        "ç¨‹è¶…",</span><br><span class="line">        "æ¢æ¡‚é’Š",</span><br><span class="line">        "ç§¦é‡‘å«",</span><br><span class="line">        "æ–¹å¿—æ–Œ",</span><br><span class="line">        "å¼ é€¸",</span><br><span class="line">        "æœçª",</span><br><span class="line">        "æ®·ç¦",</span><br><span class="line">        "è‚–å† å®‡"</span><br><span class="line">      ],</span><br><span class="line">      "publisher": "ç”µå­å·¥ä¸šå‡ºç‰ˆç¤¾",</span><br><span class="line">      "publishedDate": "2019-05-01"</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "extensions": null,</span><br><span class="line">  "dataPresent": true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»¼ä¸Šå¯è§ï¼ŒAPI ä¸å˜åªæ”¹åŠ¨äº†æŸ¥è¯¢çš„å†…å®¹ï¼Œå°±ä¼šè‡ªåŠ¨å“åº”ä¸åŒçš„ç»“æœã€‚</p><hr><h2 id="å‚è€ƒé“¾æ¥"><a class="markdownIt-Anchor" href="#å‚è€ƒé“¾æ¥"></a> å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://graphql.org/" target="_blank" rel="noopener">https://graphql.org/</a></li><li><a href="https://developer.github.com/v4/" target="_blank" rel="noopener">https://developer.github.com/v4/</a></li><li><a href="https://www.baeldung.com/graphql" target="_blank" rel="noopener">https://www.baeldung.com/graphql</a></li><li><a href="https://www.baeldung.com/spring-graphql" target="_blank" rel="noopener">https://www.baeldung.com/spring-graphql</a></li><li><a href="https://youtu.be/zX2I7-aIldE" target="_blank" rel="noopener">https://youtu.be/zX2I7-aIldE</a></li><li><a href="https://leader.js.cool/#/basic/db/graphql" target="_blank" rel="noopener">https://leader.js.cool/#/basic/db/graphql</a></li><li><a href="https://github.com/glennreyes/graphpack" target="_blank" rel="noopener">https://github.com/glennreyes/graphpack</a></li><li><a href="https://www.infoq.cn/article/xZ0ws6_A5jmrJ6ZTPOz8" target="_blank" rel="noopener">å…¨é¢è§£æ GraphQLï¼Œæºç¨‹å¾®æœåŠ¡èƒŒæ™¯ä¸‹çš„å‰åç«¯æ•°æ®äº¤äº’æ–¹æ¡ˆ</a></li><li><a href="https://juejin.im/post/5ca1b7be51882543ea4b7f27" target="_blank" rel="noopener">å‰ç«¯eräº†è§£ GraphQLï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†</a></li><li><a href="https://www.robinwieruch.de/the-road-to-graphql-book/" target="_blank" rel="noopener">GraphQL ä¹‹è·¯</a></li><li><a href="https://www.infoq.cn/article/HfkjC5CdT1XXTsd44b3A" target="_blank" rel="noopener">è°ˆè°ˆ GraphQL çš„å†å²ã€ç»„ä»¶å’Œç”Ÿæ€ç³»ç»Ÿ</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;é¡¹ç›®å·²æ‰˜ç®¡äº GitHubï¼š&lt;a href=&quot;https://github.com/y0ngb1n/spring-boot-samples&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;y0ngb1n/spring-boot-samples&lt;/a&gt;ï¼Œæ¬¢è¿ 
      
    
    </summary>
    
    
      <category term="java" scheme="https://y0ngb1n.github.io/tags/java/"/>
    
      <category term="spring-boot" scheme="https://y0ngb1n.github.io/tags/spring-boot/"/>
    
      <category term="graphql" scheme="https://y0ngb1n.github.io/tags/graphql/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨ Spring Boot &amp; Redis å®ç°çŸ­é“¾æ¥æœåŠ¡</title>
    <link href="https://y0ngb1n.github.io/a/build-a-custom-url-shortener-service.html"/>
    <id>https://y0ngb1n.github.io/a/build-a-custom-url-shortener-service.html</id>
    <published>2019-08-21T21:52:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®å·²æ‰˜ç®¡äº GitHubï¼š<a href="https://github.com/y0ngb1n/spring-boot-samples" target="_blank" rel="noopener">y0ngb1n/spring-boot-samples</a>ï¼Œæ¬¢è¿ Star, Fork ğŸ˜˜</p><hr><h2 id="å‡†å¤‡å·¥ä½œ"><a class="markdownIt-Anchor" href="#å‡†å¤‡å·¥ä½œ"></a> å‡†å¤‡å·¥ä½œ</h2><ul><li>Spring Boot 2.1.0+</li><li>Redis</li><li>Lombok</li><li>Guava 28.0</li><li>Common Validator 1.6</li></ul><h2 id="æ·»åŠ ä¾èµ–é¡¹"><a class="markdownIt-Anchor" href="#æ·»åŠ ä¾èµ–é¡¹"></a> æ·»åŠ ä¾èµ–é¡¹</h2><p><code>pom.xml</code></p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-validator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.guava<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>guava<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>application.yml</code></p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="comment"># Redis Config</span></span><br><span class="line"><span class="attr">  redis:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line"><span class="attr">    port:</span> <span class="number">6379</span></span><br><span class="line"><span class="attr">    password:</span> <span class="string">your_password</span></span><br><span class="line"></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="attr">  level:</span></span><br><span class="line">    <span class="string">io.github.y0ngb1n.*:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure><h2 id="æ ¸å¿ƒä»£ç "><a class="markdownIt-Anchor" href="#æ ¸å¿ƒä»£ç "></a> æ ¸å¿ƒä»£ç </h2><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * URL Shortener Resource</span><br><span class="line"> *</span><br><span class="line"> * @author yangbin</span><br><span class="line"> */</span><br><span class="line">@Slf4j</span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(path = "/v1")</span><br><span class="line">public class UrlShortenerController &#123;</span><br><span class="line"></span><br><span class="line">  @Autowired</span><br><span class="line">  StringRedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">  @GetMapping(path = "/&#123;id&#125;")</span><br><span class="line">  public String getUrl(@PathVariable String id) &#123;</span><br><span class="line"><span class="addition">+   String url = redisTemplate.opsForValue().get(id);</span></span><br><span class="line">    log.debug("URL Retrieved: &#123;&#125;", url);</span><br><span class="line">    return url;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @PostMapping</span><br><span class="line">  public String create(@RequestBody String url) &#123;</span><br><span class="line">    UrlValidator urlValidator = new UrlValidator(</span><br><span class="line">      new String[]&#123;"http", "https"&#125;</span><br><span class="line">    );</span><br><span class="line">    if (urlValidator.isValid(url)) &#123;</span><br><span class="line"><span class="deletion">-     String id = Hashing.murmur3_32().hashString(url, StandardCharsets.UTF_8).toString();</span></span><br><span class="line">      log.debug("URL Id generated: &#123;&#125;", id);</span><br><span class="line"><span class="addition">+     redisTemplate.opsForValue().set(id, url);</span></span><br><span class="line">      return id;</span><br><span class="line">    &#125;</span><br><span class="line">    throw new RuntimeException("URL Invalid: " + url);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æ–¹å¼"><a class="markdownIt-Anchor" href="#ä½¿ç”¨æ–¹å¼"></a> ä½¿ç”¨æ–¹å¼</h2><p><strong>Step 0: å®‰è£…å¹¶å¯åŠ¨ Redis</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># on Windows</span></span><br><span class="line">scoop install redis</span><br><span class="line">redis-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># on Mac</span></span><br><span class="line">brew install redis</span><br><span class="line">redis-server</span><br></pre></td></tr></table></figure><p><strong>Step 1: å¯åŠ¨ <code>url-shortener</code> æœåŠ¡</strong></p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> mvn install</span></span><br><span class="line">...</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">...</span><br><span class="line"><span class="meta">$</span><span class="bash"> mvn spring-boot:run</span></span><br><span class="line">...</span><br><span class="line">2019-08-21 21:03:50.215  INFO 10244 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''</span><br><span class="line">2019-08-21 21:03:50.219  INFO 10244 --- [ main] i.g.y.s.u.UrlShortenerApplication        : Started UrlShortenerApplication in 6.01 seconds (JVM running for 12.165)</span><br></pre></td></tr></table></figure><p><strong>Step 2: ç”ŸæˆçŸ­é“¾</strong></p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -X POST http://127.0.0.1:8080/v1 \</span></span><br><span class="line">  -H 'Content-Type: text/plain' \</span><br><span class="line">  -d https://y0ngb1n.github.io</span><br><span class="line">515bbe2b</span><br></pre></td></tr></table></figure><p><strong>Step 3: è¿˜åŸçŸ­é“¾</strong></p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -X GET http://127.0.0.1:8080/v1/515bbe2b</span></span><br><span class="line">https://y0ngb1n.github.io</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ—¥å¿—</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">2019-08-21 21:42:26.788 DEBUG 10244 --- [nio-8080-exec-2] i.g.y.s.u.c.UrlShortenerController       : URL Id generated: 515bbe2b</span><br><span class="line">2019-08-21 21:42:40.748 DEBUG 10244 --- [nio-8080-exec-3] i.g.y.s.u.c.UrlShortenerController       : URL Retrieved: https://y0ngb1n.github.io</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://youtu.be/Zr0E2VP24w8" target="_blank" rel="noopener">https://youtu.be/Zr0E2VP24w8</a></li><li><a href="https://en.wikipedia.org/wiki/MurmurHash" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/MurmurHash</a></li><li><a href="https://github.com/google/guava/wiki/HashingExplained" target="_blank" rel="noopener">https://github.com/google/guava/wiki/HashingExplained</a></li><li><a href="https://www.flyml.net/2016/09/05/cassandra-tutorial-murmurhash/" target="_blank" rel="noopener">https://www.flyml.net/2016/09/05/cassandra-tutorial-murmurhash/</a></li><li><a href="https://hufangyun.com/2017/short-url/" target="_blank" rel="noopener">çŸ­ç½‘å€ï¼ˆShort URLï¼‰ç³»ç»Ÿçš„åŸç†åŠå…¶å®ç°</a>ï¼Œby èƒ¡æ–¹è¿</li><li><a href="https://zhangzw.com/20190521.html" target="_blank" rel="noopener">å¦‚ä½•å¿«é€Ÿåˆ¤æ–­æŸ URL æ˜¯å¦åœ¨ä¸€ä¸ª 20 äº¿çš„ç½‘å€ URL é›†åˆä¸­ï¼Ÿ</a>ï¼Œby å¼ æŒ¯ä¼Ÿ<ul><li>åº”ç”¨åœºæ™¯ï¼š<code>é»‘åå•</code>ã€<code>URL å»é‡</code>ã€<code>å•è¯æ‹¼å†™æ£€æŸ¥</code>ã€<code>Key-Value ç¼“å­˜ç³»ç»Ÿçš„ Key æ ¡éªŒ</code>ã€<code>ID æ ¡éªŒï¼Œæ¯”å¦‚è®¢å•ç³»ç»ŸæŸ¥è¯¢æŸä¸ªè®¢å• ID æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±ç›´æ¥è¿”å›</code></li></ul></li><li><a href="https://yuerblog.cc/2017/06/06/unique-id-generator/" target="_blank" rel="noopener">è°ˆè°ˆå…¨å±€å”¯ä¸€ ID ç”Ÿæˆæ–¹æ³•</a></li><li><a href="https://tech.meituan.com/2017/04/21/mt-leaf.html" target="_blank" rel="noopener">Leaf â€” ç¾å›¢ç‚¹è¯„åˆ†å¸ƒå¼ ID ç”Ÿæˆç³»ç»Ÿ</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;é¡¹ç›®å·²æ‰˜ç®¡äº GitHubï¼š&lt;a href=&quot;https://github.com/y0ngb1n/spring-boot-samples&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;y0ngb1n/spring-boot-samples&lt;/a&gt;ï¼Œæ¬¢è¿ 
      
    
    </summary>
    
    
      <category term="java" scheme="https://y0ngb1n.github.io/tags/java/"/>
    
      <category term="spring-boot" scheme="https://y0ngb1n.github.io/tags/spring-boot/"/>
    
      <category term="url-shortener" scheme="https://y0ngb1n.github.io/tags/url-shortener/"/>
    
  </entry>
  
  <entry>
    <title>Docker Hub é•œåƒåŠ é€Ÿå™¨</title>
    <link href="https://y0ngb1n.github.io/a/docker-registry-mirrors.html"/>
    <id>https://y0ngb1n.github.io/a/docker-registry-mirrors.html</id>
    <published>2019-05-08T12:16:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡é¦–å‘äº GitHub Gistï¼š<a href="https://gist.github.com/y0ngb1n/7e8f16af3242c7815e7ca2f0833d3ea6" target="_blank" rel="noopener">https://gist.github.com/y0ngb1n/7e8f16af3242c7815e7ca2f0833d3ea6</a>ï¼Œæ¬¢è¿ Star ğŸ˜˜</p></blockquote><p>å›½å†…ä» Docker Hub æ‹‰å–é•œåƒæœ‰æ—¶ä¼šé‡åˆ°å›°éš¾ï¼Œæ­¤æ—¶å¯ä»¥é…ç½®é•œåƒåŠ é€Ÿå™¨ã€‚Docker å®˜æ–¹å’Œå›½å†…å¾ˆå¤šäº‘æœåŠ¡å•†éƒ½æä¾›äº†å›½å†…åŠ é€Ÿå™¨æœåŠ¡ã€‚</p><h2 id="é…ç½®åŠ é€Ÿåœ°å€"><a class="markdownIt-Anchor" href="#é…ç½®åŠ é€Ÿåœ°å€"></a> é…ç½®åŠ é€Ÿåœ°å€</h2><blockquote><p>Ubuntu 16.04+ã€Debian 8+ã€CentOS 7+</p></blockquote><p>åˆ›å»ºæˆ–ä¿®æ”¹ <code>/etc/docker/daemon.json</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"registry-mirrors"</span>: [</span><br><span class="line">        <span class="string">"https://1nj0zren.mirror.aliyuncs.com"</span>,</span><br><span class="line">        <span class="string">"https://docker.mirrors.ustc.edu.cn"</span>,</span><br><span class="line">        <span class="string">"http://f1361db2.m.daocloud.io"</span>,</span><br><span class="line">        <span class="string">"https://registry.docker-cn.com"</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="docker-hub-é•œåƒåŠ é€Ÿå™¨åˆ—è¡¨"><a class="markdownIt-Anchor" href="#docker-hub-é•œåƒåŠ é€Ÿå™¨åˆ—è¡¨"></a> Docker Hub é•œåƒåŠ é€Ÿå™¨åˆ—è¡¨</h2><table><thead><tr><th>é•œåƒåŠ é€Ÿå™¨</th><th>é•œåƒåŠ é€Ÿå™¨åœ°å€</th><th>ä¸“å±åŠ é€Ÿå™¨<a href="#" title="éœ€ç™»å½•åè·å–å¹³å°åˆ†é…çš„ä¸“å±åŠ é€Ÿå™¨">ï¼Ÿ</a></th><th>å…¶å®ƒåŠ é€Ÿ<a href="#" title="æ”¯æŒå“ªäº›é•œåƒæ¥æºçš„é•œåƒåŠ é€Ÿ">ï¼Ÿ</a></th></tr></thead><tbody><tr><td><a href="https://docker-cn.com/registry-mirror" target="_blank" rel="noopener">Docker ä¸­å›½å®˜æ–¹é•œåƒ</a></td><td><code>https://registry.docker-cn.com</code></td><td></td><td>Docker Hub</td></tr><tr><td><a href="https://daocloud.io/mirror" target="_blank" rel="noopener">DaoCloud é•œåƒç«™</a></td><td><code>http://f1361db2.m.daocloud.io</code></td><td>å¯ç™»å½•ï¼Œç³»ç»Ÿåˆ†é…</td><td>Docker Hub</td></tr><tr><td><a href="https://github.com/Azure/container-service-for-azure-china/blob/master/aks/README.md#22-container-registry-proxy" target="_blank" rel="noopener">Azure ä¸­å›½é•œåƒ</a></td><td><code>https://dockerhub.azk8s.cn</code></td><td></td><td>Docker Hubã€GCRã€Quay</td></tr><tr><td><a href="https://mirrors.ustc.edu.cn/help/dockerhub.html" target="_blank" rel="noopener">ç§‘å¤§é•œåƒç«™</a></td><td><code>https://docker.mirrors.ustc.edu.cn</code></td><td></td><td>Docker Hubã€<a href="https://github.com/ustclug/mirrorrequest/issues/91" target="_blank" rel="noopener">GCR</a>ã€<a href="https://github.com/ustclug/mirrorrequest/issues/135" target="_blank" rel="noopener">Quay</a></td></tr><tr><td><a href="https://cr.console.aliyun.com" target="_blank" rel="noopener">é˜¿é‡Œäº‘</a></td><td><code>https://&lt;your_code&gt;.mirror.aliyuncs.com</code></td><td>éœ€ç™»å½•ï¼Œç³»ç»Ÿåˆ†é…</td><td>Docker Hub</td></tr><tr><td><a href="https://kirk-enterprise.github.io/hub-docs/#/user-guide/mirror" target="_blank" rel="noopener">ä¸ƒç‰›äº‘</a></td><td><code>https://reg-mirror.qiniu.com</code></td><td></td><td>Docker Hubã€GCRã€Quay</td></tr><tr><td><a href="https://c.163yun.com/hub" target="_blank" rel="noopener">ç½‘æ˜“äº‘</a></td><td><code>https://hub-mirror.c.163.com</code></td><td></td><td>Docker Hub</td></tr><tr><td><a href="https://cloud.tencent.com/document/product/457/9113" target="_blank" rel="noopener">è…¾è®¯äº‘</a></td><td><code>https://mirror.ccs.tencentyun.com</code></td><td></td><td>Docker Hub</td></tr></tbody></table><h2 id="æ£€æŸ¥åŠ é€Ÿå™¨æ˜¯å¦ç”Ÿæ•ˆ"><a class="markdownIt-Anchor" href="#æ£€æŸ¥åŠ é€Ÿå™¨æ˜¯å¦ç”Ÿæ•ˆ"></a> æ£€æŸ¥åŠ é€Ÿå™¨æ˜¯å¦ç”Ÿæ•ˆ</h2><p>å‘½ä»¤è¡Œæ‰§è¡Œ <code>docker info</code>ï¼Œå¦‚æœä»ç»“æœä¸­çœ‹åˆ°äº†å¦‚ä¸‹å†…å®¹ï¼Œè¯´æ˜é…ç½®æˆåŠŸã€‚</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">Registry Mirrors:</span><br><span class="line"> [...]</span><br><span class="line"> https://registry.docker-cn.com/</span><br></pre></td></tr></table></figure><h2 id="docker-hub-é•œåƒæµ‹é€Ÿ"><a class="markdownIt-Anchor" href="#docker-hub-é•œåƒæµ‹é€Ÿ"></a> Docker Hub é•œåƒæµ‹é€Ÿ</h2><p>ä½¿ç”¨é•œåƒå‰åï¼Œå¯ä½¿ç”¨ <code>time</code> ç»Ÿè®¡æ‰€èŠ±è´¹çš„æ€»æ—¶é—´ã€‚æµ‹é€Ÿå‰å…ˆç§»é™¤æœ¬åœ°çš„é•œåƒï¼</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker rmi node:latest</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> time docker pull node:latest</span></span><br><span class="line">Pulling repository node</span><br><span class="line">[...]</span><br><span class="line"></span><br><span class="line">real   1m14.078s</span><br><span class="line">user   0m0.176s</span><br><span class="line">sys    0m0.120s</span><br></pre></td></tr></table></figure><hr><h2 id="å‚è€ƒé“¾æ¥"><a class="markdownIt-Anchor" href="#å‚è€ƒé“¾æ¥"></a> å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://docs.docker.com/registry/recipes/mirror/" target="_blank" rel="noopener">https://docs.docker.com/registry/recipes/mirror/</a></li><li><a href="https://github.com/yeasy/docker_practice/blob/master/install/mirror.md" target="_blank" rel="noopener">https://github.com/yeasy/docker_practice/blob/master/install/mirror.md</a></li><li><a href="https://github.com/moby/moby/blob/d409b05970e686993e343d226fae5b463d872082/docs/articles/registry_mirror.md" target="_blank" rel="noopener">https://github.com/moby/moby/blob/d409b05970e686993e343d226fae5b463d872082/docs/articles/registry_mirror.md</a></li><li><a href="https://www.fengbohello.top/archives/docker-registry-mirror" target="_blank" rel="noopener">https://www.fengbohello.top/archives/docker-registry-mirror</a></li><li><a href="https://www.ilanni.com/?p=14534" target="_blank" rel="noopener">https://www.ilanni.com/?p=14534</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡é¦–å‘äº GitHub Gistï¼š&lt;a href=&quot;https://gist.github.com/y0ngb1n/7e8f16af3242c7815e7ca2f0833d3ea6&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;
      
    
    </summary>
    
      <category term="å®¹å™¨æŠ€æœ¯" scheme="https://y0ngb1n.github.io/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="å®¹å™¨æŠ€æœ¯" scheme="https://y0ngb1n.github.io/tags/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/"/>
    
      <category term="docker" scheme="https://y0ngb1n.github.io/tags/docker/"/>
    
      <category term="docker-hub" scheme="https://y0ngb1n.github.io/tags/docker-hub/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•å®šåˆ¶è‡ªå·±çš„èµ·æ­¥ä¾èµ– Spring Boot Starter</title>
    <link href="https://y0ngb1n.github.io/a/coustomize-your-own-spring-boot-starter.html"/>
    <id>https://y0ngb1n.github.io/a/coustomize-your-own-spring-boot-starter.html</id>
    <published>2019-05-02T23:16:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åœ¨è¿™é‡Œæˆ‘ä»¬ä¸€èµ·åŠ¨æ‰‹å®ç°ä¸€ä¸ªå±äºè‡ªå·±çš„èµ·æ­¥ä¾èµ–</p></blockquote><p><sub>ä»£ç æ‰˜ç®¡äº <a href="https://github.com/y0ngb1n/spring-boot-samples" target="_blank" rel="noopener">GitHub</a>ï¼Œæ¬¢è¿ Star ğŸ˜˜</sub></p><h2 id="ä¸»è¦å†…å®¹"><a class="markdownIt-Anchor" href="#ä¸»è¦å†…å®¹"></a> ä¸»è¦å†…å®¹</h2><p>ä¸»è¦åŠ å…¥ä¸¤ä¸ªæ¨¡å—ï¼Œä¸€ä¸ªæ˜¯ä¸è‡ªåŠ¨é…ç½®ç›¸å…³çš„æ¨¡å—ï¼Œå¦‚æœä½ çš„ä¾èµ–éœ€è¦åšè‡ªåŠ¨é…ç½®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨é‡Œé¢å†™ä¸Šè‡ªåŠ¨é…ç½®ã€‚å¦ä¸€ä¸ªæ˜¯ <code>starter</code> æ¨¡å—ï¼Œå®ƒé‡Œé¢å°±æ˜¯ä¸€äº›ä¾èµ–é¡¹ï¼Œé¦–å…ˆå°±æ˜¯æŒ‡å‘æˆ‘ä»¬çš„ <code>autoconfigure</code> æ¨¡å—çš„ä¸€ä¸ªä¾èµ–ï¼Œå¦å¤–å°±æ˜¯å½“å‰è¿™ä¸ª Starter æ‰€è‡ªå·±éœ€è¦çš„ä¾èµ–é¡¹ã€‚</p><ul><li><code>autoconfigure</code> æ¨¡å—ï¼ŒåŒ…å«è‡ªåŠ¨é…ç½®ä»£ç </li><li><code>starter</code> æ¨¡å—ï¼ŒåŒ…å«æŒ‡å‘è‡ªåŠ¨é…ç½®æ¨¡å—çš„ä¾èµ–åŠå…¶ä»–ç›¸å…³ä¾èµ–</li></ul><p>è¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼Œ<code>autoconfigure</code> å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœå½“å‰è¿™ä¸ªæ¨¡å—å¹¶ä¸éœ€è¦ä»€ä¹ˆè‡ªåŠ¨é…ç½®ï¼Œå°±å¯ä»¥æŠŠå®ƒå»æ‰ã€‚è€Œ Spring Boot ç›¸å…³çš„é‚£äº›è‡ªåŠ¨é…ç½®å¾ˆå¤šéƒ½æ˜¯é›†ä¸­åœ¨ <code>spring-boot-autoconfigure</code> é‡Œé¢çš„ï¼Œæ‰€ä»¥å®ƒåªè¦ä¾èµ–äº† <code>spring-boot-starter</code>ï¼Œé‚£ä¹ˆå°±ä¼šè‡ªåŠ¨åœ°åŠ å…¥è¿™äº› Autoconfigureã€‚</p><h2 id="å‘½åæ–¹å¼"><a class="markdownIt-Anchor" href="#å‘½åæ–¹å¼"></a> å‘½åæ–¹å¼</h2><p>ä¸€èˆ¬æ˜¯å»ºè®®åœ¨å‰é¢åŠ ä¸Šä¸€ä¸ªå‰ç¼€ï¼Œä¸»è¦æ˜¯ä¸ Spring Boot å®˜æ–¹çš„é‚£äº›ä¾èµ–åšåŒºåˆ†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>xxx-spring-boot-autoconfigure</li><li>xxx-spring-boot-starter</li></ul><p>è¿™æ ·å°±å¯ä»¥å®šä¹‰ä¸€ä¸ªä½ è‡ªå·±çš„ Spring Boot Starter äº†ã€‚</p><h2 id="ä¸€äº›æ³¨æ„äº‹é¡¹"><a class="markdownIt-Anchor" href="#ä¸€äº›æ³¨æ„äº‹é¡¹"></a> ä¸€äº›æ³¨æ„äº‹é¡¹</h2><ul><li><p><strong>ä¸è¦ä½¿ç”¨ <code>spring-boot</code> ä½œä¸ºä¾èµ–çš„å‰ç¼€</strong></p><p>å¦‚æœä½ è¿™æ ·åšäº†ï¼Œä¼šå’Œ Spring Boot å®˜æ–¹çš„é‚£äº›ä¾èµ–æ··åœ¨ä¸€èµ·ï¼Œä»è€Œå¯¼è‡´ä¸å¥½è¾¨è®¤ã€‚</p></li><li><p><strong>ä¸è¦ä½¿ç”¨ <code>spring-boot</code> çš„é…ç½®å‘½åç©ºé—´</strong></p><p>å¦å¤–å¦‚æœä½ æœ‰ä¸€äº›é…ç½®ï¼Œè¿™é‡Œä¹Ÿæ˜¯å»ºè®®ä¸è¦ä½¿ç”¨ Spring Boot å·²ç»åœ¨ä½¿ç”¨çš„é…ç½®å‘½åç©ºé—´ã€‚æ¯”æ–¹è¯´å®ƒé‡Œé¢æœ‰ <code>server</code>ã€<code>management</code> ç›¸å…³çš„è¿™äº›é…ç½®é¡¹ï¼Œé‚£ä¹ˆä½ å°±ä¸è¦å†ä½¿ç”¨ä»¥ <code>server</code>ã€<code>management</code> å‘½åå‰ç¼€çš„é…ç½®äº†ã€‚</p></li><li><p><code>starter</code> ä¸­ä»…æ·»åŠ å¿…è¦çš„ä¾èµ–</p><p>åœ¨å½“å‰è¿™ä¸ª Starter ä¸­åªåŠ å…¥å¿…è¦çš„ä¾èµ–å°±å¯ä»¥äº†ã€‚ä¹Ÿè®¸è¿™ä¸ªè¦æ±‚æœ‰ç‚¹è‹›å…‹ï¼Œä½†è¿™é‡Œçš„å»ºè®®æ˜¯å¸Œæœ›ä½ çš„ä¾èµ–ä¸å¤šä¸å°‘ã€æ­£æ­£å¥½å¥½ï¼Œä½ è¦ä½¿ç”¨åˆ°å“ªäº›ä¾èµ–å°±åªåŠ è¿™äº›ä¾èµ–å°±å¥½ï¼›å¦‚æœæ²¡æœ‰å¿…è¦åŠ è¿›å»çš„å°±å¯ä»¥å»æ‰å®ƒï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯å¯ä»¥å‡å°‘æœ€ç»ˆæ‰“å‡ºæ¥çš„åŒ…é‡Œé¢çš„ä¾èµ–ã€‚</p></li><li><p>å£°æ˜å¯¹ <code>spring-boot-starter</code> çš„ä¾èµ–</p><p>å¦‚æœæœ‰éœ€è¦çš„å¯ä»¥åœ¨è¿™ä¸ª Starter å½“ä¸­åŠ å…¥ <code>spring-boot-starter</code> è¿™ä¸ªä¾èµ–ã€‚è¿™ä¸ªå¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨å¾ˆå¤šçš„å·¥ç¨‹æœ¬èº«å°±æ˜¯ <code>spring-boot</code> çš„ä¸€ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥å®ƒæœ¬èº«å°±æ·»åŠ äº†å¯¹ <code>spring-boot-starter</code> çš„ä¾èµ–ã€‚è¿™ä¸ªè¦çœ‹ä½ çš„éœ€è¦æ¥å†³å®šä¸€ä¸‹æ˜¯å¦è¦æ·»åŠ ã€‚</p></li></ul><hr><h2 id="æ’¸èµ·è¢–å­åŠ æ²¹å¹²"><a class="markdownIt-Anchor" href="#æ’¸èµ·è¢–å­åŠ æ²¹å¹²"></a> æ’¸èµ·è¢–å­åŠ æ²¹å¹²</h2><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹éƒ½æœ‰å“ªäº›æ–¹å¼å¯ä»¥å®ç°è‡ªåŠ¨é…ç½®</p><ul><li><p><strong>ä¼ ç»Ÿæ‰‹å·¥å®ç°çš„è‡ªåŠ¨é…ç½®</strong>ï¼ˆè§ <a href="https://github.com/y0ngb1n/spring-boot-samples/tree/master/spring-boot-samples-custom-starter/custom-starter-spring-lt4-autoconfigure" target="_blank" rel="noopener"><code>custom-starter-spring-lt4-autoconfigure</code></a>ï¼‰</p><blockquote><p><strong>æ³¨</strong>ï¼šåœ¨ä½ç‰ˆæœ¬çš„ Spring ä¸­èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼å¿«é€Ÿå®ç°ç±»ä¼¼è‡ªåŠ¨é…ç½®çš„åŠŸèƒ½ã€‚</p></blockquote><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.y0ngb1n.samples<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>custom-starter-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>åŸºäº Spring Boot çš„è‡ªåŠ¨é…ç½®</strong>ï¼ˆè§ <a href="https://github.com/y0ngb1n/spring-boot-samples/tree/master/spring-boot-samples-custom-starter/custom-starter-spring-boot-autoconfigure" target="_blank" rel="noopener"><code>custom-starter-spring-boot-autoconfigure</code></a>ï¼‰</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.y0ngb1n.samples<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>custom-starter-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>å¼•ç”¨è‡ªå®šä¹‰ Starter</strong>ï¼ˆè§ <a href="https://github.com/y0ngb1n/spring-boot-samples/tree/master/spring-boot-samples-custom-starter/custom-starter-spring-boot-starter" target="_blank" rel="noopener"><code>custom-starter-spring-boot-starter</code></a>ï¼‰</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.y0ngb1n.samples<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>custom-starter-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>è¿è¡Œ <a href="https://github.com/y0ngb1n/spring-boot-samples/tree/master/spring-boot-samples-custom-starter/custom-starter-examples" target="_blank" rel="noopener"><code>custom-starter-examples</code></a> æ•ˆæœå¦‚ä¸‹ï¼š</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">  .   ____          _            __ _ _</span><br><span class="line"> /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \</span><br><span class="line">( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \</span><br><span class="line"> \\/  ___)| |_)| | | | | || (_| |  ) ) ) )</span><br><span class="line">  '  |____| .__|_| |_|_| |_\__, | / / / /</span><br><span class="line"> =========|_|==============|___/=/_/_/_/</span><br><span class="line"> :: Spring Boot ::        (v2.1.0.RELEASE)</span><br><span class="line"></span><br><span class="line">2019-05-02 23:15:56.183  INFO 17236 --- [           main] i.g.y.s.d.AutoconfigureDemoApplication   : Starting AutoconfigureDemoApplication on HP with PID 17236 ...</span><br><span class="line">2019-05-02 23:15:56.208  INFO 17236 --- [           main] i.g.y.s.d.AutoconfigureDemoApplication   : No active profile set, falling back to default profiles: default</span><br><span class="line">2019-05-02 23:15:57.198  INFO 17236 --- [           main] i.g.y.s.g.GreetingApplicationRunner      : Initializing GreetingApplicationRunner.</span><br><span class="line">2019-05-02 23:15:57.478  INFO 17236 --- [           main] i.g.y.s.d.AutoconfigureDemoApplication   : Started AutoconfigureDemoApplication in 2.516 seconds (JVM running for 5.501)</span><br><span class="line">2019-05-02 23:15:57.486  INFO 17236 --- [           main] i.g.y.s.g.GreetingApplicationRunner      : Hello everyone! We all like Spring!</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªç®€å•çš„ Starterï¼Œåœ¨é‡Œé¢åŠ å…¥è‡ªå·±çš„è‡ªåŠ¨é…ç½®å’Œç›¸å…³çš„ä¾èµ–ã€‚é‚£ä¹ˆåˆ°è¿™é‡Œä½ ä¹Ÿå¯ä»¥å®ç°ä¸€ä¸ªå±äºä½ çš„ Starterï¼Œä»è€Œç®€åŒ–ä½ çš„ Maven ä¾èµ–é¡¹ã€‚</p><hr><h2 id="å‚è€ƒé“¾æ¥"><a class="markdownIt-Anchor" href="#å‚è€ƒé“¾æ¥"></a> å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://github.com/y0ngb1n/spring-boot-samples" target="_blank" rel="noopener">https://github.com/y0ngb1n/spring-boot-samples</a></li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/</a></li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-developing-auto-configuration.html" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-developing-auto-configuration.html</a></li><li><a href="https://medium.com/@alexeynovikov_89393/how-to-write-your-own-spring-boot-starters-566ce5992954" target="_blank" rel="noopener">https://medium.com/@alexeynovikov_89393/how-to-write-your-own-spring-boot-starters-566ce5992954</a></li><li><a href="https://github.com/digitalsonic/geektime-spring-family" target="_blank" rel="noopener">https://github.com/digitalsonic/geektime-spring-family</a></li><li><a href="https://github.com/marcosbarbero/spring-cloud-zuul-ratelimit" target="_blank" rel="noopener">https://github.com/marcosbarbero/spring-cloud-zuul-ratelimit</a></li><li><a href="https://github.com/biezhi/keeper" target="_blank" rel="noopener">https://github.com/biezhi/keeper</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;åœ¨è¿™é‡Œæˆ‘ä»¬ä¸€èµ·åŠ¨æ‰‹å®ç°ä¸€ä¸ªå±äºè‡ªå·±çš„èµ·æ­¥ä¾èµ–&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;sub&gt;ä»£ç æ‰˜ç®¡äº &lt;a href=&quot;https://github.com/y0ngb1n/spring-boot-samples&quot; target=&quot;_bla
      
    
    </summary>
    
    
      <category term="spring-boot" scheme="https://y0ngb1n.github.io/tags/spring-boot/"/>
    
      <category term="starter" scheme="https://y0ngb1n.github.io/tags/starter/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•åœ¨ä½ç‰ˆæœ¬çš„ Spring ä¸­å¿«é€Ÿå®ç°ç±»ä¼¼è‡ªåŠ¨é…ç½®çš„åŠŸèƒ½</title>
    <link href="https://y0ngb1n.github.io/a/coustomize-your-own-autoconfigure-whit-spring-less-than-version-4.html"/>
    <id>https://y0ngb1n.github.io/a/coustomize-your-own-autoconfigure-whit-spring-less-than-version-4.html</id>
    <published>2019-05-02T21:00:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åœ¨ Spring 4 åæ‰å¼•å…¥äº† <code>@Conditional</code> ç­‰æ¡ä»¶æ³¨è§£ï¼Œå®ƒæ˜¯ Spring Boot ä¸­å®ç°è‡ªåŠ¨é…ç½®çš„æœ€å¤§åŠŸè‡£ï¼<br>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š<strong>å¦‚æœæˆ‘ä»¬è¿˜åœ¨ä½¿ç”¨ Spring 3.x çš„è€ç‰ˆæœ¬ï¼Œè¿™æ—¶å€™è¦æ€ä¹ˆå®ç°ä¸€ä¸ªè‡ªåŠ¨é…ç½®å‘¢ï¼Ÿ</strong></p></blockquote><p><sub>ä»£ç æ‰˜ç®¡äº <a href="https://github.com/y0ngb1n/spring-boot-samples" target="_blank" rel="noopener">GitHub</a>ï¼Œæ¬¢è¿ Star ğŸ˜˜</sub></p><h2 id="éœ€æ±‚å’Œé—®é¢˜"><a class="markdownIt-Anchor" href="#éœ€æ±‚å’Œé—®é¢˜"></a> éœ€æ±‚å’Œé—®é¢˜</h2><h3 id="æ ¸å¿ƒçš„è¯‰æ±‚"><a class="markdownIt-Anchor" href="#æ ¸å¿ƒçš„è¯‰æ±‚"></a> æ ¸å¿ƒçš„è¯‰æ±‚</h3><ul><li>ç°å­˜ç³»ç»Ÿï¼Œä¸æ‰“ç®—é‡æ„</li><li>Spring ç‰ˆæœ¬ä¸º 3.xï¼Œä¹Ÿä¸æ‰“ç®—å‡çº§ç‰ˆæœ¬å’Œå¼•å…¥ Spring Boot</li><li>æœŸæœ›èƒ½å¤Ÿåœ¨å°‘æ”¹ä»£ç çš„å‰æä¸‹å®ç°åŠŸèƒ½å¢å¼º</li></ul><p>æ¯”å¦‚è¯´ï¼š</p><ul><li>å¸Œæœ›èƒ½å¤Ÿç»™å…¨ç«™ç»Ÿä¸€æ·»åŠ ä¸Šæ—¥å¿—è®°å½•ï¼ˆå¦‚ï¼šRPC æ¡†æ¶ Web è°ƒç”¨çš„æ‘˜è¦ä¿¡æ¯ã€æ•°æ®åº“è®¿é—®å±‚çš„æ‘˜è¦ä¿¡æ¯ï¼‰ï¼Œè¿™ä¸ªå…¶å®æ˜¯ä¸ªé€šç”¨çš„åŠŸèƒ½ã€‚</li><li>æˆ‘ä»¬å¼•ç”¨äº†ä¸€äº›åŸºç¡€è®¾æ–½ï¼Œå¹¶æƒ³å¯¹è¿™äº›åŸºç¡€è®¾æ–½çš„åŠŸèƒ½ä½œè¿›ä¸€æ­¥çš„å¢å¼ºï¼Œè¿™æ—¶å€™å°±åº”è¯¥ä»æ¡†æ¶çš„å±‚é¢æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</li></ul><h3 id="é¢ä¸´çš„é—®é¢˜"><a class="markdownIt-Anchor" href="#é¢ä¸´çš„é—®é¢˜"></a> é¢ä¸´çš„é—®é¢˜</h3><ul><li><p>3.x çš„ Spring æ²¡æœ‰æ¡ä»¶æ³¨è§£</p><p>å› ä¸ºæ²¡æœ‰æ¡ä»¶æ³¨è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸æ¸…æ¥šåœ¨ä»€ä¹ˆæ—¶å€™ éœ€è¦/ä¸éœ€è¦ é…ç½®è¿™äº›ä¸œè¥¿</p></li><li><p>æ— æ³•è‡ªåŠ¨å®šä½éœ€è¦åŠ è½½çš„è‡ªåŠ¨é…ç½®</p><p>æ­¤æ—¶æˆ‘ä»¬æ²¡æœ‰åŠæ³•åƒ Spring Boot çš„è‡ªåŠ¨é…ç½®é‚£æ ·è®©æ¡†æ¶è‡ªåŠ¨åŠ è½½æˆ‘ä»¬çš„é…ç½®ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ä¸€äº›åˆ«çš„æ‰‹æ®µè®© Spring å¯ä»¥åŠ è½½åˆ°æˆ‘ä»¬å®šåˆ¶çš„è¿™äº›åŠŸèƒ½ã€‚</p></li></ul><h2 id="æ ¸å¿ƒè§£å†³æ€è·¯"><a class="markdownIt-Anchor" href="#æ ¸å¿ƒè§£å†³æ€è·¯"></a> æ ¸å¿ƒè§£å†³æ€è·¯</h2><h3 id="æ¡ä»¶åˆ¤æ–­"><a class="markdownIt-Anchor" href="#æ¡ä»¶åˆ¤æ–­"></a> æ¡ä»¶åˆ¤æ–­</h3><ul><li>é€šè¿‡ <code>BeanFactoryPostProcessor</code> è¿›è¡Œåˆ¤æ–­</li></ul><p>Spring ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ‰©å±•ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>BeanFactoryPostProcessor</code> æ¥è§£å†³æ¡ä»¶åˆ¤æ–­çš„é—®é¢˜ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬åœ¨ <code>BeanFactory</code> å®šä¹‰å®Œä¹‹åã€Bean çš„åˆå§‹åŒ–ä¹‹å‰å¯¹æˆ‘ä»¬è¿™äº› Bean çš„å®šä¹‰åšä¸€äº›åç½®çš„å¤„ç†ã€‚å¯ä»¥åœ¨è¿™ä¸ªæ—¶å€™å¯¹æˆ‘ä»¬çš„ Bean å®šä¹‰åšåˆ¤æ–­ï¼Œçœ‹çœ‹å½“å‰ å­˜åœ¨/ç¼ºå°‘ å“ªäº› Bean çš„å®šä¹‰ï¼Œè¿˜å¯ä»¥å¢åŠ ä¸€äº› Bean çš„å®šä¹‰ â€”â€” åŠ å…¥ä¸€äº›è‡ªå·±å®šåˆ¶çš„ Beanã€‚</p><h3 id="é…ç½®åŠ è½½"><a class="markdownIt-Anchor" href="#é…ç½®åŠ è½½"></a> é…ç½®åŠ è½½</h3><ul><li>ç¼–å†™ Java Config ç±»</li><li>å¼•å…¥é…ç½®ç±»<ul><li>é€šè¿‡ <code>component-scan</code></li><li>é€šè¿‡ XML æ–‡ä»¶ <code>import</code></li></ul></li></ul><p>å¯ä»¥è€ƒè™‘ç¼–å†™è‡ªå·±çš„ Java Config ç±»ï¼Œå¹¶æŠŠå®ƒåŠ åˆ° <code>component-scan</code> é‡Œé¢ï¼Œç„¶åæƒ³åŠæ³•è®©ç°åœ¨ç³»ç»Ÿçš„ <code>component-scan</code> åŒ…å«æˆ‘ä»¬ç¼–å†™çš„ Java Config ç±»ï¼›ä¹Ÿå¯ä»¥ç¼–å†™ XML æ–‡ä»¶ï¼Œå¦‚æœå½“å‰ç³»ç»Ÿä½¿ç”¨ XML çš„æ–¹å¼ï¼Œé‚£ä¹ˆå®ƒåŠ è½½çš„è·¯å¾„ä¸Šæ˜¯å¦å¯ä»¥åŠ è½½æˆ‘ä»¬çš„ XML æ–‡ä»¶ï¼Œå¦‚æœä¸è¡Œå°±å¯ä»¥ä½¿ç”¨æ‰‹åŠ¨ <code>import</code> è¿™ä¸ªæ–‡ä»¶ã€‚</p><h2 id="spring-æä¾›çš„ä¸¤ä¸ªæ‰©å±•ç‚¹"><a class="markdownIt-Anchor" href="#spring-æä¾›çš„ä¸¤ä¸ªæ‰©å±•ç‚¹"></a> Spring æä¾›çš„ä¸¤ä¸ªæ‰©å±•ç‚¹</h2><h3 id="beanpostprocessor"><a class="markdownIt-Anchor" href="#beanpostprocessor"></a> <code>BeanPostProcessor</code></h3><ul><li>é’ˆå¯¹ Bean å®ä¾‹</li><li>åœ¨ Bean åˆ›å»ºåæä¾›å®šåˆ¶é€»è¾‘å›è°ƒ</li></ul><h3 id="beanfactorypostprocessor"><a class="markdownIt-Anchor" href="#beanfactorypostprocessor"></a> <code>BeanFactoryPostProcessor</code></h3><ul><li>é’ˆå¯¹ Bean å®šä¹‰</li><li>åœ¨å®¹å™¨åˆ›å»º Bean å‰è·å–é…ç½®å…ƒæ•°æ®</li><li>Java Config ä¸­éœ€è¦å®šä¹‰ä¸º <code>static</code> æ–¹æ³•ï¼ˆå¦‚æœä¸å®šä¹‰ï¼ŒSpring åœ¨å¯åŠ¨æ—¶ä¼šæŠ¥ä¸€ä¸ª <code>warning</code>ï¼Œä½ å¯å°è¯•ä¸€ä¸‹ï¼‰</li></ul><h2 id="å…³äº-bean-çš„ä¸€äº›å®šåˆ¶"><a class="markdownIt-Anchor" href="#å…³äº-bean-çš„ä¸€äº›å®šåˆ¶"></a> å…³äº Bean çš„ä¸€äº›å®šåˆ¶</h2><blockquote><p>æ—¢ç„¶ä¸Šé¢æåˆ°äº† Spring çš„ä¸¤ä¸ªæ‰©å±•ç‚¹ï¼Œè¿™é‡Œå°±å»¶å±•ä¸€ä¸‹å…³äº Bean çš„ä¸€äº›å®šåˆ¶çš„æ–¹å¼ã€‚</p></blockquote><h3 id="lifecycle-callback"><a class="markdownIt-Anchor" href="#lifecycle-callback"></a> Lifecycle Callback</h3><ul><li><p><code>InitializingBean</code> / <code>@PostConstruct</code> / <code>init-method</code></p><p>è¿™éƒ¨åˆ†æ˜¯å…³äºåˆå§‹åŒ–çš„ï¼Œå¯ä»¥åœ¨ Bean çš„åˆå§‹åŒ–ä¹‹ååšä¸€äº›å®šåˆ¶ï¼Œè¿™é‡Œæœ‰ä¸‰ç§æ–¹å¼ï¼š</p><ul><li>å®ç° <code>InitializingBean</code> æ¥å£</li><li>ä½¿ç”¨ <code>@PostConstruct</code> æ³¨è§£</li><li>åœ¨ Bean å®šä¹‰çš„ XML æ–‡ä»¶é‡Œç»™å®ƒæŒ‡å®šä¸€ä¸ª <code>init-method</code>ï¼›äº¦æˆ–è€…åœ¨ä½¿ç”¨ <code>@Bean</code> æ³¨è§£æ—¶æŒ‡å®š <code>init-method</code></li></ul><p>è¿™äº›éƒ½å¯ä»¥è®©æˆ‘ä»¬è¿™ä¸ª Bean åœ¨åˆ›å»ºä¹‹åå»è°ƒç”¨ç‰¹å®šçš„æ–¹æ³•ã€‚</p></li><li><p><code>DisposableBean</code> / <code>@PreDestroy</code> / <code>destroy-method</code></p><p>è¿™éƒ¨åˆ†æ˜¯åœ¨ Bean å›æ”¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯¥åšçš„ä¸€äº›æ“ä½œã€‚å¯ä»¥æŒ‡å®šè¿™ä¸ª Bean åœ¨é”€æ¯çš„æ—¶å€™ï¼Œå¦‚æœï¼š</p><ul><li>å®ƒå®ç°äº† <code>DisposableBean</code> è¿™ä¸ªæ¥å£ï¼Œé‚£ä¹ˆ Spring ä¼šå»è°ƒç”¨å®ƒç›¸åº”çš„æ–¹æ³•</li><li>ä¹Ÿå¯ä»¥å°† <code>@PreDestroy</code> æ³¨è§£åŠ åœ¨æŸä¸ªæ–¹æ³•ä¸Šï¼Œé‚£ä¹ˆä¼šåœ¨é”€æ¯æ—¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•</li><li>åœ¨ Bean å®šä¹‰çš„ XML æ–‡ä»¶é‡Œç»™å®ƒæŒ‡å®šä¸€ä¸ª <code>destroy-method</code>ï¼›äº¦æˆ–è€…åœ¨ä½¿ç”¨ <code>@Bean</code> æ³¨è§£æ—¶æŒ‡å®š <code>destroy-method</code>ï¼Œé‚£ä¹ˆä¼šåœ¨é”€æ¯æ—¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•</li></ul></li></ul><h3 id="xxxaware-æ¥å£"><a class="markdownIt-Anchor" href="#xxxaware-æ¥å£"></a> XxxAware æ¥å£</h3><ul><li><p><code>ApplicationContextAware</code></p><p>å¯ä»¥æŠŠæ•´ä¸ª <code>ApplicationContext</code> é€šè¿‡æ¥å£è¿›è¡Œæ³¨å…¥ï¼Œåœ¨è¿™ä¸ª Bean é‡Œæˆ‘ä»¬å°±å¯ä»¥è·å¾—ä¸€ä¸ªå®Œæ•´çš„ <code>ApplicationContext</code>ã€‚</p></li><li><p><code>BeanFactoryAware</code></p><p>ä¸ <code>ApplicationContextAware</code> ç±»ä¼¼ã€‚</p></li><li><p><code>BeanNameAware</code></p><p>å¯ä»¥æŠŠ Bean çš„åå­—æ³¨å…¥åˆ°è¿™ä¸ªå®ä¾‹ä¸­æ¥ã€‚</p></li></ul><blockquote><p>å¦‚æœå¯¹æºç æ„Ÿå…´è¶£ï¼Œå¯è§ï¼š<code>org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean</code><br>å¦‚æœå½“å‰ Bean å­˜åœ¨ <code>close</code> æˆ– <code>shutdown</code> æ–¹æ³•åçš„æ–¹æ³•æ—¶ï¼Œä¼šè¢« Spring è§†ä¸º <code>destroy-method</code>ï¼Œåœ¨é”€æ¯æ—¶ä¼šè¿›è¡Œè°ƒç”¨ã€‚</p></blockquote><h2 id="ä¸€äº›å¸¸ç”¨æ“ä½œ"><a class="markdownIt-Anchor" href="#ä¸€äº›å¸¸ç”¨æ“ä½œ"></a> ä¸€äº›å¸¸ç”¨æ“ä½œ</h2><h3 id="åˆ¤æ–­ç±»æ˜¯å¦å­˜åœ¨"><a class="markdownIt-Anchor" href="#åˆ¤æ–­ç±»æ˜¯å¦å­˜åœ¨"></a> åˆ¤æ–­ç±»æ˜¯å¦å­˜åœ¨</h3><ul><li><code>ClassUitls.isPresent()</code></li></ul><p>è°ƒç”¨ Spring æä¾›çš„ <code>ClassUitls.isPresent()</code> æ¥åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯å¦å­˜åœ¨å½“å‰ Class Path ä¸‹ã€‚</p><h3 id="åˆ¤æ–­-bean-æ˜¯å¦å·²å®šä¹‰"><a class="markdownIt-Anchor" href="#åˆ¤æ–­-bean-æ˜¯å¦å·²å®šä¹‰"></a> åˆ¤æ–­ Bean æ˜¯å¦å·²å®šä¹‰</h3><ul><li><code>ListableBeanFactory.containsBeanDefinition()</code>ï¼šåˆ¤æ–­ Bean æ˜¯å¦å·²å®šä¹‰ã€‚</li><li><code>ListableBeanFactory.getBeanNamesForType()</code>ï¼šå¯ä»¥æŸ¥çœ‹æŸäº›ç±»å‹çš„ Bean éƒ½æœ‰å“ªäº›åå­—å·²ç»è¢«å®šä¹‰äº†ã€‚</li></ul><h3 id="æ³¨å†Œ-bean-å®šä¹‰"><a class="markdownIt-Anchor" href="#æ³¨å†Œ-bean-å®šä¹‰"></a> æ³¨å†Œ Bean å®šä¹‰</h3><ul><li><code>BeanDefinitionRegistry.registerBeanDefinition()</code><ul><li><code>GenericBeanDefinition</code></li></ul></li><li><code>BeanFactory.registerSingleton()</code></li></ul><h2 id="æ’¸èµ·è¢–å­åŠ æ²¹å¹²"><a class="markdownIt-Anchor" href="#æ’¸èµ·è¢–å­åŠ æ²¹å¹²"></a> æ’¸èµ·è¢–å­åŠ æ²¹å¹²</h2><blockquote><p>ç†è®ºå°±ç§‘æ™®å®Œäº†ï¼Œä¸‹é¢å°±å¼€å§‹å®è·µã€‚<br>åœ¨å½“å‰çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å‡å®šä¸€ä¸‹å½“å‰ç¯å¢ƒä¸ºï¼š<strong>æ²¡æœ‰ä½¿ç”¨ Spring Boot ä»¥åŠé«˜ç‰ˆæœ¬çš„ Spring</strong>ã€‚</p></blockquote><p><strong>Step 1ï¼šæ¨¡æ‹Ÿä½ç‰ˆæœ¬çš„ Spring ç¯å¢ƒ</strong></p><p>è¿™é‡Œåªæ˜¯ç®€å•åœ°å¼•å…¥äº† <code>spring-context</code> ä¾èµ–ï¼Œå¹¶æ²¡æœ‰çœŸæ­£çš„ä½¿ç”¨ Spring 3.x çš„ç‰ˆæœ¬ï¼Œä½†ä¹Ÿæ²¡æœ‰ä½¿ç”¨ Spring 4 ä»¥ä¸Šçš„ä¸€äº›ç‰¹æ€§ã€‚</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.y0ngb1n.samples<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>custom-starter-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>Step 2ï¼šä»¥å®ç° <code>BeanFactoryPostProcessor</code> æ¥å£ä¸ºä¾‹</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GreetingBeanFactoryPostProcessor</span> <span class="keyword">implements</span> <span class="title">BeanFactoryPostProcessor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postProcessBeanFactory</span><span class="params">(ConfigurableListableBeanFactory beanFactory)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­å½“å‰ Class Path ä¸‹æ˜¯å¦å­˜åœ¨æ‰€éœ€è¦çš„ GreetingApplicationRunner è¿™ä¹ˆä¸€ä¸ªç±»</span></span><br><span class="line">    <span class="keyword">boolean</span> hasClass = ClassUtils</span><br><span class="line">      .isPresent(<span class="string">"io.github.y0ngb1n.samples.greeting.GreetingApplicationRunner"</span>,</span><br><span class="line">        GreetingBeanFactoryPostProcessor.class.getClassLoader());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!hasClass) &#123;</span><br><span class="line">      <span class="comment">// ç±»ä¸å­˜åœ¨</span></span><br><span class="line">      log.info(<span class="string">"GreetingApplicationRunner is NOT present in CLASSPATH."</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¯å¦å­˜åœ¨ id ä¸º greetingApplicationRunner çš„ Bean å®šä¹‰</span></span><br><span class="line">    <span class="keyword">boolean</span> hasDefinition = beanFactory.containsBeanDefinition(<span class="string">"greetingApplicationRunner"</span>);</span><br><span class="line">    <span class="keyword">if</span> (hasDefinition) &#123;</span><br><span class="line">      <span class="comment">// å½“å‰ä¸Šä¸‹æ–‡å·²å­˜åœ¨ greetingApplicationRunner</span></span><br><span class="line">      log.info(<span class="string">"We already have a greetingApplicationRunner bean registered."</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    register(beanFactory);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(ConfigurableListableBeanFactory beanFactory)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (beanFactory <span class="keyword">instanceof</span> BeanDefinitionRegistry) &#123;</span><br><span class="line">      GenericBeanDefinition beanDefinition = <span class="keyword">new</span> GenericBeanDefinition();</span><br><span class="line">      beanDefinition.setBeanClass(GreetingApplicationRunner.class);</span><br><span class="line"></span><br><span class="line">      ((BeanDefinitionRegistry) beanFactory)</span><br><span class="line">        .registerBeanDefinition(<span class="string">"greetingApplicationRunner"</span>, beanDefinition);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">      beanFactory.registerSingleton(<span class="string">"greetingApplicationRunner"</span>, <span class="keyword">new</span> GreetingApplicationRunner());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨å†Œæˆ‘ä»¬çš„ Beanï¼ˆè§ <a href="./src/main/java/io/github/y0ngb1n/samples/autoconfigure/CustomStarterAutoConfiguration.java"><code>CustomStarterAutoConfiguration</code></a>ï¼‰ï¼Œå¦‚ä¸‹æœ‰å‡ ç‚¹æ˜¯éœ€è¦æ³¨æ„çš„ï¼š</p><ul><li>è¿™é‡Œçš„æ–¹æ³•å®šä¹‰ä¸º <code>static</code></li><li>ä½¿ç”¨æ—¶ï¼Œå¦‚æœä¸¤é¡¹ç›®ä¸æ˜¯åœ¨åŒä¸ªåŒ…ä¸‹ï¼Œéœ€è¦ä¸»åŠ¨å°†å½“å‰ç±»åŠ å…¥åˆ°é¡¹ç›®çš„ <code>component-scan</code> é‡Œ</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomStarterAutoConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> GreetingBeanFactoryPostProcessor <span class="title">greetingBeanFactoryPostProcessor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> GreetingBeanFactoryPostProcessor();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Step 3ï¼šéªŒè¯è¯¥è‡ªåŠ¨é…ç½®æ˜¯å¦ç”Ÿæ•ˆ</strong></p><p>åœ¨å…¶ä»–é¡¹ç›®ä¸­æ·»åŠ ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.y0ngb1n.samples<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>custom-starter-spring-lt4-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.y0ngb1n.samples<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>custom-starter-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨é¡¹ç›®å¹¶è§‚å¯Ÿæ—¥å¿—ï¼ˆè§ <a href="https://github.com/y0ngb1n/spring-boot-samples/tree/master/spring-boot-samples-custom-starter/custom-starter-examples" target="_blank" rel="noopener"><code>custom-starter-examples</code></a>ï¼‰ï¼ŒéªŒè¯è‡ªåŠ¨é…ç½®æ˜¯å¦ç”Ÿæ•ˆäº†ï¼š</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">  .   ____          _            __ _ _</span><br><span class="line"> /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \</span><br><span class="line">( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \</span><br><span class="line"> \\/  ___)| |_)| | | | | || (_| |  ) ) ) )</span><br><span class="line">  '  |____| .__|_| |_|_| |_\__, | / / / /</span><br><span class="line"> =========|_|==============|___/=/_/_/_/</span><br><span class="line"> :: Spring Boot ::        (v2.1.0.RELEASE)</span><br><span class="line"></span><br><span class="line">2019-05-02 20:47:27.692  INFO 11460 --- [           main] i.g.y.s.d.AutoconfigureDemoApplication   : Starting AutoconfigureDemoApplication on HP with PID 11460 ...</span><br><span class="line">2019-05-02 20:47:27.704  INFO 11460 --- [           main] i.g.y.s.d.AutoconfigureDemoApplication   : No active profile set, falling back to default profiles: default</span><br><span class="line">2019-05-02 20:47:29.558  INFO 11460 --- [           main] i.g.y.s.g.GreetingApplicationRunner      : Initializing GreetingApplicationRunner.</span><br><span class="line">2019-05-02 20:47:29.577  INFO 11460 --- [           main] i.g.y.s.d.AutoconfigureDemoApplication   : Started AutoconfigureDemoApplication in 3.951 seconds (JVM running for 14.351)</span><br><span class="line">2019-05-02 20:47:29.578  INFO 11460 --- [           main] i.g.y.s.g.GreetingApplicationRunner      : Hello everyone! We all like Spring!</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼Œå·²æˆåŠŸåœ¨ä½ç‰ˆæœ¬çš„ Spring ä¸­å®ç°äº†ç±»ä¼¼è‡ªåŠ¨é…ç½®çš„åŠŸèƒ½ã€‚ğŸ‘</p><hr><h2 id="å‚è€ƒé“¾æ¥"><a class="markdownIt-Anchor" href="#å‚è€ƒé“¾æ¥"></a> å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://github.com/y0ngb1n/spring-boot-samples" target="_blank" rel="noopener">https://github.com/y0ngb1n/spring-boot-samples</a></li><li><a href="https://github.com/digitalsonic/geektime-spring-family" target="_blank" rel="noopener">https://github.com/digitalsonic/geektime-spring-family</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;åœ¨ Spring 4 åæ‰å¼•å…¥äº† &lt;code&gt;@Conditional&lt;/code&gt; ç­‰æ¡ä»¶æ³¨è§£ï¼Œå®ƒæ˜¯ Spring Boot ä¸­å®ç°è‡ªåŠ¨é…ç½®çš„æœ€å¤§åŠŸè‡£ï¼&lt;br&gt;
é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š&lt;strong&gt;å¦‚æœæˆ‘ä»¬è¿˜åœ¨ä½¿ç”¨ Spring 3.x çš„è€ç‰ˆæœ¬ï¼Œè¿™æ—¶
      
    
    </summary>
    
    
      <category term="spring-boot" scheme="https://y0ngb1n.github.io/tags/spring-boot/"/>
    
      <category term="spring" scheme="https://y0ngb1n.github.io/tags/spring/"/>
    
      <category term="autoconfigure" scheme="https://y0ngb1n.github.io/tags/autoconfigure/"/>
    
  </entry>
  
  <entry>
    <title>å°†é—²ç½®ç”µè„‘å‡çº§ä¸ºä¸ªäººæœåŠ¡å™¨ Ubuntu 18.04.2 LTS (Bionic Beaver)</title>
    <link href="https://y0ngb1n.github.io/a/how-to-install-ubuntu-server-18-04-lts.html"/>
    <id>https://y0ngb1n.github.io/a/how-to-install-ubuntu-server-18-04-lts.html</id>
    <published>2019-04-21T09:32:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h2><p>ç”±äºé¸¿å“¥å¤§å­¦é—ç•™ä¸‹æ¥ä¸€éƒ¨å°˜å°çš„å°å¼ä¸»æœºï¼Œæ”¾ç€ç§¯ç°è¿˜ä¸å¦‚æ‹¿æ¥ç»™æˆ‘æŠ˜è…¾ï¼Œè®©å®ƒèƒ½å‘å…‰å‘çƒ­ã€‚æ‰€ä»¥ï¼Œç»è¿‡é¸¿å“¥åŒæ„åï¼Œæˆ‘å†³å®šå°†ç³»ç»Ÿæ¢æˆ <code>Ubuntu 18.04.2 LTS (Bionic Beaver)</code> çš„ Server ç‰ˆæœ¬ï¼Œæ­å»ºå®¶ç”¨å…¼é¡¾å­¦ä¹ å’Œå¨±ä¹çš„ç¯å¢ƒï¼Œä¸»è¦ç”¨äºå¼€å‘å­¦ä¹ ï¼ˆçæŠ˜è…¾ï¼‰çš„æœåŠ¡å™¨ä½¿ç”¨ ğŸ‘Šã€‚</p><p>å°†ç”¨æ¥æ­å»ºæˆ‘çš„ <a href="https://github.com/y0ngb1n/dockerized" target="_blank" rel="noopener"><code>Home Lab</code></a>ï¼Œè¿è¡Œä¸€äº›åŒ…æ‹¬ä½†ä¸ä»…é™äºä»¥ä¸‹çš„æœåŠ¡ï¼š</p><table><thead><tr><th>æœåŠ¡</th><th>ç®€ä»‹</th></tr></thead><tbody><tr><td><a href="https://github.com/y0ngb1n/dockerized/tree/master/nginx-proxy" target="_blank" rel="noopener">nginx-proxy</a></td><td>åŸºäº Docker çš„è‡ªåŠ¨åŒ–ç½‘å…³</td></tr><tr><td><a href="https://github.com/y0ngb1n/dockerized/tree/master/pi-hole" target="_blank" rel="noopener">Pi-hole</a></td><td>è¿‡æ»¤å®¶ä¸­å¹¿å‘Š</td></tr><tr><td>GitLab</td><td>ç§äººä»£ç ä»“åº“</td></tr><tr><td>Jenkins</td><td>æŒç»­é›†æˆå¼•æ“</td></tr><tr><td>Bitwarden</td><td>ç§äººå¯†ç ç®¡å®¶</td></tr><tr><td>â€¦</td><td>â€¦</td></tr></tbody></table><p>æ›´å¤šçš„æœåŠ¡åç»­ä¼šåœ¨ã€Œ<a href="https://github.com/y0ngb1n/dockerized" target="_blank" rel="noopener">y0ngb1n/dockerized</a>ã€è¿›è¡Œç»´æŠ¤ï¼Œæ¬¢è¿ Star ğŸŒŸã€‚</p><h2 id="è·å–-ubuntu-ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#è·å–-ubuntu-ç³»ç»Ÿ"></a> è·å– Ubuntu ç³»ç»Ÿ</h2><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢ä»»ä¸€æºè¿›è¡Œè·å– <code>Ubuntu 18.04.2 LTS (Bionic Beaver)</code> ç³»ç»Ÿé•œåƒï¼š</p><table><thead><tr><th>æ¥æº</th><th>ç«™ç‚¹</th></tr></thead><tbody><tr><td>Ubuntu å®˜ç½‘</td><td><a href="http://releases.ubuntu.com/18.04/" target="_blank" rel="noopener">http://releases.ubuntu.com/18.04/</a></td></tr><tr><td>é˜¿é‡Œå·´å·´å¼€æºé•œåƒç«™</td><td><a href="https://mirrors.aliyun.com/ubuntu-releases/18.04/" target="_blank" rel="noopener">https://mirrors.aliyun.com/ubuntu-releases/18.04/</a></td></tr><tr><td>æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™</td><td><a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu-releases/18.04/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/ubuntu-releases/18.04/</a></td></tr></tbody></table><p>å½“å‰æˆ‘è¦ä¸‹è½½çš„æ–‡ä»¶åä¸º <code>ubuntu-18.04.2-live-server-amd64.iso</code>ï¼Œä¸‹è½½åœ°å€ä¸º <code>https://mirrors.aliyun.com/ubuntu-releases/18.04/ubuntu-18.04.2-live-server-amd64.iso</code>ï¼Œä½¿ç”¨é˜¿é‡Œå·´å·´å¼€æºé•œåƒç«™çš„æºï¼Œæ–‡ä»¶å¤§å°ä¸º <code>834.00 MB</code>ã€‚</p><h2 id="å®‰è£…-ubuntu-ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#å®‰è£…-ubuntu-ç³»ç»Ÿ"></a> å®‰è£… Ubuntu ç³»ç»Ÿ</h2><p>å®‰è£…ç³»ç»Ÿå‰ï¼Œå…ˆè¦å‡†å¤‡ä¸€ä¸ªå®¹é‡å¤§äº 4G çš„ U ç›˜ã€ä¸€æ¬¾è¶æ‰‹çš„é•œåƒåˆ»å½•å·¥å…·ï¼ˆæˆ‘é€‰ Etcherï¼‰ã€‚</p><h3 id="step-1è·å–-etcher"><a class="markdownIt-Anchor" href="#step-1è·å–-etcher"></a> Step 1ï¼šè·å– <a href="https://etcher.io/" target="_blank" rel="noopener">Etcher</a></h3><blockquote><p>Flash OS images to SD cards &amp; USB drives, safely and easily.</p></blockquote><p>Etcher æ˜¯ä¸€æ¬¾<a href="https://github.com/balena-io/etcher" target="_blank" rel="noopener">å¼€æº</a>çš„å¿«é€Ÿåˆ»å½•è½¯ä»¶ï¼Œç”¨å®ƒå¯ä»¥å¿«é€Ÿåˆ¶ä½œ U ç›˜é•œåƒå·¥å…·ã€‚å®ƒç®€å•åˆ°åªæœ‰ä¸€ä¸ªé«˜é¢œå€¼çš„ç•Œé¢ï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©ä½ å°†ç³»ç»Ÿé•œåƒæ–‡ä»¶ï¼ˆå¦‚ <code>.iso, .img, .dmg, .zip</code> ç­‰æ ¼å¼ï¼‰å¿«é€Ÿçƒ§å½•è¿› USB è®¾å¤‡ï¼ˆU ç›˜ï¼‰æˆ–è€… SD å¡ä¸­ã€‚<a href="https://etcher.io/" target="_blank" rel="noopener">è¿™å¯ä¸‹è½½ Etcher çš„æœ€æ–°ç‰ˆæœ¬</a></p><p><img src="https://i.loli.net/2019/05/03/5ccc061b0088b.png" alt="Etcher App"></p><p>ç•Œé¢ç®€æ´ï¼Œæ“ä½œç®€å•ï¼Œåˆ†ä¸‰æ­¥èµ°ï¼š</p><ol><li>é€‰æ‹©é•œåƒæ–‡ä»¶</li><li>é€‰æ‹©ç£ç›˜</li><li>å¼€å§‹çƒ§å½•</li></ol><h3 id="step-2åˆ¶ä½œç³»ç»Ÿå¯åŠ¨ç›˜"><a class="markdownIt-Anchor" href="#step-2åˆ¶ä½œç³»ç»Ÿå¯åŠ¨ç›˜"></a> Step 2ï¼šåˆ¶ä½œç³»ç»Ÿå¯åŠ¨ç›˜</h3><p>å…ˆå°† U ç›˜è¿æ¥ä¸Šç”µè„‘ï¼Œç„¶åæ‰“å¼€ Etcherï¼Œå¹¶é€‰æ‹©åˆšä¸‹è½½å¥½çš„ç³»ç»Ÿé•œåƒå’Œ U ç›˜ï¼Œç„¶åç‚¹å‡» <code>Flash!</code> æŒ‰é’®ï¼Œå‰©ä¸‹çš„å°±ç•™ç»™ Etcher å¸®ä½ å®Œæˆå°±å¥½äº†ã€‚</p><h3 id="step-3åˆ·å…¥-ubuntu-ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#step-3åˆ·å…¥-ubuntu-ç³»ç»Ÿ"></a> Step 3ï¼šåˆ·å…¥ Ubuntu ç³»ç»Ÿ</h3><p>å…ˆå°†è¦åˆ·å…¥ç³»ç»Ÿçš„ä¸»æœºæ–­ç”µï¼Œå¹¶å°† U ç›˜ã€é”®ç›˜ã€æ˜¾ç¤ºå™¨è¿æ¥ä¸Šã€‚é€šç”µåè¿›è¡Œå¼€æœºï¼Œæ­¤æ—¶è¿æŒ‰ <code>Escape</code>, <code>F2</code>, <code>F10</code>, <code>F12</code> æˆ–è€…ç•™æ„å±å¹•ä¸Šçš„æç¤ºï¼ˆæ­¤å¤„ä¸åŒæœºå­ä¸ä¸€æ ·ï¼Œå…·ä½“å¯è‡ªè¡Œ Googleï¼‰ï¼Œæˆ‘çš„æ˜¯åç¡•çš„ä¸»æ¿ï¼Œå¼€æœºæ—¶æç¤ºæˆ‘å¯ä»¥ç‚¹ <code>F2</code> æˆ– <code>DEL</code> é”®è¿›è¡Œ BIOS ç³»ç»Ÿï¼Œä¸»è¦æ˜¯è®¾ç½®æˆ‘ä»¬çš„ U ç›˜ä½œä¸ºç¬¬ä¸€å¯åŠ¨ç›˜ï¼Œä¼˜å…ˆåŠ è½½ U ç›˜ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½åˆ·ç³»ç»Ÿäº†ã€‚</p><p>æˆåŠŸè¿›è¡Œ U ç›˜åå¯ä»¥å‚è€ƒç”± Ubuntu æä¾›çš„å®‰è£…æŒ‡å—ã€Œ<a href="https://tutorials.ubuntu.com/tutorial/tutorial-install-ubuntu-server" target="_blank" rel="noopener">Install Ubuntu Server</a>ã€è¿›è¡Œå®‰è£…æ“ä½œäº†ã€‚åœ¨è®¾ç½®é•œåƒä¸€æ­¥æ—¶ä½ å¯ä½¿ç”¨é˜¿é‡Œäº‘çš„å…¬å…±é•œåƒæœåŠ¡ï¼Œè¾“å…¥ <code>http://mirrors.aliyun.com/ubuntu/</code> å³å¯ï¼Œè¿™æ ·å¯åŠ é€Ÿä½ çš„å®‰è£…è¿‡ç¨‹ï¼Œå¦åˆ™ä¼šé»˜è®¤èµ°å®˜æ–¹æºã€‚</p><p>æœ€åå°±æ˜¯ç­‰å¾…å®‰è£…å®Œæ¯•äº†ï¼ğŸ‘ å¯¹ï¼Œç­‰å°±è¡Œäº†ã€‚</p><h3 id="step-4ç™»å…¥ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#step-4ç™»å…¥ç³»ç»Ÿ"></a> Step 4ï¼šç™»å…¥ç³»ç»Ÿ</h3><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ssh yangbin@192.168.31.188</span></span><br><span class="line">yangbin@ubuntu:~$ lsb_release -a</span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID: Ubuntu</span><br><span class="line">Description:    Ubuntu 18.04.2 LTS</span><br><span class="line">Release:        18.04</span><br><span class="line">Codename:       bionic</span><br></pre></td></tr></table></figure><p>åˆ°æ­¤å°±å¤§åŠŸå‘Šæˆäº†ï¼ğŸ¶</p><hr><h2 id="é…ç½®ç³»ç»Ÿçš„åŸºç¡€ç¯å¢ƒ"><a class="markdownIt-Anchor" href="#é…ç½®ç³»ç»Ÿçš„åŸºç¡€ç¯å¢ƒ"></a> é…ç½®ç³»ç»Ÿçš„åŸºç¡€ç¯å¢ƒ</h2><p>å®‰è£…å®Œç³»ç»Ÿåï¼Œæ¥åšä¸€äº›ç®€å•çš„é…ç½®ã€‚</p><h3 id="é…ç½®è½¯ä»¶æº"><a class="markdownIt-Anchor" href="#é…ç½®è½¯ä»¶æº"></a> é…ç½®è½¯ä»¶æº</h3><p>æ¨èä½¿ç”¨é˜¿é‡Œäº‘çš„æºï¼Œå…ˆåˆ›å»ºè‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/etc/apt/sources.list.d/aliyun.list</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘å†…å®¹å¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse</span><br><span class="line"></span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse</span><br><span class="line"></span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse</span><br><span class="line"></span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</span><br><span class="line"></span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œ:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><p>å³å¯ã€‚</p><h3 id="é…ç½®æ—¶åŒº"><a class="markdownIt-Anchor" href="#é…ç½®æ—¶åŒº"></a> é…ç½®æ—¶åŒº</h3><p>ä¸è¦å¿˜è®°é…ç½®ç³»ç»Ÿæ—¶åŒºï¼Œå°¤å…¶æ˜¯ç°åœ¨æµè¡Œå°†ç³»ç»Ÿæ—¶åŒºé…ç½®æŒ‚è½½åˆ°å®¹å™¨ä¸­ã€‚</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> dpkg-reconfigure tzdata  <span class="comment">#ä½¿ç”¨å‘½ä»¤è¡Œäº¤äº’ç•Œé¢ä¿®æ”¹</span></span></span><br><span class="line"></span><br><span class="line">Current default time zone: 'Asia/Shanghai'</span><br><span class="line">Local time is now:      Fri May  3 20:59:14 CST 2019.</span><br><span class="line">Universal Time is now:  Fri May  3 12:59:14 UTC 2019.</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…å®¹å™¨ç¯å¢ƒ"><a class="markdownIt-Anchor" href="#å®‰è£…å®¹å™¨ç¯å¢ƒ"></a> å®‰è£…å®¹å™¨ç¯å¢ƒ</h3><p><strong>ä¸€é”®å®‰è£… Docker</strong></p><p>ä½¿ç”¨é˜¿é‡Œäº‘åŠ é€Ÿå®‰è£… Dockerï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -fsSL get.docker.com -o get-docker.sh &amp;&amp; \</span><br><span class="line">sudo sh get-docker.sh --mirror Aliyun</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ Docker CE</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> docker &amp;&amp; \</span><br><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure><p><strong>ä¸€é”®å®‰è£… Compose</strong></p><p>Compose æ—¢ç„¶æ˜¯ä¸€ä¸ª Python åº”ç”¨ï¼Œè‡ªç„¶ä¹Ÿå¯ä»¥ç›´æ¥ç”¨å®¹å™¨æ¥æ‰§è¡Œå®ƒï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> DOCKER_COMPOSE_VERSION=1.24.0</span><br><span class="line">curl -L https://github.com/docker/compose/releases/download/<span class="variable">$&#123;DOCKER_COMPOSE_VERSION&#125;</span>/run.sh &gt; /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line">chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure><p><strong>é…ç½®å®¹å™¨é•œåƒæº</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir -p /etc/docker &amp;&amp; touch /etc/docker/daemon.json</span><br><span class="line"></span><br><span class="line">cat &lt;&lt;EOF &gt; /etc/docker/daemon.json</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"registry-mirrors"</span>: [</span><br><span class="line">        <span class="string">"https://registry.docker-cn.com"</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure><hr><blockquote><p>æ›´å¤šé…ç½®å¯å‚è€ƒã€Œ<a href="https://soulteary.com/2019/04/06/configure-ubuntu-18-04.html" target="_blank" rel="noopener">Ubuntu 18.04 åŸºç¡€ç³»ç»Ÿé…ç½®</a>ã€è§£é”æ›´å¤šå§¿åŠ¿ã€‚</p></blockquote><hr><h2 id="å‚è€ƒé“¾æ¥"><a class="markdownIt-Anchor" href="#å‚è€ƒé“¾æ¥"></a> å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://tutorials.ubuntu.com/tutorial/tutorial-install-ubuntu-server" target="_blank" rel="noopener">https://tutorials.ubuntu.com/tutorial/tutorial-install-ubuntu-server</a></li><li><a href="https://www.qingsword.com/qing/1258.html" target="_blank" rel="noopener">https://www.qingsword.com/qing/1258.html</a></li><li><a href="https://www.wikihow.com/Install-Ubuntu-Server" target="_blank" rel="noopener">https://www.wikihow.com/Install-Ubuntu-Server</a></li><li><a href="https://mk-dir.com/installing-ubuntu-server-old-pc/" target="_blank" rel="noopener">https://mk-dir.com/installing-ubuntu-server-old-pc/</a></li><li><a href="https://www.ceos3c.com/open-source/install-ubuntu-server-18-04-lts/" target="_blank" rel="noopener">https://www.ceos3c.com/open-source/install-ubuntu-server-18-04-lts/</a></li><li><a href="https://www.youtube.com/watch?v=w5W_48vyC6U" target="_blank" rel="noopener">https://www.youtube.com/watch?v=w5W_48vyC6U</a></li><li><a href="https://www.youtube.com/watch?v=vt5Lu_ltPkU" target="_blank" rel="noopener">https://www.youtube.com/watch?v=vt5Lu_ltPkU</a></li><li><a href="https://soulteary.com/2019/04/06/configure-ubuntu-18-04.html" target="_blank" rel="noopener">https://soulteary.com/2019/04/06/configure-ubuntu-18-04.html</a></li><li><a href="https://medium.com/@killyourfm/the-beginners-guide-to-installing-ubuntu-linux-18-04-lts-6c8230036d84" target="_blank" rel="noopener">https://medium.com/@killyourfm/the-beginners-guide-to-installing-ubuntu-linux-18-04-lts-6c8230036d84</a></li><li><a href="https://mirrors.ustc.edu.cn/help/dockerhub.html" target="_blank" rel="noopener">https://mirrors.ustc.edu.cn/help/dockerhub.html</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#å‰è¨€&quot;&gt;&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;ç”±äºé¸¿å“¥å¤§å­¦é—ç•™ä¸‹æ¥ä¸€éƒ¨å°˜å°çš„å°å¼ä¸»æœºï¼Œæ”¾ç€ç§¯ç°è¿˜ä¸å¦‚æ‹¿æ¥ç»™æˆ‘æŠ˜è…¾ï¼Œè®©å®ƒèƒ½å‘å…‰å‘çƒ­ã€‚æ‰€ä»¥ï¼Œç»è¿‡é¸¿å“¥åŒæ„åï¼Œæˆ‘å†³å®šå°†ç³»ç»Ÿæ¢æˆ &lt;code&gt;Ubun
      
    
    </summary>
    
    
      <category term="ubuntu" scheme="https://y0ngb1n.github.io/tags/ubuntu/"/>
    
      <category term="linux" scheme="https://y0ngb1n.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Docker é•œåƒç˜¦èº« &amp; ä¼˜åŒ–</title>
    <link href="https://y0ngb1n.github.io/a/8df8f831.html"/>
    <id>https://y0ngb1n.github.io/a/8df8f831.html</id>
    <published>2019-04-20T22:00:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä¸ºä»€ä¹ˆåœ¨å­˜å‚¨å¦‚æ­¤ä¾¿å®œçš„ä»Šå¤©æˆ‘ä»¬ä»ç„¶éœ€è¦å¯¹ Docker é•œåƒè¿›è¡Œç˜¦èº«ï¼Ÿ</p></blockquote><h2 id="å°é•œåƒçš„ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#å°é•œåƒçš„ä¼˜ç‚¹"></a> å°é•œåƒçš„ä¼˜ç‚¹</h2><ol><li>åŠ é€Ÿæ„å»º/éƒ¨ç½²<br>è™½ç„¶å­˜å‚¨èµ„æºè¾ƒä¸ºå»‰ä»·ï¼Œä½†æ˜¯ç½‘ç»œ IO æ˜¯æœ‰é™çš„ï¼Œåœ¨å¸¦å®½æœ‰é™çš„æƒ…å†µä¸‹ï¼Œéƒ¨ç½²ä¸€ä¸ª <code>1G</code> çš„é•œåƒå’Œ <code>10M</code> çš„é•œåƒå¸¦æ¥çš„æ—¶é—´å·®è·å¯èƒ½å°±æ˜¯åˆ†é’Ÿçº§å’Œç§’çº§çš„å·®è·ã€‚ç‰¹åˆ«æ˜¯åœ¨å‡ºç°æ•…éšœï¼ŒæœåŠ¡è¢«è°ƒåº¦åˆ°å…¶ä»–èŠ‚ç‚¹æ—¶ï¼Œè¿™ä¸ªæ—¶é—´å°¤ä¸ºå®è´µ</li><li>æé«˜å®‰å…¨æ€§ï¼Œå‡å°‘æ”»å‡»é¢ç§¯<br>è¶Šå°çš„é•œåƒè¡¨ç¤ºæ— ç”¨çš„ç¨‹åºè¶Šå°‘ï¼Œå¯ä»¥å¤§å¤§çš„å‡å°‘è¢«æ”»å‡»çš„ç›®æ ‡</li><li>å‡å°‘å­˜å‚¨å¼€é”€</li></ol><h2 id="å°é•œåƒçš„åˆ¶ä½œåŸåˆ™"><a class="markdownIt-Anchor" href="#å°é•œåƒçš„åˆ¶ä½œåŸåˆ™"></a> å°é•œåƒçš„åˆ¶ä½œåŸåˆ™</h2><ol><li>é€‰ç”¨æœ€å°çš„åŸºç¡€é•œåƒ</li><li>å‡å°‘å±‚ï¼Œå»é™¤éå¿…è¦çš„æ–‡ä»¶<br>åœ¨å®é™…åˆ¶ä½œé•œåƒçš„è¿‡ç¨‹ä¸­ï¼Œä¸€å‘³çš„åˆå¹¶å±‚ä¸å¯å–ï¼Œéœ€è¦å­¦ä¼šå……åˆ†çš„åˆ©ç”¨ Docker çš„ç¼“å­˜æœºåˆ¶ï¼Œæå–å…¬å…±å±‚ï¼ŒåŠ é€Ÿæ„å»º<ul><li>ä¾èµ–æ–‡ä»¶å’Œå®é™…çš„ä»£ç æ–‡ä»¶å•ç‹¬åˆ†å±‚</li><li>å›¢é˜Ÿ/å…¬å¸é‡‡ç”¨å…¬å…±çš„åŸºç¡€é•œåƒç­‰</li></ul></li><li>ä½¿ç”¨å¤šé˜¶æ®µæ„å»º<br>å¾€å¾€æˆ‘ä»¬åœ¨æ„å»ºé˜¶æ®µå’Œå®é™…è¿è¡Œé˜¶æ®µéœ€è¦çš„ä¾èµ–ç¯å¢ƒæ˜¯ä¸åŒçš„ï¼Œä¾‹å¦‚ <code>Golang</code> ç¼–å†™çš„ç¨‹åºå®é™…è¿è¡Œçš„æ—¶å€™ä»…ä»…éœ€è¦ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å³å¯ï¼Œå¯¹äº <code>Node.js</code> æ¥è¯´ï¼Œå¯èƒ½æœ€åè¿è¡Œçš„åªæ˜¯ä¸€äº›æ‰“åŒ…ä¹‹åçš„ <code>js</code> æ–‡ä»¶è€Œä¸éœ€è¦åŒ…å« <code>node_modules</code> é‡Œæˆåƒä¸Šä¸‡çš„ä¾èµ–</li></ol><h2 id="åŸºç¡€é•œåƒ"><a class="markdownIt-Anchor" href="#åŸºç¡€é•œåƒ"></a> åŸºç¡€é•œåƒ</h2><ul><li><p><a href="https://github.com/GoogleCloudPlatform/distroless" target="_blank" rel="noopener">distroless</a></p><blockquote><p>â€œDistrolessâ€ images contain only your application and its runtime dependencies. They do not contain package managers, shells or any other programs you would expect to find in a standard Linux distribution.</p></blockquote><p><code>distroless</code> æ˜¯ Google æ¨å‡ºçš„ä¸€ä¸ªä»…ä»…åŒ…å«è¿è¡Œæ—¶ç¯å¢ƒï¼Œä¸åŒ…å«åŒ…ç®¡ç†å™¨ï¼Œ<code>shell</code> ç­‰å…¶ä»–ç¨‹åºã€‚å¦‚æœä½ çš„ç¨‹åºæ²¡æœ‰å…¶ä»–ä¾èµ–çš„è¯ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©</p></li><li><p><a href="https://hub.docker.com/_/alpine" target="_blank" rel="noopener">alpine</a></p><blockquote><p>Alpine Linux is a security-oriented, lightweight Linux distribution based on musl libc and busybox.</p></blockquote><p><code>alpine</code> æ˜¯ä¸€ä¸ªåŸºäº <code>musl</code>ï¼Œ<code>busybox</code> çš„å®‰å…¨çš„ Linux å‘è¡Œç‰ˆã€‚éº»é›€è™½å°äº”è„ä¿±å…¨ï¼Œè™½ç„¶ä¸åˆ° 10M, ä½†æ˜¯åŒ…å«äº†ä¸€ä¸ªåŒ…ç®¡ç†å™¨å’Œ <code>shell</code> ç¯å¢ƒï¼Œè¿™åœ¨æˆ‘ä»¬å®é™…çš„ä½¿ç”¨è°ƒè¯•å½“ä¸­å°†éå¸¸æœ‰ç”¨ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼Œç”±äº <code>alpine</code> ä½¿ç”¨äº†æ›´å°çš„ <code>muslc</code> æ›¿ä»£ <code>glibc</code>ï¼Œä¼šå¯¼è‡´æŸäº›åº”ç”¨æ— æ³•ä½¿ç”¨ï¼Œéœ€è¦é‡æ–°ç¼–è¯‘</p></li><li><p><a href="https://hub.docker.com/_/scratch" target="_blank" rel="noopener">scratch</a><br><code>scratch</code> æ˜¯ç©ºç™½é•œåƒï¼Œä¸€èˆ¬ç”¨äºåŸºç¡€é•œåƒæ„å»ºï¼Œä¾‹å¦‚ <code>alpine</code> é•œåƒçš„ <code>Dockerfile</code> ä¾¿æ˜¯ä» <code>scratch</code> å¼€å§‹çš„</p>  <figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> scratch</span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> alpine-minirootfs-20190228-x86_64.tar.gz /</span></span><br><span class="line"><span class="bash">CMD [<span class="string">"/bin/sh"</span>]</span></span><br></pre></td></tr></table></figure></li><li><p><a href="https://hub.docker.com/_/busybox" target="_blank" rel="noopener">busybox</a></p></li></ul><p>ä¸€èˆ¬è€Œè¨€ï¼Œ<code>distroless</code> ç›¸å¯¹ä¼šæ›´åŠ çš„å®‰å…¨ï¼Œä½†æ˜¯åœ¨å®é™…ä½¿ç”¨çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°æ·»åŠ ä¾èµ–ä»¥åŠè°ƒè¯•æ–¹é¢çš„é—®é¢˜ï¼Œ<code>alpine</code> æ›´å°ï¼Œè‡ªå¸¦åŒ…ç®¡ç†å™¨ï¼Œæ›´åŠ è´´åˆä½¿ç”¨ä¹ æƒ¯ï¼Œä½†æ˜¯ <code>muslc</code> å¯èƒ½ä¼šå¸¦æ¥å…¼å®¹æ€§çš„é—®é¢˜ï¼Œä¸€èˆ¬è€Œè¨€æˆ‘ä¼šé€‰æ‹© <code>alpine</code> ä½œä¸ºåŸºç¡€é•œåƒä½¿ç”¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ <a href="https://hub.docker.com/" target="_blank" rel="noopener">Docker Hub</a> å½“ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°å¸¸ç”¨çš„ <code>debian</code> çš„é•œåƒä¹Ÿä¼šæä¾›çš„åªåŒ…å«åŸºç¡€åŠŸèƒ½çš„å°é•œåƒ</p><h2 id="åŸºç¡€é•œåƒå¯¹æ¯”"><a class="markdownIt-Anchor" href="#åŸºç¡€é•œåƒå¯¹æ¯”"></a> åŸºç¡€é•œåƒå¯¹æ¯”</h2><p>æ­¤å¤„ç›´æ¥æ‹‰å–åŸºç¡€é•œåƒï¼ŒæŸ¥çœ‹é•œåƒå¤§å°ï¼Œ é€šè¿‡è§‚å¯Ÿæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œ <code>alpine</code> åªæœ‰ 5M å·¦å³ä¸º <code>debian</code> çš„ 20 åˆ†ä¹‹ä¸€</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">alpine      latest    5cb3aa00f899        3 weeks ago         5.53MB</span><br><span class="line">debian      latest    0af60a5c6dd0        3 weeks ago         101MB</span><br><span class="line">ubuntu      18.04     47b19964fb50        7 weeks ago         88.1MB</span><br><span class="line">ubuntu      latest    47b19964fb50        7 weeks ago         88.1MB</span><br><span class="line">alpine      3.8       3f53bb00af94        3 months ago        4.41MB</span><br></pre></td></tr></table></figure><p>ä¼¼ä¹ä»ä¸Šé¢çœ‹ï¼Œæ„Ÿè§‰å·®è·ä¸å¤§ï¼Œå®è·µä¸­ï¼Œä¸åŒè¯­è¨€çš„åŸºç¡€é•œåƒéƒ½ä¼šæä¾›ä¸€äº›é‡‡ç”¨ä¸åŒåŸºç¡€é•œåƒåˆ¶ä½œçš„ <code>tag</code>ï¼Œä¸‹é¢æˆ‘ä»¬ä»¥ <code>ruby</code> çš„é•œåƒä¸ºä¾‹ï¼ŒæŸ¥çœ‹ä¸åŒåŸºç¡€é•œåƒçš„å·®å¼‚ã€‚å¯ä»¥çœ‹åˆ°é»˜è®¤çš„ <code>latest</code> é•œåƒ <code>881MB</code> è€Œ <code>alpine</code> ä»…ä»…åªæœ‰ä¸åˆ° <code>50MB</code> è¿™ä¸ªå·®è·å°±ååˆ†çš„å¯è§‚äº†</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">ruby   latest   a5d26127d8d0        4 weeks ago         881MB</span><br><span class="line">ruby   alpine   8d8f7d19d1fa        4 weeks ago         47.8MB</span><br><span class="line">ruby   slim     58dd4d3c99da        4 weeks ago         125MB</span><br></pre></td></tr></table></figure><h2 id="å‡å°‘å±‚å»é™¤éå¿…è¦çš„æ–‡ä»¶"><a class="markdownIt-Anchor" href="#å‡å°‘å±‚å»é™¤éå¿…è¦çš„æ–‡ä»¶"></a> å‡å°‘å±‚ï¼Œå»é™¤éå¿…è¦çš„æ–‡ä»¶</h2><ol><li><p>åˆ é™¤æ–‡ä»¶ä¸è¦è·¨è¡Œ</p> <figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># dockerfile 1</span></span><br><span class="line"><span class="keyword">FROM</span> alpine</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> wget https://github.com/mohuishou/scuplus-wechat/archive/1.0.0.zip</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># dockerfile 2</span></span></span><br><span class="line"><span class="bash">FROM alpine</span></span><br><span class="line"><span class="bash">RUN wget https://github.com/mohuishou/scuplus-wechat/archive/1.0.0.zip</span></span><br><span class="line"><span class="bash">RUN rm 1.0.0.zip</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># dockerfile 3</span></span></span><br><span class="line"><span class="bash">FROM alpine</span></span><br><span class="line"><span class="bash">RUN wget https://github.com/mohuishou/scuplus-wechat/archive/1.0.0.zip &amp;&amp; rm 1.0.0.zip</span></span><br></pre></td></tr></table></figure> <figure class="highlight console"><table><tr><td class="code"><pre><span class="line">test   3  351a80e99c22        5 seconds ago        5.53MB</span><br><span class="line">test   2  ad27e625b8e5        49 seconds ago       6.1MB</span><br><span class="line">test   1  165e2e0df1d3        About a minute ago   6.1MB</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç° 1ï¼Œ2 ä¸¤ä¸ªå¤§å°ä¸€æ ·ï¼Œä½†æ˜¯ 3 å°äº† 0.5MBï¼Œè¿™æ˜¯å› ä¸º <code>docker</code> å‡ ä¹æ¯ä¸€è¡Œå‘½ä»¤éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå±‚ï¼Œåˆ é™¤æ–‡ä»¶çš„æ—¶å€™ï¼šå› ä¸ºåº•ä¸‹å„å±‚éƒ½æ˜¯åªè¯»çš„ï¼Œå½“éœ€è¦åˆ é™¤è¿™äº›å±‚ä¸­çš„æ–‡ä»¶æ—¶ï¼Œ<code>AUFS</code> ä½¿ç”¨ <code>whiteout</code> æœºåˆ¶ï¼Œå®ƒçš„å®ç°æ˜¯é€šè¿‡åœ¨ä¸Šå±‚çš„å¯å†™çš„ç›®å½•ä¸‹å»ºç«‹å¯¹åº”çš„ <code>whiteout</code> éšè—æ–‡ä»¶æ¥å®ç°çš„ï¼Œæ‰€ä»¥åœ¨å½“å‰å±‚å»åˆ é™¤ä¸Šä¸€å±‚çš„æ–‡ä»¶ï¼Œåªæ˜¯ä¼šæŠŠè¿™ä¸ªæ–‡ä»¶éšè—æ‰ç½¢äº†</p></li><li><p>ä½¿ç”¨å•è¡Œå‘½ä»¤<br>é™¤äº†åˆ é™¤è¯­å¥éœ€è¦æ”¾åœ¨ä¸€è¡Œä»¥å¤–ï¼Œç”±äºå±‚çš„æœºåˆ¶ï¼Œæˆ‘ä»¬å®‰è£…ä¾èµ–çš„ä¸€äº›å…¬å…±çš„è¯­å¥æœ€å¥½ä¹Ÿä½¿ç”¨æ¡RUNå‘½ä»¤ç”Ÿæˆï¼Œå‡å°‘æœ€ç»ˆçš„å±‚æ•°</p></li><li><p>åˆ†ç¦»ä¾èµ–åŒ…ï¼Œä»¥åŠæºä»£ç ç¨‹åºï¼Œå……åˆ†åˆ©ç”¨å±‚çš„ç¼“å­˜<br>è¿™æ˜¯ä¸€ä¸ªæœ€ä½³å®è·µï¼Œåœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„ä¾èµ–åŒ…å¾€å¾€æ˜¯å˜åŠ¨ä¸å¤§çš„ï¼Œä½†æ˜¯æˆ‘ä»¬æ­£åœ¨å¼€å‘çš„æºç çš„å˜åŠ¨æ˜¯è¾ƒä¸ºé¢‘ç¹ï¼Œå¦‚æœæˆ‘ä»¬å®é™…çš„ä»£ç åªæœ‰ <code>10M</code>ï¼Œä½†æ˜¯ä¾èµ–é¡¹æœ‰ <code>1G</code>, å¦‚æœåœ¨ <code>COPY</code> çš„æ—¶å€™ç›´æ¥ <code>COPY ...</code> ä¼šå¯¼è‡´æ¯æ¬¡ä¿®æ”¹ä»£ç éƒ½ä¼šæ—¶è¿™ä¸€å±‚çš„ç¼“å­˜å¤±æ•ˆï¼Œå¯¼è‡´æµªè´¹å¤åˆ¶ä»¥åŠæ¨é€åˆ°é•œåƒä»“åº“çš„æ—¶é—´ï¼Œå°† <code>COPY</code> è¯­å¥åˆ†å¼€ï¼Œæ¯æ¬¡ <code>push</code> å°±å¯ä»¥åªå˜æ›´æˆ‘ä»¬é¢‘ç¹ä¿®æ”¹çš„ä»£ç å±‚ï¼Œè€Œä¸æ˜¯è¿ç€ä¾èµ–ä¸€èµ·</p></li><li><p>ä½¿ç”¨ <code>.dockerignore</code><br>åœ¨ä½¿ç”¨ <code>Git</code> æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>.gitignore</code> å¿½ç•¥æ–‡ä»¶ï¼Œåœ¨ <code>docker build</code> çš„æ—¶å€™ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>.dockerignore</code> åœ¨ Docker ä¸Šä¸‹æ–‡ä¸­å¿½ç•¥æ–‡ä»¶ï¼Œè¿™æ ·ä¸ä»…å¯ä»¥å‡å°‘ä¸€äº›éå¿…è¦æ–‡ä»¶çš„å¯¼å…¥ï¼Œä¹Ÿå¯ä»¥æé«˜å®‰å…¨æ€§ï¼Œé¿å…å°†ä¸€äº›é…ç½®æ–‡ä»¶æ‰“åŒ…åˆ°é•œåƒä¸­</p></li></ol><h2 id="å¤šé˜¶æ®µæ„å»º"><a class="markdownIt-Anchor" href="#å¤šé˜¶æ®µæ„å»º"></a> å¤šé˜¶æ®µæ„å»º</h2><p>å¤šé˜¶æ®µæ„å»ºå…¶å®ä¹Ÿæ˜¯å‡å°‘å±‚çš„ä¸€ç§ï¼Œé€šè¿‡å¤šé˜¶æ®µæ„å»ºï¼Œæœ€ç»ˆé•œåƒå¯ä»¥ä»…åŒ…å«æœ€åç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå’Œå¿…é¡»çš„è¿è¡Œæ—¶ä¾èµ–ï¼Œå¤§å¤§å‡å°‘é•œåƒä½“ç§¯</p><p>ä»¥ <code>GO</code> è¯­è¨€ä¸ºä¾‹ï¼Œå®é™…è¿è¡Œçš„è¿‡ç¨‹ä¸­åªéœ€è¦æœ€åç¼–è¯‘ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ï¼Œè€Œ <code>GO</code> è¯­è¨€æœ¬çœä»¥åŠæ‰©å±•åŒ…ï¼Œä»£ç æ–‡ä»¶éƒ½æ˜¯ä¸å¿…è¦çš„ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨ç¼–è¯‘çš„æ—¶å€™è¿™äº›ä¾èµ–åˆæ˜¯å¿…é¡»çš„ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºçš„æ–¹å¼ï¼Œå‡å°‘æœ€ç»ˆç”Ÿæˆçš„é•œåƒä½“ç§¯</p><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ golang é•œåƒä½œä¸º builder é•œåƒ</span></span><br><span class="line"><span class="keyword">FROM</span> golang:<span class="number">1.12</span> as builder</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /go/src/github.com/go/helloworld/</span></span><br><span class="line"><span class="bash">COPY app.go .</span></span><br><span class="line"><span class="bash">RUN go build -o app .</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># ç¼–è¯‘å®Œæˆä¹‹åä½¿ç”¨ alpine é•œåƒä½œä¸ºæœ€ç»ˆçš„åŸºç¡€é•œåƒ</span></span></span><br><span class="line"><span class="bash">FROM alpine:latest as prod</span></span><br><span class="line"><span class="bash">RUN apk --no-cache add ca-certificates</span></span><br><span class="line"><span class="bash">WORKDIR /root/</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># ä» builder ä¸­å¤åˆ¶ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶</span></span></span><br><span class="line"><span class="bash">COPY --from=builder /go/src/github.com/go/helloworld/app .</span></span><br><span class="line"><span class="bash">CMD [<span class="string">"./app"</span>]</span></span><br></pre></td></tr></table></figure><p>ç”±äºæœ¬æ–‡ç¯‡å¹…è¾ƒé•¿ï¼Œè¿™é‡Œä¸å¯¹å¤šé˜¶æ®µæ„å»ºå±•å¼€è®²è§£ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒï¼š<a href="https://yeasy.gitbooks.io/docker_practice/image/multistage-builds/#%E5%A4%9A%E9%98%B6%E6%AE%B5%E6%9E%84%E5%BB%BA" target="_blank" rel="noopener">å¤šé˜¶æ®µæ„å»º</a></p><h2 id="å¥‡æ·«æŠ€å·§"><a class="markdownIt-Anchor" href="#å¥‡æ·«æŠ€å·§"></a> å¥‡æ·«æŠ€å·§</h2><ol><li><p>ä½¿ç”¨ <a href="https://github.com/wagoodman/dive" target="_blank" rel="noopener"><code>dive</code></a> æŸ¥çœ‹ Docker é•œåƒçš„å±‚ï¼Œå¯ä»¥å¸®åŠ©ä½ åˆ†æå‡å°‘é•œåƒä½“ç§¯</p></li><li><p>ä½¿ç”¨ <a href="https://github.com/docker-slim/docker-slim" target="_blank" rel="noopener"><code>docker-slim</code></a> å¯ä»¥è‡ªåŠ¨å¸®åŠ©ä½ å‡å°‘é•œåƒä½“ç§¯ï¼Œå¯¹äº Web åº”ç”¨è¾ƒä¸ºæœ‰ç”¨</p></li><li><p>å®‰è£…è½¯ä»¶æ—¶å»é™¤ä¾èµ–</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ubuntu</span></span><br><span class="line">apt-get install -y â€”â€Šno-install-recommends</span><br><span class="line"></span><br><span class="line"><span class="comment"># alpine</span></span><br><span class="line">apk add --no-cache &amp;&amp;  apk del build-dependencies</span><br><span class="line"></span><br><span class="line"><span class="comment"># centos</span></span><br><span class="line">yum install -y ... &amp;&amp; yum clean all</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ <code>--flatten</code> å‚æ•°ï¼Œå‡å°‘å±‚ï¼ˆä¸æ¨èï¼‰</p></li><li><p>ä½¿ç”¨ <code>docker-squash</code> å‹ç¼©å±‚</p></li></ol><h2 id="ä¸åŒè¯­è¨€çš„ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#ä¸åŒè¯­è¨€çš„ç¤ºä¾‹"></a> ä¸åŒè¯­è¨€çš„ç¤ºä¾‹</h2><h3 id="rubyrails"><a class="markdownIt-Anchor" href="#rubyrails"></a> Ruby(Rails)</h3><ol><li><p>åªå®‰è£…ç”Ÿäº§æ‰€éœ€çš„ä¾èµ–</p></li><li><p>åˆ é™¤ä¸éœ€è¦çš„ä¾èµ–æ–‡ä»¶</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bundle install --without development:<span class="built_in">test</span>:assets -j4 --retry 3 --path=vendor/bundle \</span><br><span class="line">    <span class="comment"># Remove unneeded files (cached *.gem, *.o, *.c)</span></span><br><span class="line">    &amp;&amp; rm -rf vendor/bundle/ruby/2.5.0/cache/*.gem \</span><br><span class="line">    &amp;&amp; find vendor/bundle/ruby/2.5.0/gems/ -name <span class="string">"*.c"</span> -delete \</span><br><span class="line">    &amp;&amp; find vendor/bundle/ruby/2.5.0/gems/ -name <span class="string">"*.o"</span> -delete</span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤å‰ç«¯çš„ <code>node_modules</code> ä»¥åŠç¼“å­˜æ–‡ä»¶</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -rf node_modules tmp/cache app/assets vendor/assets spec</span><br></pre></td></tr></table></figure></li></ol><p>ä¸Šè¿°å†…å®¹å¯ä»¥ç»“åˆå¤šé˜¶æ®µæ„å»ºå®ç°</p><h3 id="golang"><a class="markdownIt-Anchor" href="#golang"></a> Golang</h3><p><code>Golang</code> åœ¨ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºä¹‹åï¼Œåªå‰©ä¸‹äº†ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¿™æ—¶å€™å†è¦ä¼˜åŒ–ï¼Œå°±åªæœ‰ä½¿ç”¨ <code>upx</code> ä¹‹ç±»çš„å·¥å…·å‹ç¼©äºŒè¿›åˆ¶æ–‡ä»¶çš„ä½“ç§¯äº†</p><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><a href="http://dockone.io/article/8174" target="_blank" rel="noopener">Docker å®¹å™¨é•œåƒç˜¦èº«çš„ä¸‰ä¸ªå°çªé—¨</a></li><li><a href="https://liulantao.com/docker-base-images.html" target="_blank" rel="noopener">åŸºç¡€é•œåƒ | å†è°ˆ Docker ç˜¦èº«</a></li><li><a href="https://liulantao.com/docker-best-practices-mindmap.html" target="_blank" rel="noopener">ã€ŠDocker æœ€ä½³å®è·µã€‹å¯¼å›¾</a></li><li><a href="https://legacy.gitbook.com/book/yeasy/docker_practice/details" target="_blank" rel="noopener">Docker â€”â€” ä»å…¥é—¨åˆ°å®è·µ</a></li><li><a href="https://jingwei.link/2018/07/18/docker-namespace-cgroups-aufs.html#aufs" target="_blank" rel="noopener">Docker åŸºæœ¬åŸç†ç®€æ</a></li><li><a href="https://medium.com/@lemuelbarango/ruby-on-rails-smaller-docker-images-bff240931332" target="_blank" rel="noopener">Ruby on Railsâ€Šâ€”â€ŠSmaller docker images</a></li></ul><hr><blockquote><p>æœ¬æ–‡ä½œè€…ï¼šmohuishou <br>åŸæ–‡é“¾æ¥ï¼š<a href="https://lailin.xyz/post/51252.html" target="_blank" rel="noopener">https://lailin.xyz/post/51252.html</a> <br>ç‰ˆæƒå£°æ˜ï¼šç‰ˆæƒå½’ä½œè€…æ‰€æœ‰ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆåœ¨å­˜å‚¨å¦‚æ­¤ä¾¿å®œçš„ä»Šå¤©æˆ‘ä»¬ä»ç„¶éœ€è¦å¯¹ Docker é•œåƒè¿›è¡Œç˜¦èº«ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å°é•œåƒçš„ä¼˜ç‚¹&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#å°é•œåƒçš„ä¼˜ç‚¹&quot;&gt;&lt;/a&gt; å°é•œåƒçš„ä¼˜
      
    
    </summary>
    
      <category term="å®¹å™¨æŠ€æœ¯" scheme="https://y0ngb1n.github.io/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="å®¹å™¨æŠ€æœ¯" scheme="https://y0ngb1n.github.io/tags/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/"/>
    
      <category term="docker" scheme="https://y0ngb1n.github.io/tags/docker/"/>
    
      <category term="è½¬è½½" scheme="https://y0ngb1n.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>Hexo æ­å»ºä¸ªäººåšå®¢ #05 åˆ©ç”¨ Travis CI å¸®ä½ è‡ªåŠ¨éƒ¨ç½²</title>
    <link href="https://y0ngb1n.github.io/a/5c7519f9.html"/>
    <id>https://y0ngb1n.github.io/a/5c7519f9.html</id>
    <published>2019-01-18T11:43:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯-travis-ci"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯-travis-ci"></a> ä»€ä¹ˆæ˜¯ Travis CIï¼Ÿ</h2><blockquote><p><a href="https://travis-ci.org/" target="_blank" rel="noopener">Travis CI</a> æ˜¯åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸä¸­çš„ä¸€ä¸ªåœ¨çº¿çš„ï¼Œåˆ†å¸ƒå¼çš„æŒç»­é›†æˆæœåŠ¡ï¼Œç”¨æ¥æ„å»ºåŠæµ‹è¯•åœ¨ GitHub æ‰˜ç®¡çš„ä»£ç ã€‚è¿™ä¸ªè½¯ä»¶çš„ä»£ç åŒæ—¶ä¹Ÿæ˜¯<a href="https://github.com/travis-ci/travis-ci" target="_blank" rel="noopener">å¼€æº</a>çš„ï¼Œå¯ä»¥<a href="https://github.com/travis-ci/travis-ci" target="_blank" rel="noopener">åœ¨ GitHub ä¸Šä¸‹è½½åˆ°</a>ï¼Œå°½ç®¡å¼€å‘è€…å½“å‰å¹¶ä¸æ¨èåœ¨é—­æºé¡¹ç›®ä¸­å•ç‹¬ä½¿ç”¨å®ƒã€‚</p><p>å®ƒæä¾›äº†å¤šç§ç¼–ç¨‹è¯­è¨€çš„æ”¯æŒï¼ŒåŒ…æ‹¬ Rubyã€JavaScriptã€Javaã€Scalaã€PHPã€Haskell å’Œ Erlang åœ¨å†…çš„å¤šç§è¯­è¨€ã€‚è®¸å¤šçŸ¥åçš„å¼€æºé¡¹ç›®ä½¿ç”¨å®ƒæ¥åœ¨æ¯æ¬¡æäº¤çš„æ—¶å€™è¿›è¡Œæ„å»ºæµ‹è¯•ï¼Œæ¯”å¦‚ Ruby on Railsï¼ŒRuby å’Œ Node.jsã€‚</p></blockquote><p>ç›®å‰ Travis CI ä¸¤ä¸ªç«™ç‚¹ï¼Œæä¾›ä¸åŒçš„æœåŠ¡ï¼š</p><table><thead><tr><th>ç‰ˆæœ¬</th><th>ä¸»é¡µ</th><th>ç‰¹è‰²</th></tr></thead><tbody><tr><td>å…è´¹ç‰ˆ</td><td><a href="https://travis-ci.org/" target="_blank" rel="noopener">https://travis-ci.org/</a></td><td>ä¸ºå¼€æºé¡¹ç›®æä¾›å…è´¹æœåŠ¡</td></tr><tr><td>æ”¶è´¹ç‰ˆ</td><td><a href="https://travis-ci.com/" target="_blank" rel="noopener">https://travis-ci.com/</a></td><td>å¯ä»¥éƒ¨ç½² GitHub ç§æœ‰ä»“åº“</td></tr></tbody></table><p>ä¸¤ä¸ªç«™ç‚¹åªèƒ½çœ‹åˆ°å„è‡ªçš„é¡¹ç›®ï¼Œä¸èƒ½é€šç”¨ï¼ŒæŒ‰éœ€é€‰ç”¨ã€‚</p><h2 id="å‡†å¤‡å·¥ä½œ"><a class="markdownIt-Anchor" href="#å‡†å¤‡å·¥ä½œ"></a> å‡†å¤‡å·¥ä½œ</h2><p>é¦–å…ˆï¼Œè®¿é—®å®˜æ–¹ç½‘ç«™Â <a href="https://travis-ci.org/" target="_blank" rel="noopener">travis-ci.org</a>ï¼Œç‚¹å‡»å³ä¸Šè§’çš„ç™»å…¥æŒ‰é’®ï¼Œä½¿ç”¨ GitHub è´¦æˆ·ç™»å…¥ Travis CIã€‚</p><p>Travis ä¼šåˆ—å‡º GitHub ä¸Šé¢ä½ çš„æ‰€æœ‰ä»“åº“ï¼Œä»¥åŠä½ æ‰€å±äºçš„ç»„ç»‡ã€‚æ­¤æ—¶ï¼Œé€‰æ‹©ä½ éœ€è¦ Travis å¸®ä½ æ„å»ºçš„ä»“åº“ï¼Œæ‰“å¼€ä»“åº“æ—è¾¹çš„å¼€å…³ã€‚ä¸€æ—¦æ¿€æ´»äº†ä¸€ä¸ªä»“åº“ï¼ŒTravis ä¼šç›‘å¬è¿™ä¸ªä»“åº“çš„æ‰€æœ‰å˜åŒ–ã€‚</p><p align="center">  <img src="https://i.loli.net/2019/01/17/5c4036203a833.png" alt="travis github repo"></p><h2 id="travisyml"><a class="markdownIt-Anchor" href="#travisyml"></a> .travis.yml</h2><p>Travis è¦æ±‚é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹é¢ï¼Œå¿…é¡»æœ‰ä¸€ä¸ª <code>.travis.yml</code> æ–‡ä»¶ã€‚è¿™æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šäº† Travis çš„è¡Œä¸ºã€‚è¯¥æ–‡ä»¶å¿…é¡»ä¿å­˜åœ¨ GitHub ä»“åº“é‡Œé¢ï¼Œä¸€æ—¦ä»£ç ä»“åº“æœ‰æ–°çš„ Commitï¼ŒTravis å°±ä¼šå»æ‰¾è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰§è¡Œé‡Œé¢çš„å‘½ä»¤ã€‚</p><p><code>.travis.yml</code>ï¼š</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">node_js</span>             <span class="comment"># æŒ‡å®šè¯­è¨€ç¯å¢ƒ</span></span><br><span class="line"><span class="attr">node_js:</span> <span class="string">'8.9.3'</span>              <span class="comment"># æŒ‡å®š NodeJS ç‰ˆæœ¬</span></span><br><span class="line"><span class="attr">cache:</span> <span class="string">npm</span>                    <span class="comment"># æŒ‡å®š npm ç¼“å­˜æ–¹æ¡ˆï¼Œä¼šç¼“å­˜ $HOME/.npm æˆ– node_modules æ–‡ä»¶å¤¹</span></span><br><span class="line"></span><br><span class="line"><span class="attr">dist:</span> <span class="string">trusty</span>                  <span class="comment"># æŒ‡å®šç³»ç»Ÿç‰ˆæœ¬ï¼Œtrusty æ˜¯æŒ‡ Ubuntu 14.04 å‘è¡Œç‰ˆçš„åç§°</span></span><br><span class="line"><span class="attr">sudo:</span> <span class="string">required</span>                <span class="comment"># æ˜¯å¦éœ€è¦ sudo æƒé™</span></span><br><span class="line"></span><br><span class="line"><span class="attr">branches:</span>                     <span class="comment"># æŒ‡å®šè¦æ„å»ºçš„åˆ†æ”¯</span></span><br><span class="line"><span class="attr">  only:</span>                       <span class="comment"># only è¡¨ç¤ºåªæ„å»ºä»¥ä¸‹åˆ†æ”¯</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">source</span></span><br><span class="line"></span><br><span class="line"><span class="attr">before_install:</span>               <span class="comment"># install é˜¶æ®µä¹‹å‰æ‰§è¡Œ</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span> <span class="bullet">-g</span> <span class="string">hexo-cli</span>   <span class="comment"># å…¨å±€å®‰è£… Hexo å‘½ä»¤è¡Œå·¥å…·</span></span><br><span class="line"></span><br><span class="line"><span class="attr">install:</span>                      <span class="comment"># åœ¨å®‰è£…é¡¹ç›®ç¯å¢ƒé˜¶æ®µéœ€è¦è¿è¡Œçš„å‘½ä»¤ï¼Œä¸€æ¡ä¸€è¡Œï¼Œç±»ä¼¼çš„è¿˜æœ‰ before_install</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span>               <span class="comment"># å®‰è£… package.json ä¸­çš„ä¾èµ–</span></span><br><span class="line"></span><br><span class="line"><span class="attr">script:</span>                       <span class="comment"># åœ¨æ„å»ºé˜¶æ®µéœ€è¦è¿è¡Œçš„å‘½ä»¤ï¼Œä¸€æ¡ä¸€è¡Œï¼Œç±»ä¼¼çš„è¿˜æœ‰ before_scriptã€after_script</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">hexo</span> <span class="string">clean</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">hexo</span> <span class="string">generate</span>             <span class="comment"># Hexo å¸¸è§„å‘½ä»¤ï¼Œæ‰§è¡Œæ¸…ç†å’Œç”Ÿæˆ</span></span><br><span class="line"></span><br><span class="line"><span class="attr">after_success:</span>                <span class="comment"># script é˜¶æ®µæˆåŠŸæ—¶æ‰§è¡Œï¼Œæ„å»ºå¤±è´¥ä¸ä¼šæ‰§è¡Œï¼Œå…¶ä»–åŒä¸Š</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--local</span> <span class="string">user.name</span> <span class="string">"travis-ci"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--local</span> <span class="string">user.email</span> <span class="string">"deploy@travis-ci.org"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">sed</span> <span class="bullet">-i''</span> <span class="string">"s~git@github.com:~https://$&#123;GITHUB_REPO_TOKEN&#125;@github.com/~"</span> <span class="string">_config.yml</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">hexo</span> <span class="string">deploy</span> <span class="string">&gt; /dev/null   # é€šè¿‡ Hexo çš„ deploy å‘½ä»¤éƒ¨ç½²åšå®¢</span></span><br></pre></td></tr></table></figure><p>æ›´å¤šä½¿ç”¨æŠ€å·§è¯·ä¸»åŠ¨å‚è€ƒã€Œ<a href="http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html" target="_blank" rel="noopener">æŒç»­é›†æˆæœåŠ¡ Travis CI æ•™ç¨‹</a>ã€ã€‚</p><p>é‚£ä¹ˆï¼Œç°åœ¨åˆæœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼šæˆ‘ä»¬çš„ç›®æ˜¯è‡ªåŠ¨éƒ¨ç½²åˆ° GitHub Pagesï¼Œç”¨çš„æ˜¯ <code>hexo deploy</code> å‘½ä»¤ï¼Œä½†æ˜¯ Hexo åˆé…ç½®ä½¿ç”¨çš„æ˜¯ Git push æ¥æ¨é€çš„ï¼ˆç”± <code>hexo-deployer-git</code> æ’ä»¶æä¾›æŠ€æœ¯æ”¯æŒï¼‰ï¼Œé‚£ä¹ˆ Travis CI æ€ä¹ˆæœ‰æƒé™æ“ä½œæˆ‘çš„ GitHub ä»“åº“å‘¢ï¼</p><h3 id="github-access-token"><a class="markdownIt-Anchor" href="#github-access-token"></a> GitHub Access Token</h3><blockquote><p>ä»¥ä¸‹å†…å®¹æ‘˜æŠ„ã€Œ<a href="https://blog.zthxxx.me/posts/Build-Hexo-Blog-by-Travis-CI/" target="_blank" rel="noopener">ä½¿ç”¨ Travis è‡ªåŠ¨æ„å»º Hexo åˆ° GitHub</a>ã€</p></blockquote><p>GitHub å…è®¸ä½ é€šè¿‡<a href="https://github.com/settings/tokens" target="_blank" rel="noopener">è®¾ç½®é¡µé¢</a>æ·»åŠ ä¸€ä¸ªã€Œ<strong>ä¸ªäººè®¿é—®ä»¤ç‰Œï¼ˆPersonal access tokensï¼‰</strong>ã€ï¼Œä½¿ç”¨ Assess Token å°†æœ‰æƒé™é€šè¿‡ <code>https</code> è®¿é—® GitHub Api æ“ä½œè‡ªå·±çš„ä»“åº“ï¼Œå¯è§è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥æ·»åŠ ä¸€ä¸ª tokenï¼Œå…ˆè¿›å…¥è‡ªå·± GitHub çš„<a href="https://github.com/settings/tokens" target="_blank" rel="noopener">è®¾ç½®é¡µé¢</a>ï¼Œç‚¹å‡» <code>Personal access tokens</code> â†’ <code>Generate new token</code> æŒ‰é’®ï¼Œæ–°å»ºä¸€ä¸ª tokenã€‚</p><p><img src="https://i.loli.net/2019/01/18/5c40b37a1e67c.png" alt="Generate new token"></p><p>åœ¨æƒé™è®¾ç½®ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ“ä½œä»“åº“ï¼Œå› æ­¤åªéœ€è¦æ‰“å¼€ä»“åº“ç›¸å…³çš„æƒé™å°±å¤Ÿäº†ï¼Œæƒé™å¼€æ”¾åº”è¯¥æ»¡è¶³æœ€å°åŸåˆ™ï¼Œèƒ½å°‘å°±å°‘ã€‚è®¾ç½®å¥½æƒé™åç‚¹å‡»ç”ŸæˆæŒ‰é’®å°±ä¼šç”Ÿæˆå®Œæ¯•å¹¶è·³åˆ° tokens åˆ—è¡¨ã€‚</p><p><img src="https://i.loli.net/2019/01/18/5c40b999b24d4.png" alt="Personal access tokens"></p><p>ç°åœ¨å°±éœ€è¦æŠŠåˆšç”Ÿæˆçš„ Access Token çš„å€¼å¤åˆ¶ä¸‹æ¥ï¼Œ<strong>æ³¨æ„ï¼Œè¿™ä¸ªé¡µé¢ä¸€æ—¦åˆ·æ–°è¿‡äº†ï¼Œ token å°±ä¸èƒ½å†æ˜¾ç¤ºäº†ï¼Œæ²¡è®°ä½çš„åªèƒ½é‡æ–°ç”Ÿæˆä¸€ä¸ªäº†</strong>ã€‚</p><p><img src="https://i.loli.net/2019/01/18/5c40b95a99b08.png" alt="Copy personal access tokens"></p><p>å—¯ï¼Œç°åœ¨ Access Token ä¹Ÿæœ‰äº†ï¼Œèƒ½æ“ä½œä»“åº“äº†ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ª token åº”è¯¥æ”¾åˆ°å“ªé‡Œå‘¢ï¼Ÿ</p><p>è‚¯å®šä¸æ˜¯æ”¾åˆ°ä»£ç é‡Œã€‚ã€‚ã€‚</p><p>å…¶å®åœ¨ Travis CI çš„é¡¹ç›®è®¾ç½®ç•Œé¢å°±æœ‰æä¾›è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å°±åº”è¯¥æŠŠ token æ”¾åˆ°é‚£é‡Œã€‚</p><p>å›åˆ°æˆ‘ä»¬ Travis CI çš„<a href="https://travis-ci.org/y0ngb1n/y0ngb1n.github.io/settings" target="_blank" rel="noopener">åšå®¢é¡¹ç›®è®¾ç½®é¡µé¢</a>ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªåä¸º <code>GITHUB_REPO_TOKEN</code> çš„ç¯å¢ƒå˜é‡å‚¨å­˜æˆ‘ä»¬çš„ tokenï¼Œå¹¶è®°å¾—è¦è®¾ç½® <code>Display value in build log</code> ä¸º <code>OFF</code>ï¼Œå…³é—­å˜é‡çš„æ˜¾ç¤ºï¼Œå¦åˆ™ç­‰äºå…¬å¼€äº† tokenã€‚</p><p><img src="https://i.loli.net/2019/01/18/5c40baab10d82.png" alt="æ·»åŠ  Token ç¯å¢ƒå˜é‡"></p><p>ç°åœ¨åœ¨æˆ‘ä»¬çš„æ‰§è¡Œè„šæœ¬ä¸­å°±èƒ½ä½¿ç”¨ <code>$GITHUB_REPO_TOKEN</code> è®¿é—® token çš„ç¯å¢ƒå˜é‡äº†~</p><p>ç„¶åå°±æ˜¯å¦‚ä½•ä½¿ç”¨äº†ã€‚åœ¨ Hexo éƒ¨ç½²å‰ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠåŸæ¥çš„éƒ¨ç½²ä»“åº“åœ°å€ç”¨å¸¦æœ‰ <code>Access Token</code> çš„åœ°å€æ›¿æ¢æ‰ï¼Œäºæ˜¯åœ¨ <code>.travis.yml</code> çš„ <code>hexo deploy</code> å‘½ä»¤å‰å¢åŠ ä¸€æ¡å‘½ä»¤ï¼š</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="string">sed</span> <span class="bullet">-i''</span> <span class="string">"s~git@github.com:~https://$&#123;GITHUB_REPO_TOKEN&#125;@github.com/~"</span> <span class="string">_config.yml</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œåœ¨æ‰§è¡Œæ—¶ï¼Œè¿™æ¡å‘½ä»¤å°±èƒ½è‡ªåŠ¨æ›¿æ¢åˆ°æœ‰æƒé™æ“ä½œçš„ token åœ°å€äº†ï¼Œå¹¶ä¸”ä¹Ÿä¸ä¼šæ³„éœ²æˆ–è€…å½±å“æœ¬åœ°çš„åŸå§‹é…ç½®æ–‡ä»¶ã€‚</p><h3 id="æ„å»ºå¤±è´¥å­æ¨¡å—æ‹‰å–å¤±è´¥"><a class="markdownIt-Anchor" href="#æ„å»ºå¤±è´¥å­æ¨¡å—æ‹‰å–å¤±è´¥"></a> æ„å»ºå¤±è´¥ï¼šå­æ¨¡å—æ‹‰å–å¤±è´¥</h3><blockquote><p>æœ¬åšå®¢çš„ç¬¬ä¸‰æ–¹ä¸»é¢˜ä½¿ç”¨ <code>git submodule</code> ç®¡ç†ï¼Œå¯ä»¥ç¿»çœ‹ã€Œ<a href="https://y0ngb1n.github.io/a/2270d168.html">Hexo æ­å»ºä¸ªäººåšå®¢ #04 ä¸»é¢˜çš„å®‰è£…ä¸è‡ªå®šä¹‰æ ·å¼</a>ã€</p></blockquote><p><img src="https://i.loli.net/2019/01/18/5c413aeb9dc2a.png" alt="Build History"></p><p>è¯¦ç»†çš„æ„å»ºæ—¥å¿—å¯è§ <a href="https://travis-ci.org/y0ngb1n/y0ngb1n.github.io/builds/481166397" target="_blank" rel="noopener">#1</a>ï¼Œä¸‹é¢æå–å…³é”®ä¿¡æ¯ï¼š</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git submodule update --init --recursive</span></span><br><span class="line">Submodule 'themes/skapp' (git@github.com:Mrminfive/hexo-theme-skapp.git) registered for path 'themes/skapp'</span><br><span class="line">Cloning into '/home/travis/build/y0ngb1n/y0ngb1n.github.io/themes/skapp'...</span><br><span class="line">Warning: Permanently added the RSA host key for IP address '192.30.253.113' to the list of known hosts.</span><br><span class="line">Permission denied (publickey).</span><br><span class="line">fatal: Could not read from remote repository.</span><br></pre></td></tr></table></figure><p><a href="https://docs.travis-ci.com/user/customizing-the-build/#git-submodules" target="_blank" rel="noopener">Travis CI å®˜æ–¹æ˜¯é»˜è®¤æ”¯æŒ Git Submodules</a>ï¼Œåœ¨æ‹‰å–ä»“åº“æ—¶ä¼šé»˜è®¤æ‹‰å–å­æ¨¡å—çš„ä»“åº“ï¼Œå¯ä»¥æ‰‹åŠ¨å…³é—­è¯¥ç‰¹æ€§ã€‚</p><p>ç”±äºåœ¨ä½¿ç”¨ <code>git submodule</code> æ—¶ï¼Œæ·»åŠ äº† <code>git@github.com</code> çš„ä»“åº“åœ°å€ï¼Œä½¿ç”¨ <code>SSH</code> çš„åè®®ï¼Œæ‰€ä»¥æ‹‰å–å¤±è´¥äº†ï¼Œä¸‹é¢æä¾›ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆï¼š</p><ol><li><a href="https://docs.travis-ci.com/user/ssh-known-hosts/" target="_blank" rel="noopener">Adding to SSH Known Hosts</a> - å®˜æ–¹æä¾›çš„è§£å†³æ–¹æ¡ˆ</li><li>æ‰‹åŠ¨ä¿®æ”¹ <code>.gitmodules</code> é‡Œé…ç½®çš„ä»“åº“åœ°å€ï¼Œå°†ä½¿ç”¨ <code>git</code> åè®®çš„ä»“åº“é“¾æ¥æ”¹ä¸º <code>https</code> åè®®</li></ol><p>æˆ‘è¿™ä½¿ç”¨æ–¹æ¡ˆ 2ï¼Œä¿®æ”¹ä¸º<code>https</code> åè®®ï¼š</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="section">[submodule "themes/skapp"]</span></span><br><span class="line">    path = themes/skapp</span><br><span class="line">    url = https://github.com/Mrminfive/hexo-theme-skapp.git</span><br></pre></td></tr></table></figure><p>å°†ä¿®æ”¹æ¨é€è‡³ GitHub åï¼ŒTravis CI ä¼šè¿›è¡Œæ„å»ºï¼Œæ­¤æ—¶å¯è§ <a href="https://travis-ci.org/y0ngb1n/y0ngb1n.github.io/builds/481168732" target="_blank" rel="noopener">#2</a> æˆåŠŸæ„å»ºäº†ã€‚</p><h2 id="åœ¨-readme-ä¸­æŸ¥çœ‹æ„å»ºçŠ¶æ€"><a class="markdownIt-Anchor" href="#åœ¨-readme-ä¸­æŸ¥çœ‹æ„å»ºçŠ¶æ€"></a> åœ¨ README ä¸­æŸ¥çœ‹æ„å»ºçŠ¶æ€</h2><p>æˆ‘ä»¬å¯ä»¥åœ¨ <code>README</code> ä¸­æ·»åŠ  Travis CI çš„æ„å»ºçŠ¶æ€ï¼Œè¿™æ ·ä¾¿å¯æ–¹ä¾¿åœ°æŸ¥çœ‹é¡¹ç›®åœ¨ Travis CI ä¸Šçš„æ„å»ºçŠ¶æ€ã€‚â€”â€” <a href="https://docs.travis-ci.com/user/status-images/" target="_blank" rel="noopener">Embedding Status Images</a>ã€<a href="https://shields.io/#/examples/build" target="_blank" rel="noopener">Shields.io</a></p><p><img src="https://i.loli.net/2019/01/18/5c4144df97e18.png" alt="README"></p><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://docs.travis-ci.com/" target="_blank" rel="noopener">Travis CI Tutorial</a> - @Travis CI Docs</li><li><a href="http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html" target="_blank" rel="noopener">æŒç»­é›†æˆæœåŠ¡ Travis CI æ•™ç¨‹</a> - @é˜®ä¸€å³°</li><li><a href="http://lujiahao.tk/2018/06/27/Travis%20CI%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/" target="_blank" rel="noopener">Travis CI æŒç»­é›†æˆ GitHub ä¸ªäººåšå®¢</a> - @è·¯å®¶è±ª</li><li><a href="https://blog.zthxxx.me/posts/Build-Hexo-Blog-by-Travis-CI/" target="_blank" rel="noopener">ä½¿ç”¨ Travis è‡ªåŠ¨æ„å»º Hexo åˆ° GitHub</a> - @zthxxx</li><li><a href="http://wuyuying.com/blog/archives/hexo-travis/" target="_blank" rel="noopener">å¼€ç®±å³ç”¨ï¼ŒHexo åšå®¢çš„ github+server è‡ªåŠ¨éƒ¨ç½²</a> - @ä¼é…±</li><li><a href="https://www.karlzhou.com/2016/05/28/travis-ci-deploy-blog/" target="_blank" rel="noopener">ç”¨ Travis CI è‡ªåŠ¨éƒ¨ç½² Hexo åšå®¢</a> - @Karl</li><li><a href="https://www.wshunli.com/posts/7dcaaf9e.html" target="_blank" rel="noopener">ä½¿ç”¨ Travis CI è‡ªåŠ¨éƒ¨ç½² Hexo åšå®¢</a> - @wshunli</li><li><a href="https://juejin.im/post/5a1fa30c6fb9a045263b5d2a" target="_blank" rel="noopener">Hexo é‡ä¸Š Travis-CIï¼šå¯èƒ½æ˜¯æœ€é€šä¿—æ˜“æ‡‚çš„è‡ªåŠ¨å‘å¸ƒåšå®¢å›¾æ–‡æ•™ç¨‹</a> - @MichaelX</li><li><a href="https://baiyangliu.github.io/Hexo+Github+Travis-ci%E6%90%AD%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%91%98%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2.html" target="_blank" rel="noopener">Hexo+Github+Travis-ci æ­å»ºç¨‹åºå‘˜è‡ªå·±çš„åšå®¢</a> - @baiyangliu</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-travis-ci&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ä»€ä¹ˆæ˜¯-travis-ci&quot;&gt;&lt;/a&gt; ä»€ä¹ˆæ˜¯ Travis CIï¼Ÿ&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://travis-c
      
    
    </summary>
    
      <category term="Hexo æ­å»ºä¸ªäººåšå®¢" scheme="https://y0ngb1n.github.io/categories/Hexo-%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://y0ngb1n.github.io/tags/hexo/"/>
    
      <category term="ä¸ªäººåšå®¢" scheme="https://y0ngb1n.github.io/tags/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
      <category term="travis-ci" scheme="https://y0ngb1n.github.io/tags/travis-ci/"/>
    
  </entry>
  
  <entry>
    <title>Hexo æ­å»ºä¸ªäººåšå®¢ #04 ä¸»é¢˜çš„å®‰è£…ä¸è‡ªå®šä¹‰æ ·å¼</title>
    <link href="https://y0ngb1n.github.io/a/2270d168.html"/>
    <id>https://y0ngb1n.github.io/a/2270d168.html</id>
    <published>2018-12-19T22:00:00.000Z</published>
    <updated>2019-01-13T16:57:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="hexo-åšå®¢ä¸»é¢˜"><a class="markdownIt-Anchor" href="#hexo-åšå®¢ä¸»é¢˜"></a> Hexo åšå®¢ä¸»é¢˜</h2><p>Hexo é»˜è®¤çš„ä¸»é¢˜ç®€é™‹ï¼Ÿä¸å¤ªå¥½çœ‹ï¼Ÿå°±æ˜¯ä¸å–œæ¬¢ï¼Ÿ</p><p>å…¶å®æƒ³è¦æ›´æ¢ Hexo çš„ä¸»é¢˜æ˜¯å¾ˆç®€å•çš„ï¼ŒHexo æä¾›äº†å¯æ’æ‹”å¼çš„ä¸»é¢˜æœºåˆ¶ï¼Œè®©æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°æ›´æ¢åšå®¢ä¸»é¢˜ã€‚</p><p>å¯ä»¥åœ¨ã€Œ<a href="https://hexo.io/themes/" target="_blank" rel="noopener">å®˜æ–¹æ”¶é›†çš„ä¸»é¢˜åˆ—è¡¨</a>ã€æŒ‘é€‰ä»»æ„ä¸€ä¸ªä½ å–œæ¬¢çš„ä¸»é¢˜ï¼Œæ€»æœ‰ä¸€ä¸ªé€‚åˆä½ ã€‚</p><p>ã€Œ<a href="https://github.com/Mrminfive/hexo-theme-skapp" target="_blank" rel="noopener">skapp</a>ã€è¿™ä¸ªä¸»é¢˜æŒºä¸é”™çš„ï¼Œæ¥ä¸‹æ¥å°±å‚ç…§è¿™ä¸ªä¸»é¢˜çš„å®˜ç½‘çš„æ•™ç¨‹è¿›è¡Œå®‰è£…ä½¿ç”¨ã€‚</p><h2 id="ä¸»é¢˜çš„å®‰è£…skapp"><a class="markdownIt-Anchor" href="#ä¸»é¢˜çš„å®‰è£…skapp"></a> ä¸»é¢˜çš„å®‰è£…ï¼ˆ<a href="https://github.com/Mrminfive/hexo-theme-skapp/" target="_blank" rel="noopener">skapp</a>ï¼‰</h2><blockquote><p>åˆ©ç”¨ Docker å¿«é€Ÿæ­å»º node.js v8.9.3 ç¯å¢ƒ</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -it --name node8 --rm \</span><br><span class="line">  -v $(<span class="built_in">pwd</span>):/app -w /app \</span><br><span class="line">  -p 4000:4000 \</span><br><span class="line">  node:8.9.3 /bin/bash</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ windows ä¸‹å„ç§æŠ¥é”™ï¼Œæ— å¥ˆè½¬åˆ° Linux çš„æœºå­ä¸Šæ“ä½œ</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> blog</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† skapp ä¸»é¢˜ clone è‡³ themes/skapp æ–‡ä»¶å¤¹ä¸‹</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/Mrminfive/hexo-theme-skapp.git themes/skapp</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… skapp ä¸»é¢˜æŒ‡å®šçš„ä¾èµ–</span></span><br><span class="line"><span class="comment"># åŸºäº 2018-12-19ï¼Œæœ‰ä¸ªå°å‘ï¼šè¦ä½¿ç”¨ node.js v8.9.3 ç‰ˆæœ¬æ‰èƒ½æ­£å¸¸å®‰è£…è¿™äº›ä¾èµ–ï¼Œæ˜¯ç”±äº lunr ä»ç„¶åœ¨ä½¿ç”¨ nodejieba 2.2.5 å¼•èµ·çš„</span></span><br><span class="line">npm install --save hexo-autoprefixer hexo-filter-cleanup hexo-generator-feed hexo-generator-sitemap hexo-renderer-sass hexo-renderer-swig mamboer/lunr.js moment node-sass object-assign</span><br><span class="line"></span><br><span class="line">hexo clean</span><br><span class="line"></span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><blockquote><p>ğŸš© èƒ½å¦ä½¿ç”¨ <code>Git Submodule</code> è¿›è¡Œç®¡ç†ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Ÿ</p></blockquote><p>ä¸Šé¢ç›´æ¥ <code>clone</code> äº† <code>hexo-theme-skapp</code> ä»“åº“äº <code>themes/skapp</code>ï¼Œå¸¦æœ‰ <code>.git</code> æ–‡ä»¶å¤¹ï¼Œgit è¯†åˆ«ä¸º Submoduleï¼Œä½†æ²¡æœ‰äº§ç”Ÿå¤–é“¾åˆ°åŸ <code>hexo-theme-skapp</code> ä»“åº“ï¼Œåªæ˜¯ä¸ªæ™®é€šçš„æ–‡ä»¶å¤¹ã€‚å½“æˆ‘ä»¬æŠŠè‡ªå·±çš„åšå®¢ä»“åº“ <code>clone</code> åˆ°æœ¬åœ°åä¼šå‘ç° <code>themes/skapp</code> åªæ˜¯ä¸€ä¸ªæ™®é€šçš„ç©ºæ–‡ä»¶å¤¹ ğŸ˜§ï¼Œä¸»é¢˜ä¸è§äº†ã€‚</p><p><img src="https://dn-coding-net-production-pp.codehub.cn/ab7015e1-4a51-46dc-9dbd-bf726f9a56ae.png" alt="æœªä½¿ç”¨å­æ¨¡å—"></p><p>é‚£èƒ½ä¸èƒ½åœ¨æ‰§è¡Œ <code>clone</code> æ“ä½œæ—¶èƒ½ç›´æ¥æ‹‰å–è¯¥ä¸»é¢˜ä»“åº“ï¼Œè€Œä¸”è¯¥ä¸»é¢˜çš„æºç ä¸æ‰˜ç®¡åœ¨æˆ‘ä»¬çš„ä»“åº“ä¸­å‘¢ï¼Ÿå¯ä»¥çš„ï¼Œè¿™æ—¶å°±è¯¥ä½¿ç”¨ <code>git submodule</code> äº† ğŸ‘ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…ˆå–æ¶ˆæš‚å­˜ themes/skapp ç›®å½•</span></span><br><span class="line">git rm -r themes/skapp</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å­æ¨¡å—</span></span><br><span class="line">git submodule add git@github.com:Mrminfive/hexo-theme-skapp.git themes/skapp</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥çœ‹åˆ°æ–°å¢ .gitmodules æ–‡ä»¶</span></span><br><span class="line">git status</span><br></pre></td></tr></table></figure><p><code>.gitmodules</code> æè¿°äº† Submodule çš„è¿œç¨‹ä»“åº“ä¿¡æ¯ä¸æœ¬ä»“åº“çš„ç›¸å¯¹è·¯å¾„ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[submodule &quot;themes/skapp&quot;]</span><br><span class="line">path = themes/skapp</span><br><span class="line">url = git@github.com:Mrminfive/hexo-theme-skapp.git</span><br></pre></td></tr></table></figure><p><code>.git/config</code> ä¸­ä¹Ÿè‡ªåŠ¨æ·»åŠ äº† submodule ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[submodule &quot;themes/skapp&quot;]</span><br><span class="line">url = git@github.com:Mrminfive/hexo-theme-skapp.git</span><br><span class="line">active = true</span><br></pre></td></tr></table></figure><p>ä»¥åŠäº§ç”Ÿäº† <code>.git/modules</code> æ–‡ä»¶å¤¹ï¼Œæœ€åæäº¤å¹¶æ¨é€åˆ°åšå®¢çš„è¿œç¨‹ä»“åº“ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git commit -m <span class="string">'chore: convert to skapp submodule'</span></span><br><span class="line"></span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p><a href="https://github.com/y0ngb1n/y0ngb1n.github.io/tree/a296191cc1bf8e21a7616fb447a34b7bcc89839a/themes" target="_blank" rel="noopener">GitHub ä»“åº“</a> ä¸Šä¼šæ˜¾ç¤ºå‡ºå½“å‰æ‰€å¼•å…¥çš„å­æ¨¡å—ç‰ˆæœ¬ï¼š</p><p><img src="https://dn-coding-net-production-pp.codehub.cn/e939f317-d9f0-46ea-8ff3-de27e8637fc4.png" alt="convert to skapp submodule"></p><p>å½“æˆ‘ä»¬åœ¨å…¶ä»–åœ°æ–¹è¿›è¡Œä»“åº“çš„ <code>git clone git@github.com:y0ngb1n/y0ngb1n.github.io.git</code> æ—¶ï¼Œå‘ç° <code>themes/skapp</code> æ˜¯ä¸ªç©ºæ–‡ä»¶å¤¹ï¼Œæ„å‘³ç€æ²¡æœ‰å®‰è£…è¯¥ä¸»é¢˜ã€‚é‚£ä¹ˆå¦‚ä½• <code>clone</code> ä¸€ä¸ªå®Œæ•´çš„ä»“åº“å‘¢ï¼Ÿåªéœ€å¦‚ä¸‹æ“ä½œå³å¯ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼ä¸€ï¼šä½¿ç”¨  submodule init / update</span></span><br><span class="line">git <span class="built_in">clone</span> git@github.com:y0ngb1n/y0ngb1n.github.io.git blog &amp;&amp; <span class="built_in">cd</span> blog</span><br><span class="line">git submodule init &amp;&amp; git submodule update</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼äºŒï¼šæ·»åŠ  --recursive å‚æ•°</span></span><br><span class="line">git <span class="built_in">clone</span> git@github.com:y0ngb1n/y0ngb1n.github.io.git --recursive</span><br></pre></td></tr></table></figure><p>å½“è¯¥ç¬¬ä¸‰æ–¹ä¸»é¢˜æ›´æ–°äº†ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–°å­æ¨¡å—ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git submodule update --remote themes/skapp</span><br></pre></td></tr></table></figure><p>æˆ–è€…åˆ‡æ¢è‡³ <code>themes/skapp</code> ç›®å½•ä¸‹ä½¿ç”¨ <code>git</code> å‘½ä»¤åˆ‡æ¢åˆ°ä¸åŒçš„å†å²ç‰ˆæœ¬ï¼Œå¦‚æœå¯¹å­æ¨¡å—æ‰§è¡Œäº†ç›¸å…³æ“ä½œåï¼Œä¼šæç¤º <code>modified: themes/skapp (new commits)</code>ï¼š</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch source</span><br><span class="line">Your branch is up to date with 'origin/source'.</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use "git add &lt;file&gt;..." to update what will be committed)</span><br><span class="line">  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">        modified:   themes/skapp (new commits)</span><br></pre></td></tr></table></figure><p>ç„¶åæŒ‰æ­£å¸¸æµç¨‹æäº¤å¹¶æ¨é€åˆ°è¿œç¨‹ä»“åº“å³å¯ã€‚</p><h2 id="ä¸»é¢˜çš„é…ç½®"><a class="markdownIt-Anchor" href="#ä¸»é¢˜çš„é…ç½®"></a> ä¸»é¢˜çš„é…ç½®</h2><p>ä¸»é¢˜çš„ç›¸å…³é…ç½®å¯ä»¥å‚è€ƒã€Œ<a href="https://github.com/Mrminfive/hexo-theme-skapp/blob/master/README-cn.md" target="_blank" rel="noopener">skapp å®˜æ–¹è¯´æ˜</a>ã€ï¼Œå¯ä»¥è®¾ç½®ï¼šèœå•ã€åšå®¢ä¿¡æ¯ã€è”ç³»æ–¹å¼ã€å¤–éƒ¨é“¾æ¥ç­‰ã€‚</p><blockquote><p>header çš„èƒŒæ™¯å›¾ï¼ˆéšæœºå›¾ï¼‰</p></blockquote><p>ä½¿ç”¨äº†ã€Œ<a href="https://spencerwoo.com/" target="_blank" rel="noopener">Spencer Woo</a>ã€å®¶æä¾›çš„ <a href="https://api.spencerwoo.com" target="_blank" rel="noopener">https://api.spencerwoo.com</a> æ¥å£ï¼Œå¯éšæœºä¸åŒçš„å›¾ç‰‡ï¼Œåœ¨ <code>_config.yml</code> ä¸­è®¾ç½®ï¼š</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment">## header çš„èƒŒæ™¯å›¾</span></span><br><span class="line"><span class="attr">header_cover:</span> <span class="attr">https://api.spencerwoo.com</span></span><br></pre></td></tr></table></figure><blockquote><p>å¼€å¯ã€Œ<a href="http://busuanzi.ibruce.info/" target="_blank" rel="noopener">ä¸è’œå­ç»Ÿè®¡</a>ã€</p></blockquote><p>skapp ä¸»é¢˜å·²ç»é›†æˆäº†ã€Œ<a href="http://busuanzi.ibruce.info/" target="_blank" rel="noopener">ä¸è’œå­ç»Ÿè®¡</a>ã€ï¼Œä½†é»˜è®¤æ˜¯å…³é—­çš„ï¼Œåªéœ€åœ¨ <code>_config.yml</code> ä¸­å¼€å¯å³å¯ï¼š</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Busuanzi</span></span><br><span class="line"><span class="attr">busuanzi:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2018/12/19/5c1a4cec018b2.png" alt="Skapp Hexo ä¸»é¢˜"></p><p>æ¬¢è¿å›´è§‚ <a href="https://y0ngb1n.github.io/">æˆ‘çš„åšå®¢ https://y0ngb1n.github.io/</a> ğŸ‘‹</p><h2 id="è‡ªå®šä¹‰æ ·å¼"><a class="markdownIt-Anchor" href="#è‡ªå®šä¹‰æ ·å¼"></a> è‡ªå®šä¹‰æ ·å¼</h2><blockquote><p>å¾…ç»­â€¦</p></blockquote><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://hexo.io/themes/" target="_blank" rel="noopener">å®˜æ–¹æ”¶é›†çš„ä¸»é¢˜åˆ—è¡¨</a></li><li><a href="https://github.com/Mrminfive/hexo-theme-skapp/blob/master/README-cn.md" target="_blank" rel="noopener">hexo-theme-skapp å®˜æ–¹è¯´æ˜</a></li><li><a href="https://spencerwoo.com/2018/07/30/SimpleAPI/" target="_blank" rel="noopener">Simple Deskop API | ä¸€å–µä¸€å›¾</a></li><li><a href="https://openlogos.org/" target="_blank" rel="noopener">OPEN LOGOS</a></li><li><a href="https://www.git-scm.com/docs/gitmodules" target="_blank" rel="noopener">Git - gitmodules Documentation</a></li><li><a href="https://www.git-scm.com/book/en/v2/Git-Tools-Submodules" target="_blank" rel="noopener">Git Tools - Submodules</a></li><li><a href="https://segmentfault.com/a/1190000003076028" target="_blank" rel="noopener">ä½¿ç”¨ Git Submodule ç®¡ç†å­æ¨¡å—</a></li><li><a href="https://segmentfault.com/a/1190000009928515" target="_blank" rel="noopener">å…³äº git-submodule çš„ä¸€äº›åŸºæœ¬æ“ä½œ</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;hexo-åšå®¢ä¸»é¢˜&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#hexo-åšå®¢ä¸»é¢˜&quot;&gt;&lt;/a&gt; Hexo åšå®¢ä¸»é¢˜&lt;/h2&gt;
&lt;p&gt;Hexo é»˜è®¤çš„ä¸»é¢˜ç®€é™‹ï¼Ÿä¸å¤ªå¥½çœ‹ï¼Ÿå°±æ˜¯ä¸å–œæ¬¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…¶å®æƒ³è¦æ›´æ¢ Hexo çš„ä¸»é¢˜æ˜¯å¾ˆç®€å•
      
    
    </summary>
    
      <category term="Hexo æ­å»ºä¸ªäººåšå®¢" scheme="https://y0ngb1n.github.io/categories/Hexo-%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://y0ngb1n.github.io/tags/hexo/"/>
    
      <category term="ä¸ªäººåšå®¢" scheme="https://y0ngb1n.github.io/tags/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
      <category term="git-submodule" scheme="https://y0ngb1n.github.io/tags/git-submodule/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://y0ngb1n.github.io/a/4a17b156.html"/>
    <id>https://y0ngb1n.github.io/a/4a17b156.html</id>
    <published>2018-12-19T00:00:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<p>Hiï¼è¿™æ˜¯æˆ‘çš„ä¸ªäººåšå®¢ï¼Œåˆ©ç”¨ Hexo å¼€æºæ¡†æ¶æ­å»ºè€Œæˆã€‚è‡´è°¢ã€‚</p><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2><h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hiï¼è¿™æ˜¯æˆ‘çš„ä¸ªäººåšå®¢ï¼Œåˆ©ç”¨ Hexo å¼€æºæ¡†æ¶æ­å»ºè€Œæˆã€‚è‡´è°¢ã€‚&lt;/p&gt;
&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very 
      
    
    </summary>
    
    
      <category term="hello-world" scheme="https://y0ngb1n.github.io/tags/hello-world/"/>
    
  </entry>
  
  <entry>
    <title>Hexo æ­å»ºä¸ªäººåšå®¢ #03 æ¡†æ¶çš„åŸºæœ¬ç»“æ„ä¸æ‰“åŒ…åçš„æ–‡ä»¶ä»‹ç»</title>
    <link href="https://y0ngb1n.github.io/a/b821c4ca.html"/>
    <id>https://y0ngb1n.github.io/a/b821c4ca.html</id>
    <published>2018-12-15T22:00:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç›®å½•ç»“æ„"><a class="markdownIt-Anchor" href="#ç›®å½•ç»“æ„"></a> ç›®å½•ç»“æ„</h2><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ .deploy_git</span><br><span class="line">â”œâ”€â”€ node_modules</span><br><span class="line">â”œâ”€â”€ public</span><br><span class="line">â”œâ”€â”€ scaffolds</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ draft.md</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ page.md</span><br><span class="line">â”‚Â Â  â””â”€â”€ post.md</span><br><span class="line">â”œâ”€â”€ source</span><br><span class="line">â”‚Â Â  â””â”€â”€ _posts</span><br><span class="line">â”‚Â Â      â””â”€â”€ hello-world.md</span><br><span class="line">â”œâ”€â”€ themes</span><br><span class="line">â”œâ”€â”€ .gitignore</span><br><span class="line">â”œâ”€â”€ _config.yml</span><br><span class="line">â”œâ”€â”€ db.json</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â””â”€â”€ package-lock.json</span><br></pre></td></tr></table></figure><h3 id="deploy_git"><a class="markdownIt-Anchor" href="#deploy_git"></a> .deploy_git</h3><p>åœ¨è¾“å…¥ <code>hexo d</code> éƒ¨ç½²åˆ° GitHub åè‡ªåŠ¨åˆ›å»ºã€‚è¯¥ç›®å½•çš„ç»“æ„å’Œ <code>public</code> ç›®å½•åŸºæœ¬ä¸€è‡´ï¼ˆä¸ä¸€è‡´çš„æƒ…å†µæ˜¯ç”±äºé‡æ–°ç”Ÿæˆï¼Œä½†æ˜¯æ²¡æœ‰å‘å¸ƒç«™ç‚¹é€ æˆï¼Œæ­¤æ—¶ <code>public</code> å†…å®¹æ–°äº <code>.deploy_git</code> å†…å®¹ï¼‰ã€‚</p><h3 id="node_modules"><a class="markdownIt-Anchor" href="#node_modules"></a> node_modules</h3><p>å­˜æ”¾å®‰è£…çš„ Hexo æ‰©å±•ï¼Œéƒ½æ˜¯ç›¸åº”çš„ node ä¾èµ–æ¨¡å—ã€‚</p><h3 id="public"><a class="markdownIt-Anchor" href="#public"></a> public</h3><p>åœ¨æ‰§è¡Œ <code>hexo g</code> å‘½ä»¤æ—¶ï¼ŒHexo ç¨‹åºä¼šç¼–è¯‘ <code>source</code>ã€<code>theme</code> ç›®å½•ï¼Œç”Ÿæˆçš„é™æ€ç½‘é¡µå†…å®¹ç›®å½•å°±æ˜¯ <code>piblic</code>ã€‚</p><p>ç”Ÿæˆå¥½çš„ <code>public</code> æ–‡ä»¶å¤¹å†…å®¹å°±å¯ä»¥ç›´æ¥å½“æˆé™æ€ç½‘ç«™è¿›è¡Œéƒ¨ç½²ã€‚</p><p>åœ¨æ‰§è¡Œ <code>hexo d</code> å‘½ä»¤æ—¶ï¼Œä¼šå°† <code>piblic</code> ç›®å½•å†…å®¹å¤åˆ¶åˆ° <code>.deploy_git</code> ç›®å½•ã€‚</p><h3 id="scaffolds"><a class="markdownIt-Anchor" href="#scaffolds"></a> scaffolds</h3><p><code>scaffolds</code> æ˜¯â€œè„šæ‰‹æ¶ã€éª¨æ¶â€çš„æ„æ€ï¼Œå½“ä½ æ–°å»ºä¸€ç¯‡æ–‡ç« ï¼ˆ<code>hexo new 'title'</code>ï¼‰çš„æ—¶å€™ï¼ŒHexo æ˜¯æ ¹æ®è¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶è¿›è¡Œæ„å»ºçš„ã€‚</p><h3 id="source"><a class="markdownIt-Anchor" href="#source"></a> source</h3><p>å­˜æ”¾ç”¨æˆ·èµ„æºçš„åœ°æ–¹ã€‚</p><h4 id="_posts"><a class="markdownIt-Anchor" href="#_posts"></a> _posts</h4><p>å­˜æ”¾åšå®¢æ–‡ç« çš„åœ°æ–¹ï¼Œå…¶ä¸­çš„ <code>markdown</code> æ–‡ä»¶ã€HTML æ–‡ä»¶ã€org æ–‡ä»¶ç­‰ä¼šè¢«è§£æå¹¶æ”¾åˆ° <code>public</code> æ–‡ä»¶å¤¹ï¼Œå‘å¸ƒåˆ°ç«™ç‚¹ã€‚</p><h4 id="å…¶å®ƒä»¥-_ä¸‹åˆ’çº¿å¼€å¤´çš„æ–‡ä»¶-æ–‡ä»¶å¤¹"><a class="markdownIt-Anchor" href="#å…¶å®ƒä»¥-_ä¸‹åˆ’çº¿å¼€å¤´çš„æ–‡ä»¶-æ–‡ä»¶å¤¹"></a> å…¶å®ƒä»¥ _ï¼ˆä¸‹åˆ’çº¿ï¼‰å¼€å¤´çš„æ–‡ä»¶ / æ–‡ä»¶å¤¹</h4><p>å°†ä¼šè¢«å¿½ç•¥ã€‚å› æ­¤å¯ä»¥åœ¨ <code>source</code> ç›®å½•ä¸‹åˆ›å»º  <code>_drafts</code> ç›®å½•ç”¨äºå­˜æ”¾æœªå®Œæˆçš„è‰ç¨¿ï¼Œå…¶ä¸­å†…å®¹ä¸ä¼šå‘å¸ƒåˆ°ç½‘ç«™ã€‚</p><h4 id="å…¶å®ƒé-_-å¼€å¤´çš„æ–‡ä»¶-æ–‡ä»¶å¤¹"><a class="markdownIt-Anchor" href="#å…¶å®ƒé-_-å¼€å¤´çš„æ–‡ä»¶-æ–‡ä»¶å¤¹"></a> å…¶å®ƒé _ å¼€å¤´çš„æ–‡ä»¶ / æ–‡ä»¶å¤¹</h4><p>ä¼šè¢«æ‹·è´åˆ° <code>public</code> ç›®å½•å¹¶ä¸Šä¼ åˆ°ç«™ç‚¹ã€‚</p><ul><li>å¯ä»¥åˆ›å»º <code>img</code> ç›®å½•æ¥å­˜æ”¾åœ¨åšå®¢å¼•ç”¨åˆ°çš„å›¾ç‰‡ç­‰ã€‚</li><li>è¦æ·»åŠ æ–°çš„é¡µé¢ï¼ˆä¾‹å¦‚ <code>about</code>ï¼‰ï¼Œæ‰§è¡Œ <code>hexo new page PageName</code> å‘½ä»¤å³ä¼šåœ¨ <code>source</code> ä¸­è‡ªåŠ¨æ–°å»ºå­ç›®å½• <code>PageName</code> ã€‚</li><li><code>favicon.ico</code> åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨ <code>/favicon.ico</code> æ¥è®¾ç½®ç«™ç‚¹çš„é¡µé¢å›¾æ ‡ã€‚</li></ul><h3 id="themes"><a class="markdownIt-Anchor" href="#themes"></a> themes</h3><p>ç½‘ç«™çš„ä¸»é¢˜ç›®å½•ã€‚é»˜è®¤å®‰è£… <code>landscape</code> ä¸»é¢˜ï¼Œä½ å¯ä»¥å®‰è£…æ–°ä¸»é¢˜åˆ° <code>themes</code> ç›®å½•ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æ–°å»ºä¸»é¢˜ã€‚</p><h3 id="_configyml"><a class="markdownIt-Anchor" href="#_configyml"></a> _config.yml</h3><p>å…¨å±€é…ç½®æ–‡ä»¶ï¼Œç½‘ç«™çš„å¾ˆå¤šä¿¡æ¯éƒ½åœ¨è¿™é‡Œé…ç½®ï¼Œè¯¸å¦‚ç½‘ç«™åç§°ï¼Œå‰¯æ ‡é¢˜ï¼Œæè¿°ï¼Œä½œè€…ï¼Œè¯­è¨€ï¼Œä¸»é¢˜ï¼Œéƒ¨ç½²ç­‰ç­‰å‚æ•°ã€‚</p><h3 id="dbjson"><a class="markdownIt-Anchor" href="#dbjson"></a> db.json</h3><p>è‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªæ–‡ä»¶ JSON æ–‡ä»¶ï¼Œå¯ä»¥å¯¹åšå®¢çš„æ–‡ä»¶è¿›è¡Œç®¡ç†æŸ¥æ‰¾çš„ï¼Œå¯ä»¥å¿½ç•¥ã€‚</p><h3 id="packagejson"><a class="markdownIt-Anchor" href="#packagejson"></a> package.json</h3><p>Hexo æ¡†æ¶çš„å‚æ•°å’Œæ‰€æœ‰ä¾èµ–çš„æ’ä»¶ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://www.jianshu.com/p/17d55d420d94" target="_blank" rel="noopener">Hexo çš„ç›®å½•ç»“æ„</a></li><li><a href="http://syxiaqj.github.io/2014/02/18/structure-of-hexo/" target="_blank" rel="noopener">Hexo çš„ç›®å½•ç»“æ„åŠä½œç”¨</a></li><li><a href="https://yuchen-lea.github.io/2016-01-18-hexo-dir-struct/" target="_blank" rel="noopener">Hexo ç›®å½•ç»“æ„å°æ¢</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç›®å½•ç»“æ„&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ç›®å½•ç»“æ„&quot;&gt;&lt;/a&gt; ç›®å½•ç»“æ„&lt;/h2&gt;
&lt;figure class=&quot;highlight console&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;s
      
    
    </summary>
    
      <category term="Hexo æ­å»ºä¸ªäººåšå®¢" scheme="https://y0ngb1n.github.io/categories/Hexo-%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://y0ngb1n.github.io/tags/hexo/"/>
    
      <category term="ä¸ªäººåšå®¢" scheme="https://y0ngb1n.github.io/tags/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
  </entry>
  
  <entry>
    <title>Hexo æ­å»ºä¸ªäººåšå®¢ #02 ä½¿ç”¨ GitHub æ‰˜ç®¡</title>
    <link href="https://y0ngb1n.github.io/a/bc7483d9.html"/>
    <id>https://y0ngb1n.github.io/a/bc7483d9.html</id>
    <published>2018-12-13T22:00:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ–°å»ºä»“åº“"><a class="markdownIt-Anchor" href="#æ–°å»ºä»“åº“"></a> æ–°å»ºä»“åº“</h2><p><img src="https://dn-coding-net-production-pp.codehub.cn/15d87aee-b664-4463-bd1b-9a83d1989a85.png" alt="æ–°å»ºä»“åº“"></p><p>æ–°å»ºä¸€ä¸ªåä¸º <code>y0ngb1n.github.io</code> çš„ä»“åº“ï¼Œæ ¼å¼ä¸ºï¼š<code>&lt;username&gt;.github.io</code>ã€‚</p><p>GitHub ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªäºŒçº§åŸŸå <code>&lt;username&gt;.github.io</code>ï¼Œå¦‚æœæˆ‘ä»¬ä¸ºè‡ªå·±çš„æŸä¸ªé¡¹ç›®å¼€å¯äº† <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> åŠŸèƒ½åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>http(s)://&lt;username&gt;.github.io/&lt;projectname&gt;</code> è¿›è¡Œè®¿é—®ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªé¡¹ç›®æ·»åŠ ä¸Šé¡¹ç›®å±•ç¤ºçš„ Pagesï¼›å½“æˆ‘ä»¬ã€Œæ–°å»ºä¸€ä¸ªåä¸º <code>&lt;username&gt;.github.io</code> â€”è‡ªå·±å¯¹åº”çš„äºŒçº§åŸŸåâ€”çš„ä»“åº“ã€æ—¶ï¼ŒGitHub ä¼šå°†è¯¥ä»“åº“è·¯ç”±ä¸ºæˆ‘ä»¬çš„ä¸ªäººä¸»é¡µï¼Œå¯ä½¿ç”¨ <code>http(s)://&lt;username&gt;.github.io</code> è¿›è¡Œè®¿é—®ã€‚</p><h2 id="æäº¤æºç "><a class="markdownIt-Anchor" href="#æäº¤æºç "></a> æäº¤æºç </h2><p>æŒ‰ç…§ä»“åº“é¡µé¢ä¸Šçš„æç¤ºè¿›è¡Œæ“ä½œå³å¯ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹åŒ– git ä»“åº“</span></span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›è¡Œç‰ˆæœ¬æ§åˆ¶</span></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤</span></span><br><span class="line">git commit -m <span class="string">":tada: init hexo"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ è¿œç¨‹ä»“åº“ï¼ˆGitHubï¼‰åœ°å€</span></span><br><span class="line">git remote add origin https://github.com/y0ngb1n/y0ngb1n.github.io.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€ä»£ç </span></span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><p>è¿‡ç¨‹ä¼šæç¤ºè¾“å…¥å¸å·å¯†ç ï¼Œæ¨é€æˆåŠŸåï¼Œåˆ·æ–°ä»“åº“é¡µé¢åå³å¯çœ‹åˆ°æˆ‘ä»¬æäº¤çš„æºç äº†ã€‚</p><p><img src="https://dn-coding-net-production-pp.codehub.cn/795b7e5f-5d4b-47be-aec1-351db7ee7c11.png" alt="ä»“åº“ä¸»é¡µ"></p><h2 id="å¼€å¯-github-pages-åŠŸèƒ½"><a class="markdownIt-Anchor" href="#å¼€å¯-github-pages-åŠŸèƒ½"></a> å¼€å¯ GitHub Pages åŠŸèƒ½</h2><p>å…ˆä½¿ç”¨ Hexo è¿›è¡Œç¼–è¯‘ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ¸…é™¤ç¼“å­˜ï¼Œå¯é€‰</span></span><br><span class="line">hexo clean</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¯‘</span></span><br><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨ <code>hexo-deployer-git</code> æ’ä»¶è¿›è¡Œéƒ¨ç½²ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…æ’ä»¶</span></span><br><span class="line">npm install hexo-deployer-git</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ <code>_config.yml</code>ï¼š</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">  repo:</span> <span class="string">git@github.com:y0ngb1n/y0ngb1n.github.io.git</span></span><br><span class="line"><span class="attr">  branch:</span> <span class="string">gh-pages</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨ <code>SSH</code> åè®®ï¼Œå› ä¸ºåªèƒ½èµ° Git åè®®ï¼Œèµ° HTTPS åè®®ä¼šæŠ¥é”™ï¼›å…³äº <code>SSH</code> çš„è¯·å‚è€ƒã€Œ<a href="https://help.github.com/articles/connecting-to-github-with-ssh/" target="_blank" rel="noopener">Connecting to GitHub with SSH</a>ã€ã€ã€Œ<a href="http://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html" target="_blank" rel="noopener">SSH åŸç†ä¸è¿ç”¨ï¼ˆä¸€ï¼‰ï¼šè¿œç¨‹ç™»å½•</a>ã€ã€‚</p><p>ç„¶åè¿›è¡Œéƒ¨ç½²ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²æˆåŠŸåï¼Œä¼šè‡ªåŠ¨åœ¨è¿œç¨‹ä»“åº“åˆ›å»º <code>gh-pages</code> åˆ†æ”¯ã€‚</p><p><img src="https://dn-coding-net-production-pp.codehub.cn/c0abda74-4a10-4185-8c89-9cf1825b0cba.png" alt="å›¾ç‰‡"></p><h2 id="404-éƒ¨ç½²å‡ºé—®é¢˜äº†"><a class="markdownIt-Anchor" href="#404-éƒ¨ç½²å‡ºé—®é¢˜äº†"></a> 404 éƒ¨ç½²å‡ºé—®é¢˜äº†</h2><p>åŸæœ¬æ˜¯æƒ³éƒ¨ç½² <code>gh-pages</code> åˆ†æ”¯çš„ï¼Œç»“æœåªèƒ½éƒ¨ç½² <code>master</code> åˆ†æ”¯ï¼Œç”±äºæˆ‘ä»¬çš„ <code>master</code> åˆ†æ”¯ä¸Šæ²¡æœ‰ <code>index.html</code> æ–‡ä»¶ï¼Œæ‰€ä»¥è®¿é—®ä¸»é¡µæ—¶å‡ºç°äº† 404ï¼›</p><p>ç»éªŒè¯ï¼šæ˜¯ç”±äºæˆ‘ä»¬çš„ä»“åº“ä½¿ç”¨äº†äºŒçº§åŸŸåçš„æ–¹å¼ï¼ŒGitHub Pages åªèƒ½éƒ¨ç½² <code>master</code> åˆ†æ”¯ï¼Œä¸”ä¸èƒ½é€‰æ‹©ï¼Œå¦‚æœæŠŠåå­—æ”¹ä¸ºåˆ«çš„ï¼ˆå¦‚ <code>blog</code>ï¼‰ï¼Œæ­¤æ—¶å°±èƒ½é€‰æ‹©éƒ¨ç½²å“ªä¸ªåˆ†æ”¯äº†ã€‚</p><p>æˆ‘æƒ³åˆ°çš„æœ‰ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆï¼š</p><ol><li>è°ƒæ•´åˆ†æ”¯ç­–ç•¥ï¼š<ul><li><code>master</code>ï¼šç¼–è¯‘åçš„é™æ€èµ„æº</li><li><code>source</code>ï¼šåšå®¢æºç </li></ul></li><li>ä¿®æ”¹ä»“åº“åï¼ˆå¦‚ <code>blog</code>ï¼‰ï¼š<ul><li>ä¼˜ç‚¹ï¼šå¯è°ƒæ•´ github-pages éƒ¨ç½²ç­–ç•¥</li><li>ç¼ºç‚¹ï¼šä¸èƒ½ç›´æ¥ä½¿ç”¨äºŒçº§åŸŸåè®¿é—®äº†ï¼Œéœ€è¦åŠ ä¸Š <code>/blog</code> åç¼€è¿›è¡Œè®¿é—®ï¼ˆå¯ä»¥è‡ªå®šä¹‰åŸŸåè§£å†³ï¼‰</li></ul></li></ol><p>è¿™é‡Œæˆ‘é€‰æ‹©æ–¹æ¡ˆ 1ï¼ˆè°ƒæ•´åˆ†æ”¯ç­–ç•¥ï¼‰ï¼š</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -a</span></span><br><span class="line">  ls</span><br><span class="line">* master</span><br><span class="line">  remotes/origin/master</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> *å…ˆåœ¨ä»“åº“è®¾ç½®ä¸­å°† gh-pages è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯ï¼ˆå¦åˆ™æ— æ³•åˆ é™¤ master åˆ†æ”¯ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å‘½åæœ¬åœ° master åˆ†æ”¯ä¸º <span class="built_in">source</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -m master <span class="built_in">source</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤è¿œç¨‹ master åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push --delete origin master</span></span><br><span class="line">To github.com:y0ngb1n/y0ngb1n.github.io.git</span><br><span class="line"> - [deleted]         master</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸Šä¼ æ–°çš„ <span class="built_in">source</span> åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push origin <span class="built_in">source</span></span></span><br><span class="line">To github.com:y0ngb1n/y0ngb1n.github.io.git</span><br><span class="line"> * [new branch]      source -&gt; source</span><br></pre></td></tr></table></figure><p>ç„¶åä¿®æ”¹ <code>_config.yml</code>ï¼Œå°†ç¼–è¯‘åçš„é™æ€éƒ¨ç½²è‡³ <code>master</code> åˆ†æ”¯ï¼š</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">  repo:</span> <span class="string">git@github.com:y0ngb1n/y0ngb1n.github.io.git</span></span><br><span class="line"><span class="attr">  branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å®Œæˆåï¼Œæ‰§è¡Œ <code>hexo d</code> è¿›è¡Œç¼–è¯‘éƒ¨ç½²ï¼Œç›´åˆ°è¿œç¨‹ä»“åº“å‡ºç°æ–°çš„ <code>master</code> åˆ†æ”¯ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> hexo d</span></span><br><span class="line">INFO  Deploying: git</span><br><span class="line">INFO  Clearing .deploy_git folder...</span><br><span class="line">INFO  Copying files from public folder...</span><br><span class="line">INFO  Copying files from extend dirs...</span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line">remote:</span><br><span class="line">remote: Create a pull request for 'master' on GitHub by visiting:</span><br><span class="line">remote:      https://github.com/y0ngb1n/y0ngb1n.github.io/pull/new/master</span><br><span class="line">remote:</span><br><span class="line">Branch 'master' set up to track remote branch 'master' from 'git@github.com:y0ngb1n/y0ngb1n.github.io.git'.</span><br><span class="line">To github.com:y0ngb1n/y0ngb1n.github.io.git</span><br><span class="line"> * [new branch]      HEAD -&gt; master</span><br><span class="line">INFO  Deploy done: git</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ <code>github-pages</code> ç›‘æµ‹åˆ° <code>master</code> åˆ†æ”¯æœ‰æ›´æ–°ï¼Œä¼šæ›´æ–°éƒ¨ç½²ï¼Œæ­¤æ—¶è®¿é—® <a href="https://y0ngb1n.github.io/">https://y0ngb1n.github.io/</a> ç»ˆäºçœ‹åˆ°äº†æœŸå¾…ä»¥ä¹…çš„ Hexo åšå®¢é¡µé¢ã€‚</p><p><img src="https://dn-coding-net-production-pp.codehub.cn/d2760022-b64f-46e1-90bf-c74a5366631f.png" alt="y0ngb1n.github.io"></p><p>å› ä¸ºæˆ‘ä»¬è°ƒæ•´äº†åˆ†æ”¯ç­–ç•¥ï¼Œæ‰€ä»¥æ­¤æ—¶ <code>source</code> åˆ†æ”¯æ‰æ˜¯æˆ‘ä»¬çš„ä¸»åˆ†æ”¯äº†ï¼Œåœ¨è®¾ç½®ä¸­æŠŠ <code>source</code> è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯ï¼Œç„¶åå†æŠŠ <code>gh-pages</code> åˆ†æ”¯ä»è¿œç¨‹ä»“åº“ä¸­åˆ é™¤æ‰ã€‚</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤è¿œç¨‹ gh-pages åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push --delete origin gh-pages</span></span><br><span class="line">To github.com:y0ngb1n/y0ngb1n.github.io.git</span><br><span class="line"> - [deleted]         gh-pages</span><br></pre></td></tr></table></figure><p>è‡³æ­¤å°±å¤§åŠŸå‘Šæˆå•¦ï¼</p><blockquote><p>åªæœ‰ GitHub å¯èƒ½å…è´¹æ‰˜ç®¡å—ï¼Ÿ</p></blockquote><p>å½“ç„¶ä¸æ­¢å•¦ï¼Œå…¶å®ƒå¹³å°ä¹Ÿæœ‰æä¾›è¿™æ ·çš„ Pages åŠŸèƒ½ï¼Œå¦‚ï¼š</p><ul><li><a href="https://docs.gitlab.com/ee/user/project/pages/" target="_blank" rel="noopener">GitLab Pages</a></li><li><a href="https://gitee.com/help/articles/4228" target="_blank" rel="noopener">ç äº‘ Gitee Pages Pro</a></li><li><a href="https://coding.net/pages/" target="_blank" rel="noopener">Coding Pages</a></li></ul><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://help.github.com/categories/github-pages-basics/" target="_blank" rel="noopener">GitHub Pages Basics</a></li><li><a href="https://help.github.com/categories/customizing-github-pages/" target="_blank" rel="noopener">Customizing GitHub Pages</a></li><li><a href="http://chitanda.me/2015/11/03/multiple-git-pages-in-one-github-account/" target="_blank" rel="noopener">å•ä¸ª GitHub å¸å·ä¸‹æ·»åŠ å¤šä¸ª GitHub Pages çš„ç›¸å…³é—®é¢˜</a></li><li><a href="https://help.github.com/articles/configuring-a-publishing-source-for-github-pages/" target="_blank" rel="noopener">Configuring a publishing source for GitHub Pages</a></li><li><a href="https://sisibeloved.github.io/hexoBlog/2018/04/12/Github-Pages%E9%83%A8%E7%BD%B2%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2-Hexo%E7%AF%87/" target="_blank" rel="noopener">Github Pages éƒ¨ç½²ä¸ªäººåšå®¢ - Hexo ç¯‡</a></li><li><a href="https://help.github.com/articles/connecting-to-github-with-ssh/" target="_blank" rel="noopener">Connecting to GitHub with SSH</a></li><li><a href="http://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html" target="_blank" rel="noopener">SSH åŸç†ä¸è¿ç”¨ï¼ˆä¸€ï¼‰ï¼šè¿œç¨‹ç™»å½•</a></li><li><a href="https://www.jianshu.com/p/cc740394faf5" target="_blank" rel="noopener">Git ä¿®æ”¹åˆ†æ”¯åç§°</a></li><li><a href="https://gitee.com/all-about-git" target="_blank" rel="noopener">Git å¤§å…¨</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æ–°å»ºä»“åº“&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#æ–°å»ºä»“åº“&quot;&gt;&lt;/a&gt; æ–°å»ºä»“åº“&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://dn-coding-net-production-pp.codehub.cn/15d87aee-
      
    
    </summary>
    
      <category term="Hexo æ­å»ºä¸ªäººåšå®¢" scheme="https://y0ngb1n.github.io/categories/Hexo-%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://y0ngb1n.github.io/tags/hexo/"/>
    
      <category term="ä¸ªäººåšå®¢" scheme="https://y0ngb1n.github.io/tags/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
      <category term="github-pages" scheme="https://y0ngb1n.github.io/tags/github-pages/"/>
    
  </entry>
  
  <entry>
    <title>Hexo æ­å»ºä¸ªäººåšå®¢ #01 æ¡†æ¶çš„æœ¬åœ°å®‰è£…ä¸è¿è¡Œ</title>
    <link href="https://y0ngb1n.github.io/a/368bdd3e.html"/>
    <id>https://y0ngb1n.github.io/a/368bdd3e.html</id>
    <published>2018-12-09T00:00:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h2><p>è¿›å…¥ã€Œ<a href="https://hexo.io/" target="_blank" rel="noopener">Hexo å®˜ç½‘</a>ã€ä¾¿å¯ä»¥çœ‹åˆ°ä¸€å¥é†’ç›®çš„ Sloganï¼š</p><blockquote><p>A fast, simple &amp; powerful blog framework<br>å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶</p></blockquote><p>Hexo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ã€‚Hexo ä½¿ç”¨ Markdownï¼ˆæˆ–å…¶ä»–æ¸²æŸ“å¼•æ“ï¼‰è§£ææ–‡ç« ï¼Œåœ¨å‡ ç§’å†…ï¼Œå³å¯åˆ©ç”¨é“ä¸½çš„ä¸»é¢˜ç”Ÿæˆé™æ€ç½‘é¡µã€‚</p><h2 id="å®‰è£…"><a class="markdownIt-Anchor" href="#å®‰è£…"></a> å®‰è£…</h2><p>ç”±äº Hexo éœ€è¦åŸºäº <a href="https://nodejs.org/" target="_blank" rel="noopener">Node.js</a> ä¸ <a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a> è¿›è¡Œæ¡†æ¶çš„æ­å»ºï¼ˆè¯·è‡ªè¡Œ Google Node.jsã€Git çš„å®‰è£…ï¼‰ï¼Œä¸‹é¢å¼€å§‹æ­£å¼å®‰è£…ã€‚</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£… Hexo æä¾›çš„è„šæ‰‹æ¶ hexo-cli</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install hexo-cli -g</span></span><br></pre></td></tr></table></figure><h2 id="è¿è¡Œ"><a class="markdownIt-Anchor" href="#è¿è¡Œ"></a> è¿è¡Œ</h2><p>æ¥ç€è¿›è¡Œåˆå§‹åŒ–é¡¹ç›®ï¼Œä»¥åŠæœ¬åœ°è¿è¡Œ Hexoã€‚</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆå§‹åŒ–åšå®¢ï¼Œä¼šåœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ª blog çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾å·¥ç¨‹æºç ï¼Œblog å¯ä»¥ä»»æ„</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo init blog</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> blog</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…é¡¹ç›®æ‰€éœ€è¦çš„ä¾èµ–</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨åšå®¢</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo server</span></span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http://localhost:4000 . Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ã€Œ<a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a>ã€å³å¯çœ‹åˆ° Hexo é»˜è®¤ä¸»é¢˜çš„åšå®¢ç«™ç‚¹ã€‚</p><p><img src="https://dn-coding-net-production-pp.codehub.cn/f988803e-dc43-4ae5-8c1e-b65cb8052244.png" alt="Hexo é»˜è®¤ä¸»é¢˜"></p><h2 id="å¸¸ç”¨å‘½ä»¤"><a class="markdownIt-Anchor" href="#å¸¸ç”¨å‘½ä»¤"></a> å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> hexo n <span class="string">"myblog"</span>   <span class="comment"># =&gt; hexo new "myblog"</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo p            <span class="comment"># =&gt; hexo publish</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo g            <span class="comment"># =&gt; hexo generate</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo s            <span class="comment"># =&gt; hexo server</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo d            <span class="comment"># =&gt; hexo deploy</span></span></span><br></pre></td></tr></table></figure><blockquote><p>å…³äº Hexo çš„æœåŠ¡å™¨å‘½ä»¤</p></blockquote><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> hexo server                   <span class="comment"># Hexo ä¼šç›‘è§†æ–‡ä»¶å˜åŠ¨å¹¶è‡ªåŠ¨æ›´æ–°ï¼Œæ— é¡»é‡å¯æœåŠ¡å™¨</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo server -s                <span class="comment"># é™æ€æ¨¡å¼</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo server -p 5000           <span class="comment"># æ›´æ”¹ç«¯å£</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo server -i 192.168.1.1    <span class="comment"># è‡ªå®šä¹‰ IP</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo clean                    <span class="comment"># æ¸…é™¤ç¼“å­˜ï¼Œç½‘é¡µæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥å¿½ç•¥æ­¤æ¡å‘½ä»¤</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo g                        <span class="comment"># ç”Ÿæˆé™æ€ç½‘é¡µ</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo d                        <span class="comment"># å¼€å§‹éƒ¨ç½²</span></span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯ Hexoï¼Ÿ</a></li><li><a href="https://hexo.io/zh-cn/docs/commands.html" target="_blank" rel="noopener">Hexo æŒ‡ä»¤</a></li><li><a href="https://www.jianshu.com/p/83d5989bd496" target="_blank" rel="noopener">Hexo å¸¸ç”¨å‘½ä»¤ç¬”è®°</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#å‰è¨€&quot;&gt;&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;è¿›å…¥ã€Œ&lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo å®˜ç½‘&lt;/a&gt;
      
    
    </summary>
    
      <category term="Hexo æ­å»ºä¸ªäººåšå®¢" scheme="https://y0ngb1n.github.io/categories/Hexo-%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://y0ngb1n.github.io/tags/hexo/"/>
    
      <category term="ä¸ªäººåšå®¢" scheme="https://y0ngb1n.github.io/tags/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ Windows 10 ä¸‹å®‰è£… Node.jsï¼ˆv10.14.1ï¼‰</title>
    <link href="https://y0ngb1n.github.io/a/b9f01718.html"/>
    <id>https://y0ngb1n.github.io/a/b9f01718.html</id>
    <published>2018-12-07T22:00:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‡†å¤‡å·¥ä½œ"><a class="markdownIt-Anchor" href="#å‡†å¤‡å·¥ä½œ"></a> å‡†å¤‡å·¥ä½œ</h2><p>å‰å¾€ã€Œ<a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">å®˜æ–¹ä¸‹è½½é¡µé¢</a>ã€è·å–æœ€æ–°çš„ LTS ç‰ˆæœ¬ï¼Œå½“å‰ä¸º <code>Latest LTS Version: 10.14.1</code>ï¼Œå®˜æ–¹æä¾›äº†ä¸åŒå¹³å°çš„å®‰è£…æ–‡ä»¶ï¼Œæˆ‘ä»¬é€‰æ‹© <code>Windows Binary (.zip) 64-bit</code>ï¼Œç‚¹å‡»ä¸‹è½½å‹ç¼©ç‰ˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><p><img src="https://dn-coding-net-production-pp.codehub.cn/1b43306b-8613-409b-9800-900f3bc23e5f.png" alt="å›¾ç‰‡"></p><h2 id="è¿›å…¥å®‰è£…"><a class="markdownIt-Anchor" href="#è¿›å…¥å®‰è£…"></a> è¿›å…¥å®‰è£…</h2><p>ä¸‹è½½å®Œæˆåè¿›è¡Œè§£å‹ï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œæˆ‘æ–°å»ºäº† <code>F:\Node.js\dev_tools\node\v10.14.1</code> ç”¨æ¥ä¿å­˜è§£å‹å Node.js çš„ç¨‹åºï¼Œå¹¶é»˜è®¤å®‰è£…äº† npmã€‚</p><p><img src="https://dn-coding-net-production-pp.codehub.cn/bdc50741-6ec3-4a6b-b773-fcba1de7367a.png" alt="å›¾ç‰‡"></p><p>ä¸ºäº†åœ¨ CMD ä¸­ä½¿ç”¨ Node.js çš„ç›¸å…³å‘½ä»¤ï¼Œæ¥ä¸‹æ¥æ·»åŠ ã€Œç¯å¢ƒå˜é‡ã€ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ–°å»º Node.js å®‰è£…è·¯å¾„çš„ç¯å¢ƒå˜é‡</span><br><span class="line">NODE_HOME=F:\Node.js\dev_tools\node\v10.14.1</span><br><span class="line"></span><br><span class="line"># æ·»åŠ è‡³ Path ä¸‹</span><br><span class="line">Path=&#123;...&#125;;%NODE_HOME%;</span><br></pre></td></tr></table></figure><blockquote><p>ç”±äº Node.js ä¸­é»˜è®¤å®‰è£…äº† npmï¼Œæ‰€ä»¥ä¸ç”¨é¢å¤–é…ç½®å°±èƒ½åœ¨å…¨å±€å‘½ä»¤ä¸­ä½¿ç”¨ <code>npm</code> å‘½ä»¤ï¼Œå¦‚æœè¦ä½¿ç”¨è‡ªå·±å®‰è£…çš„ npm æ—¶ï¼Œå¦‚ cnpm  ï¼Œé‚£ä¹ˆå°±éœ€è¦åƒä¸Šé¢ä¸€æ ·æ·»åŠ ç›¸åº”çš„ç¯å¢ƒå˜é‡</p></blockquote><h2 id="æµ‹è¯•"><a class="markdownIt-Anchor" href="#æµ‹è¯•"></a> æµ‹è¯•</h2><p>åœ¨ PowerShell ä¸‹è¾“å…¥ <code>node -v</code> ä¸ <code>npm -v</code>ï¼š</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">PS C:\&gt; node -v</span><br><span class="line">v10.14.1</span><br><span class="line">PS C:\&gt; npm -v</span><br><span class="line">6.4.1</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å½“å‰ node å’Œ npm çš„å®‰è£…ç‰ˆæœ¬åˆ†åˆ«ä¸ºï¼š<code>v10.14.1</code>ã€<code>6.4.1</code>ã€‚</p><h2 id="npm-é…ç½®"><a class="markdownIt-Anchor" href="#npm-é…ç½®"></a> NPM é…ç½®</h2><h3 id="æŸ¥çœ‹å½“å‰é…ç½®"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹å½“å‰é…ç½®"></a> æŸ¥çœ‹å½“å‰é…ç½®</h3><p>ä½¿ç”¨ <code>npm config list</code> å½“å‰é…ç½®ï¼Œæˆ–ä½¿ç”¨ <code>npm config ls -l</code> å…¨éƒ¨é…ç½®ä¿¡æ¯ã€‚</p><h3 id="å…¨å±€æ¨¡å—ç›®å½•-åŠ-ç¼“å­˜ç›®å½•"><a class="markdownIt-Anchor" href="#å…¨å±€æ¨¡å—ç›®å½•-åŠ-ç¼“å­˜ç›®å½•"></a> å…¨å±€æ¨¡å—ç›®å½• åŠ ç¼“å­˜ç›®å½•</h3><p>é…ç½® npm å®‰è£…çš„ <code>å…¨å±€æ¨¡å—ç›®å½•</code>ï¼Œä»¥åŠ <code>ç¼“å­˜ç›®å½•</code>ã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆè¦é…ç½®è¿™ä¸¤ä¸ªç›®å½•å‘¢ï¼Ÿ</p></blockquote><p>åœ¨æ‰§è¡Œå…¨å±€å®‰è£…è¯­å¥æ—¶ï¼Œå¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install express -g</span><br></pre></td></tr></table></figure><ul><li><code>-g</code>ï¼šå¯é€‰å‚æ•° -gï¼Œg ä»£è¡¨ globalï¼Œå…¨å±€å®‰è£…çš„æ„æ€</li></ul><p>å½“å‰æ˜¯åŸºäºè§£å‹ç‰ˆå®‰è£…çš„ï¼Œé»˜è®¤ä¼šå°† <code>express</code> æ¨¡å—å®‰è£…è‡³ <code>{è§£å‹ç›®å½•}\node_modules</code> ç›®å½•ä¸­ï¼Œå¦‚æˆ‘å½“å‰çš„æ˜¯ï¼š<code>F:\Node.js\dev_tools\node\v10.14.1\node_modules</code>ï¼›npm çš„ç¼“å­˜æ–‡ä»¶ä¼šä¿å­˜è‡³ <code>C:\Users\%USERNAME%\AppData\Roaming\npm-cache</code> ç›®å½•ã€‚å¦‚æœæ˜¯åŸºäºå®‰è£…æ–‡ä»¶ç›´æ¥å®‰è£…çš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹éƒ½é»˜è®¤åœ¨ C ç›˜ä¸‹ï¼Œè¿™æ ·å°±ä¼šå ç”¨æˆ‘ä»¬ C ç›˜çš„ç©ºé—´ã€‚</p><blockquote><p>å¯ä»¥è‡ªå®šä¹‰æŒ‡å®šè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹å—ï¼Ÿ</p></blockquote><p>æ¥ä¸‹æ¥å¼€å§‹é…ç½®è¿™ä¸¤ä¸ªç›®å½•ï¼ŒæŒ‡å®šã€Œå…¨å±€æ¨¡å—çš„å®‰è£…ç›®å½•ã€ã€ã€Œç¼“å­˜ç›®å½•ã€ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é…ç½®å…¨å±€æ¨¡å—å®‰è£…ç›®å½•ï¼Œæ–‡ä»¶ä¼šä¿å­˜è‡³ node_modules æ–‡ä»¶å¤¹</span></span><br><span class="line">npm config <span class="built_in">set</span> prefix <span class="string">"F:\Node.js\dev_tools\node\v10.14.1"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®ç¼“å­˜ç›®å½•</span></span><br><span class="line">npm config <span class="built_in">set</span> cache <span class="string">"F:\Node.js\dev_tools\node\v10.14.1\npm-cache"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®åå¯é€šè¿‡ä¸‹é¢æ–¹å¼æ¥éªŒè¯æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">npm config list</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">npm config ls -l</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬å†æ‰§è¡Œä¸€æ¬¡å…¨å±€å®‰è£… <code>express</code> æ¨¡å—ï¼Œå¯ä»¥çœ‹åˆ°å‡ºç°äº†æˆ‘ä»¬æŒ‡å®šçš„ç›®å½•ã€‚</p><blockquote><p>æˆ‘ä»¬çš„è‡ªå®šä¹‰é…ç½®ä¼šä¿å­˜åœ¨ <code>C:\Users\%USERNAME%\.npmrc</code> æ–‡ä»¶ä¸­ã€‚</p></blockquote><h3 id="é…ç½®-npm-é•œåƒæº"><a class="markdownIt-Anchor" href="#é…ç½®-npm-é•œåƒæº"></a> é…ç½® NPM é•œåƒæº</h3><p>æˆ‘ä»¬å¯ä»¥æŒ‡å®š npm çš„é•œåƒæºè¾¾åˆ°ç½‘ç»œåŠ é€Ÿçš„æ•ˆæœï¼Œé»˜è®¤çš„æºä¸ºï¼š<code>https://registry.npmjs.org</code>ï¼Œåœ¨å›½å†…è®¿é—®é€Ÿåº¦è¾ƒæ…¢ã€‚</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸€äº›å›½å†…ä¼˜ç§€çš„ npm é•œåƒæºï¼Œå¦‚ï¼š</p><ul><li><a href="https://cnpmjs.org/" target="_blank" rel="noopener">CNPM</a>ï¼š<code>https://r.cnpmjs.org/</code></li><li><a href="https://npm.taobao.org/" target="_blank" rel="noopener">æ·˜å® NPM é•œåƒ</a>ï¼š<code>https://registry.npm.taobao.org/</code></li></ul><blockquote><p>ä¸´æ—¶ä½¿ç”¨</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm --registry https://registry.npm.taobao.org install express -g</span><br></pre></td></tr></table></figure><blockquote><p>æŒä¹…ä½¿ç”¨</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®åå¯é€šè¿‡ä¸‹é¢æ–¹å¼æ¥éªŒè¯æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">npm config get registry</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">npm info express</span><br></pre></td></tr></table></figure><blockquote><p>é€šè¿‡ <code>cnpm</code> ä½¿ç”¨</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨</span></span><br><span class="line">cnpm install express -g</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœä¸èƒ½ä½¿ç”¨ cnpmï¼Œå¯èƒ½æ˜¯æŒ‡å®šäº† npm çš„å…¨å±€æ¨¡å—ç›®å½•å¯¼è‡´ï¼Œéœ€è¦é…ç½®ç›¸åº”çš„ç³»ç»Ÿç¯å¢ƒï¼Œè‡ªè¡Œå‚è€ƒä¸Šé¢çš„ã€Œè¿›å…¥å®‰è£…ã€æ¨¡å—</span></span><br></pre></td></tr></table></figure><ul><li>æ³¨æ„ï¼šæ­¤æ—¶çš„ cnpm ä¹Ÿä¼šæœ‰é»˜è®¤çš„é…ç½®ï¼ŒåŒæ ·éœ€è¦è¿›è¡Œã€ŒNPM é…ç½®ã€æ¨¡å—é‚£æ ·è¿›è¡Œ <code>å…¨å±€æ¨¡å—ç›®å½•</code> åŠ <code>ç¼“å­˜ç›®å½•</code> çš„ç›¸å…³è®¾ç½®ã€‚è‡ªå®šä¹‰é…ç½®ä¼šä¿å­˜åœ¨ <code>C:\Users\%USERNAME%\.cnpmrc</code> æ–‡ä»¶ä¸­ã€‚</li></ul><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/00143450141843488beddae2a1044cab5acb5125baf0882000" target="_blank" rel="noopener">å®‰è£… Node.js å’Œ npm</a></li><li><a href="http://www.runoob.com/nodejs/nodejs-install-setup.html" target="_blank" rel="noopener">Node.js å®‰è£…é…ç½®</a></li><li><a href="https://www.jianshu.com/p/cc26e5d0f10f" target="_blank" rel="noopener">Node.js å®‰è£…å’Œé…ç½®ï¼ˆwindows ç‰ˆï¼‰</a></li><li><a href="https://www.jianshu.com/p/03a76b2e7e00" target="_blank" rel="noopener">Node.js å®‰è£…åŠç¯å¢ƒé…ç½®ä¹‹ Windows ç¯‡</a></li><li><a href="https://www.jianshu.com/p/9f0481237691" target="_blank" rel="noopener">åœ¨ Windows ç¯å¢ƒä¸‹å®‰è£…å¹¶é…ç½® Node.js</a></li><li><a href="http://riny.net/2014/cnpm/" target="_blank" rel="noopener">å›½å†…ä¼˜ç§€ npm é•œåƒæ¨èåŠä½¿ç”¨</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‡†å¤‡å·¥ä½œ&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#å‡†å¤‡å·¥ä½œ&quot;&gt;&lt;/a&gt; å‡†å¤‡å·¥ä½œ&lt;/h2&gt;
&lt;p&gt;å‰å¾€ã€Œ&lt;a href=&quot;https://nodejs.org/en/download/&quot; target=&quot;_blank&quot; rel=&quot;
      
    
    </summary>
    
    
      <category term="node.js" scheme="https://y0ngb1n.github.io/tags/node-js/"/>
    
      <category term="npm" scheme="https://y0ngb1n.github.io/tags/npm/"/>
    
      <category term="cnpm" scheme="https://y0ngb1n.github.io/tags/cnpm/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot 2.0 æ•´åˆ Thymeleaf æ¨¡å—å¼•æ“</title>
    <link href="https://y0ngb1n.github.io/a/567589f9.html"/>
    <id>https://y0ngb1n.github.io/a/567589f9.html</id>
    <published>2018-11-29T22:00:00.000Z</published>
    <updated>2019-12-28T16:09:58.823Z</updated>
    
    <content type="html"><![CDATA[<p>Thymeleaf æ˜¯ä¸€ç§ Java XML / XHTML / HTML5 æ¨¡æ¿å¼•æ“ï¼Œå¯ä»¥åœ¨ Web å’Œé Web ç¯å¢ƒä¸­ä½¿ç”¨ã€‚å®ƒæ›´é€‚åˆåœ¨åŸºäº MVC çš„ Web åº”ç”¨ç¨‹åºçš„è§†å›¾å±‚æä¾› XHTML / HTML5ï¼Œä½†å³ä½¿åœ¨è„±æœºç¯å¢ƒä¸­ï¼Œå®ƒä¹Ÿå¯ä»¥å¤„ç†ä»»ä½•XMLæ–‡ä»¶ã€‚å®ƒæä¾›äº†å®Œæ•´çš„ Spring Framework é›†æˆã€‚</p><h2 id="å¼€å‘ç¯å¢ƒ"><a class="markdownIt-Anchor" href="#å¼€å‘ç¯å¢ƒ"></a> å¼€å‘ç¯å¢ƒ</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å¼•å…¥ä¾èµ–"><a class="markdownIt-Anchor" href="#å¼•å…¥ä¾èµ–"></a> å¼•å…¥ä¾èµ–</h2><p>ä¸»è¦å¢åŠ  <code>spring-boot-starter-thymeleaf</code> ä¾èµ–ï¼š</p><ul><li><code>spring-boot-starter-thymeleaf</code>ï¼šè‡ªåŠ¨è£…é… Thymeleaf æ¨¡æ¿å¼•æ“</li></ul><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- Thymeleaf Start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- Thymeleaf End --&gt;</span></span><br><span class="line">  </span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®-thymeleaf"><a class="markdownIt-Anchor" href="#é…ç½®-thymeleaf"></a> é…ç½® Thymeleaf</h2><p><code>application.yml</code></p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  thymeleaf:</span></span><br><span class="line"><span class="attr">    cache:</span> <span class="literal">false</span>                  <span class="comment"># æ˜¯å¦å¼€å¯æ¨¡æ¿ç¼“å­˜ï¼Œé»˜è®¤ä¸ºï¼štrueï¼Œå¼€å‘æ—¶å…³é—­ç¼“å­˜ï¼Œä¸ç„¶æ²¡æ³•çœ‹åˆ°å®æ—¶é¡µé¢ï¼</span></span><br><span class="line"><span class="attr">    mode:</span> <span class="string">HTML</span>                    <span class="comment"># æŒ‡å®šæ¨¡æ¿çš„æ¨¡å¼ï¼Œé»˜è®¤ä¸ºï¼šHTML</span></span><br><span class="line"><span class="attr">    encoding:</span> <span class="string">UTF-8</span>               <span class="comment"># æŒ‡å®šæ¨¡æ¿çš„ç¼–ç ï¼Œé»˜è®¤ä¸ºï¼šUTF-8</span></span><br><span class="line"><span class="attr">    prefix:</span> <span class="attr">classpath:/templates/</span> <span class="comment"># æŒ‡å®šæ¨¡æ¿çš„å‰ç¼€ï¼Œé»˜è®¤ä¸ºï¼šclasspath:/templates/</span></span><br><span class="line"><span class="attr">    suffix:</span> <span class="string">.html</span>                 <span class="comment"># æŒ‡å®šæ¨¡æ¿çš„åç¼€ï¼Œé»˜è®¤ä¸ºï¼š.html</span></span><br><span class="line"><span class="attr">    servlet:</span></span><br><span class="line"><span class="attr">      content-type:</span> <span class="string">text/html</span>     <span class="comment"># æŒ‡å®š Content-Type å€¼ï¼Œé»˜è®¤ä¸ºï¼štext/html</span></span><br></pre></td></tr></table></figure><p>ä» <code>org.thymeleaf.templatemode.TemplateMode</code> ä¸­å¯è§ <code>Thymeleaf</code> ä» <code>3.0.0</code> ç‰ˆæœ¬å¼€å§‹ä½¿ç”¨ <code>HTML</code> æ›¿ä»£ <code>HTML5ã€LEGACYHTML5ã€XHTMLã€VALIDXHTML</code>ã€‚å¦‚æœè¿˜åœ¨ä½¿ç”¨ <code>3.0.0</code> ä»¥å‰çš„ç‰ˆæœ¬ï¼Œæƒ³è¦ä½¿ç”¨éä¸¥æ ¼çš„ HTMLï¼Œéœ€è¦åšä»¥ä¸‹é…ç½®ï¼š</p><ul><li>åœ¨ <code>pom.xml</code> ä¸­å¼•å…¥ <code>nekohtml</code> ä¾èµ–</li><li>åœ¨ <code>application.yml</code> ä¸­é…ç½® <code>spring.thymeleaf.mode=LEGACYHTML5</code></li></ul><p>æ›´å¤šå±æ€§é…ç½®è¯·å‚è€ƒã€Œ<a href="https://docs.spring.io/spring-boot/docs/2.1.0.RELEASE/reference/htmlsingle/#common-application-properties" target="_blank" rel="noopener">Appendix A. Common application properties</a>ã€ä¸­ <code># THYMELEAF (ThymeleafAutoConfiguration)</code> æ¨¡å—çš„å±æ€§ä»‹ç»ã€‚ï¼ˆTIPSï¼šä½¿ç”¨ <code>CTRL + F</code> è¿›è¡Œå¿«é€Ÿå®šä½ï¼‰</p><h2 id="åˆ›å»ºæµ‹è¯•-controller"><a class="markdownIt-Anchor" href="#åˆ›å»ºæµ‹è¯•-controller"></a> åˆ›å»ºæµ‹è¯• Controller</h2><p>åˆ›å»ºä¸€ä¸ª Controllerï¼Œä¸º <code>message</code> å±æ€§èµ‹å€¼å¹¶è®¾ç½®è·³è½¬ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><p><code>IndexController.java</code></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@GetMapping</span>(path = &#123;<span class="string">"/"</span>, <span class="string">"index"</span>&#125;)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">indexPage</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">    model.addAttribute(<span class="string">"message"</span>, <span class="string">"Hello Thymeleaf!"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"index"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºæµ‹è¯•-html-é¡µé¢"><a class="markdownIt-Anchor" href="#åˆ›å»ºæµ‹è¯•-html-é¡µé¢"></a> åˆ›å»ºæµ‹è¯• HTML é¡µé¢</h2><p>åœ¨ <code>templates</code> ç›®å½•ä¸‹åˆ›å»º <code>index.html</code> æ–‡ä»¶ï¼Œå¹¶åœ¨ <code>html</code> æ ‡ç­¾ä¸­å£°æ˜ Thymeleaf å‘½åç©ºé—´ <code>xmlns:th=&quot;http://www.thymeleaf.org&quot;</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><p><code>index.html</code></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Thymeleaf<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">th:text</span>=<span class="string">"$&#123;message&#125;"</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­å…³é”®çš„ä»£ç æ˜¯ï¼š</p><blockquote><p>xmlns:th=â€œ<a href="http://www.thymeleaf.org" target="_blank" rel="noopener">http://www.thymeleaf.org</a>â€</p></blockquote><p>ä¸»è¦æ˜¯è®© IDE è¯†åˆ« Thymeleaf å‘½åç©ºé—´ï¼Œè¿™æ ·åœ¨æ ‡ç­¾é‡Œè¾“å…¥ <code>th:</code> åï¼ŒIDE ä¼šæç¤ºç›¸åº”çš„è¯­æ³•ï¼Œæ–¹ä¾¿å¼€å‘ï¼ä¸åŠ å…¥è¿™å¥ä»£ç ä¹Ÿä¸ä¼šå½±å“ Thymeleaf æ¨¡æ¿å¼•æ“çš„æ¸²æŸ“ï¼Œä»¥åŠé¡µé¢çš„æ­£å¸¸æ˜¾ç¤ºã€‚</p><h2 id="æµ‹è¯•è®¿é—®"><a class="markdownIt-Anchor" href="#æµ‹è¯•è®¿é—®"></a> æµ‹è¯•è®¿é—®</h2><p>å¯åŠ¨æˆåŠŸåï¼Œè®¿é—® <a href="http://127.0.0.1:8080" target="_blank" rel="noopener">http://127.0.0.1:8080</a>ï¼Œå³å¯çœ‹åˆ°æ•ˆæœï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2018/12/28/167f29d06bc6aef7?w=800&amp;h=260&amp;f=png&amp;s=24948" alt="Hello Thymeleaf"></p><p>è®¿é—®ç»“æœï¼š<code>Hello Thymeleaf!</code></p><hr><h2 id="thymeleaf-å¸¸ç”¨è¯­æ³•"><a class="markdownIt-Anchor" href="#thymeleaf-å¸¸ç”¨è¯­æ³•"></a> Thymeleaf å¸¸ç”¨è¯­æ³•</h2><ul><li>JAVA æºç è·¯å¾„ï¼š<a href="https://github.com/y0ngb1n/spring-boot-samples/blob/master/spring-boot-thymeleaf/src/main/java/io/github/y0ngb1n/boot/thymeleaf/controller/TagsController.java" target="_blank" rel="noopener">TagsController.java</a></li><li>HTML æºç è·¯å¾„ï¼š<code>templates</code> ç›®å½•</li></ul><h3 id="è·å–å˜é‡å€¼"><a class="markdownIt-Anchor" href="#è·å–å˜é‡å€¼"></a> è·å–å˜é‡å€¼</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"'Hello! ' + $&#123;name&#125; + '!'"</span> &gt;</span>name<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºè·å–å˜é‡å€¼ç”¨ <code>$</code> ç¬¦å·ï¼Œå¯¹äº JavaBean çš„è¯ä½¿ç”¨ <code>å˜é‡å.å±æ€§å</code> æ–¹å¼è·å–ï¼Œè¿™ç‚¹å’Œ <code>EL</code> è¡¨è¾¾å¼ä¸€æ ·ã€‚</p><p>å¦å¤– <code>$</code> è¡¨è¾¾å¼åªèƒ½å†™åœ¨ <code>th</code> æ ‡ç­¾å†…éƒ¨ï¼Œä¸ç„¶ä¸ä¼šç”Ÿæ•ˆï¼Œä¸Šé¢ä¾‹å­å°±æ˜¯ä½¿ç”¨ <code>th:text</code> æ ‡ç­¾çš„å€¼æ›¿æ¢ <code>&lt;p&gt;...&lt;/p&gt;</code> æ ‡ç­¾é‡Œé¢çš„å€¼ï¼Œè‡³äº <code>p</code> é‡Œé¢çš„åŸæœ‰çš„å€¼åªæ˜¯ä¸ºäº†ç»™å‰ç«¯å¼€å‘æ—¶åšå±•ç¤ºç”¨çš„ã€‚è¿™æ ·çš„è¯å¾ˆå¥½çš„åšåˆ°äº†å‰åç«¯åˆ†ç¦»ã€‚</p><h3 id="å†…å®¹ä¿¡æ¯è¾“å‡ºthtext-ä¸-thutext"><a class="markdownIt-Anchor" href="#å†…å®¹ä¿¡æ¯è¾“å‡ºthtext-ä¸-thutext"></a> å†…å®¹ä¿¡æ¯è¾“å‡ºï¼š<code>th:text</code> ä¸ <code>th:utext</code></h3><ul><li><code>th:text</code>ï¼šä»¥çº¯æ–‡æœ¬çš„æ–¹å¼è¾“å‡º</li><li><code>th:utext</code>ï¼šä»¥ HTML æ ‡ç­¾çš„æ–¹å¼è¾“å‡ºï¼Œæµè§ˆå™¨èƒ½æ­£å¸¸æ¸²æŸ“</li></ul><p><img src="https://user-gold-cdn.xitu.io/2018/12/28/167f29d09e569d7d?w=800&amp;h=279&amp;f=png&amp;s=54278" alt="th:text ä¸ th:utext"></p><p>HTML ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">th:text</span>=<span class="string">"' th:text &amp;nbsp Â» ' + $&#123;content&#125;"</span>&gt;</span>ä»¥çº¯æ–‡æœ¬çš„æ–¹å¼è¾“å‡º<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">th:utext</span>=<span class="string">"'th:utext      Â» ' + $&#123;content&#125;"</span>&gt;</span>ä»¥ HTML æ ‡ç­¾çš„æ–¹å¼è¾“å‡ºï¼Œæµè§ˆå™¨èƒ½æ­£å¸¸æ¸²æŸ“<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>JAVA ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/text-utext"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">textAndutext</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">  model.addAttribute(<span class="string">"content"</span>, <span class="string">"&lt;span style='color:red'&gt;thymeleaf text output&lt;/span&gt;"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"text-utext"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¼•ç”¨-url"><a class="markdownIt-Anchor" href="#å¼•ç”¨-url"></a> å¼•ç”¨ URL</h3><p>å¯¹äº URL çš„å¤„ç†æ˜¯é€šè¿‡è¯­æ³• <code>@{â€¦}</code> æ¥å¤„ç†çš„ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2018/12/28/167f29d09d1c6e2b?w=800&amp;h=454&amp;f=png&amp;s=110715" alt="å¼•ç”¨ URL"></p><p>HTML ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;https://github.com/&#123;username&#125;(username=$&#123;username&#125;)&#125;"</span>&gt;</span>ç»å¯¹è·¯å¾„ 1<span class="tag">&lt;/<span class="name">a</span>&gt;</span>ï¼Œ</span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;https://www.baidu.com&#125;"</span>&gt;</span>ç»å¯¹è·¯å¾„ 2<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/&#125;"</span>&gt;</span>ç›¸å¯¹è·¯å¾„<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/css/app.css&#125;"</span>&gt;</span>Content è·¯å¾„ï¼Œé»˜è®¤è®¿é—® static ä¸‹çš„ CSS æ–‡ä»¶<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>JAVA ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/refer-url"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">referUrl</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">  model.addAttribute(<span class="string">"username"</span>, <span class="string">"y0ngb1n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"refer-url"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼çš„æ ‡ç­¾æœ‰ï¼š<code>th:href</code> å’Œ <code>th:src</code></p><h3 id="å­—ç¬¦ä¸²æ›¿æ¢"><a class="markdownIt-Anchor" href="#å­—ç¬¦ä¸²æ›¿æ¢"></a> å­—ç¬¦ä¸²æ›¿æ¢</h3><p>å¾ˆå¤šæ—¶å€™å¯èƒ½æˆ‘ä»¬åªéœ€è¦å¯¹ä¸€å¤§æ®µæ–‡å­—ä¸­çš„æŸä¸€å¤„åœ°æ–¹è¿›è¡Œæ›¿æ¢ï¼Œå¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œå®Œæˆï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"'Welcome to our application, ' + $&#123;user.name&#125; + '!'"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨å¦ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"|Welcome to our application, $&#123;user.name&#125;!|"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ–‡å­—æ›¿æ¢æœ¬èº«å¯ä»¥å’Œä¸å…¶ä»–è¡¨è¾¾å¼è”åˆä½¿ç”¨ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;onevar&#125; + ', ' + |$&#123;twovar&#125;, $&#123;threevar&#125;|"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶è¿™ç§å½¢å¼é™åˆ¶æ¯”è¾ƒå¤šï¼Œ<code>|â€¦|</code> ä¸­åªèƒ½åŒ…å«å˜é‡è¡¨è¾¾å¼ <code>${â€¦}</code>ï¼Œä¸èƒ½åŒ…å«å…¶ä»–å¸¸é‡ã€æ¡ä»¶è¡¨è¾¾å¼ç­‰ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2018/12/28/167f29d4b1ace12d?w=800&amp;h=394&amp;f=png&amp;s=101765" alt="å­—ç¬¦ä¸²æ›¿æ¢"></p><p>HTML ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"'Welcome to our application, ' + $&#123;user.name&#125; + '!'"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"|Welcome to our application, $&#123;user.name&#125;!|"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;onevar&#125; + ', ' + |$&#123;twovar&#125;, $&#123;threevar&#125;|"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>JAVA ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"replace-text"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">replaceText</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">  model.addAttribute(<span class="string">"user"</span>, user);</span><br><span class="line">  model.addAttribute(<span class="string">"onevar"</span>, <span class="string">"one"</span>);</span><br><span class="line">  model.addAttribute(<span class="string">"twovar"</span>, <span class="string">"two"</span>);</span><br><span class="line">  model.addAttribute(<span class="string">"threevar"</span>, <span class="string">"three"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"replace-text"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#è¿ç®—ç¬¦"></a> è¿ç®—ç¬¦</h3><p>åœ¨è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç”¨å„ç±»ç®—æœ¯è¿ç®—ç¬¦ï¼Œä¾‹å¦‚ <code>+, -, *, /, %</code>ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">th:with="isEven=($&#123;user.age&#125; % 2 == 0)"</span><br></pre></td></tr></table></figure><p>é€»è¾‘è¿ç®—ç¬¦ <code>&gt;, &lt;, &lt;=, &gt;=, ==, !=</code> éƒ½å¯ä»¥ä½¿ç”¨ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨ <code>&lt;, &gt;</code> æ—¶éœ€è¦ç”¨å®ƒçš„ HTML è½¬ä¹‰ç¬¦ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">th:if="$&#123;user.age&#125; &amp;gt; 1"</span><br><span class="line">th:text="'Environment is ' + (($&#123;env&#125; == 'dev') ? 'Development' : 'Production')"</span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2018/12/28/167f29d078ecb48a?w=800&amp;h=438&amp;f=png&amp;s=107960" alt="è¿ç®—ç¬¦"></p><p>HTML ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">th:text</span>=<span class="string">"|name: $&#123;user.name&#125;, age: $&#123;user.age&#125;, env: $&#123;env&#125;|"</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:with</span>=<span class="string">"isEven=($&#123;user.age&#125; % 2 == 0)"</span>&gt;</span>å¹´é¾„ä¸ºå¶æ•°<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:with</span>=<span class="string">"isEven=($&#123;user.age == 18&#125;)"</span>&gt;</span>å“Ÿï¼Œæ‰ 18 å‘ï¼<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">"$&#123;user.age&#125;  &amp;gt; 18"</span>&gt;</span>å½“å‰å¹´é¾„å¤§äº 18<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:class</span>=<span class="string">"$&#123;env&#125; == 'dev' ? 'dev' : 'prod'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"'å½“å‰ç¯å¢ƒï¼š' + (($&#123;env&#125; == 'dev') ? 'Development' : 'Production')"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>JAVA ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/operator"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">operator</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">  model.addAttribute(<span class="string">"user"</span>, user);</span><br><span class="line">  model.addAttribute(<span class="string">"env"</span>, <span class="string">"dev"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"operator"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¡ä»¶åˆ¤æ–­"><a class="markdownIt-Anchor" href="#æ¡ä»¶åˆ¤æ–­"></a> æ¡ä»¶åˆ¤æ–­</h3><h4 id="thif-thunless"><a class="markdownIt-Anchor" href="#thif-thunless"></a> <code>th:if, th:unless</code></h4><p>ä½¿ç”¨ <code>th:if</code> å’Œ <code>th:unless</code> å±æ€§è¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæ ‡ç­¾åªæœ‰åœ¨ <code>th:if</code> ä¸­æ¡ä»¶æˆç«‹æ—¶æ‰æ˜¾ç¤ºï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/login&#125;"</span> <span class="attr">th:if</span>=<span class="string">$&#123;user</span> == <span class="string">null&#125;</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/login&#125;"</span> <span class="attr">th:unless</span>=<span class="string">$&#123;user</span> != <span class="string">null&#125;</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>th:unless</code> äº <code>th:if</code> æ°å¥½ç›¸åï¼Œåªæœ‰è¡¨è¾¾å¼ä¸­çš„æ¡ä»¶ä¸æˆç«‹ï¼Œæ‰ä¼šæ˜¾ç¤ºå…¶å†…å®¹ã€‚</p><h4 id="thswitch-thcase"><a class="markdownIt-Anchor" href="#thswitch-thcase"></a> <code>th:switch, th:case</code></h4><p>æ”¯æŒå¤šè·¯é€‰æ‹© Switch ç»“æ„ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:switch</span>=<span class="string">"$&#123;user.role&#125;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">"'admin'"</span>&gt;</span>User is an administrator<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">"#&#123;roles.manager&#125;"</span>&gt;</span>User is a manager<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é»˜è®¤å±æ€§ <code>default</code> å¯ä»¥ç”¨ <code>*</code> è¡¨ç¤ºï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:switch</span>=<span class="string">"$&#123;user.role&#125;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">"'admin'"</span>&gt;</span>User is an administrator<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">"#&#123;roles.manager&#125;"</span>&gt;</span>User is a manager<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">"*"</span>&gt;</span>User is some other thing<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>æ¶ˆæ¯è¡¨è¾¾å¼ï¼š<code>#{...}</code>ï¼Œä¹Ÿç§°ä¸ºæ–‡æœ¬å¤–éƒ¨åŒ–ã€å›½é™…åŒ–æˆ– i18n</p></blockquote><p><img src="https://user-gold-cdn.xitu.io/2018/12/28/167f29d09e1fe573?w=800&amp;h=438&amp;f=png&amp;s=100774" alt="æ¡ä»¶åˆ¤æ–­"></p><p>HTML ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/login&#125;"</span> <span class="attr">th:unless</span>=<span class="string">"$&#123;user == null&#125;"</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">"$&#123;user != null&#125;"</span>&gt;</span>æ¬¢è¿ï¼Œ<span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"|$&#123;user.name&#125;ï¼ˆrole: $&#123;user.role&#125;ï¼‰|"</span>&gt;</span>tony<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:switch</span>=<span class="string">"$&#123;user.role&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">"'admin'"</span>&gt;</span>User is an administrator<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">"#&#123;roles.manager&#125;"</span>&gt;</span>User is a manager<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">"*"</span>&gt;</span>User is some other thing<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>JAVA ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/condition"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">condition</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">  model.addAttribute(<span class="string">"user"</span>, user);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"condition"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¾ªç¯"><a class="markdownIt-Anchor" href="#å¾ªç¯"></a> å¾ªç¯</h3><p>æ¸²æŸ“åˆ—è¡¨æ•°æ®æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„åœºæ™¯ï¼Œä¾‹å¦‚ç°åœ¨æœ‰ n æ¡è®°å½•éœ€è¦æ¸²æŸ“æˆä¸€ä¸ªè¡¨æ ¼ï¼Œè¯¥æ•°æ®é›†åˆå¿…é¡»æ˜¯å¯ä»¥éå†çš„ï¼Œä½¿ç”¨ <code>th:each</code> æ ‡ç­¾ï¼š</p><p>HTML ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>NAME<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>AGE<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>ADMIN<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">"user : $&#123;users&#125;"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;user.name&#125;"</span>&gt;</span>Onions<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;user.age&#125;"</span>&gt;</span>22<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;user.role&#125; == 'admin' ? #&#123;true&#125; : #&#123;false&#125;"</span>&gt;</span>yes<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œéœ€è¦åœ¨è¢«å¾ªç¯æ¸²æŸ“çš„å…ƒç´ ï¼ˆè¿™é‡Œæ˜¯ï¼‰ä¸­åŠ å…¥ <code>th:each</code> æ ‡ç­¾ï¼Œå…¶ä¸­ <code>th:each=&quot;prod : ${prods}&quot;</code> æ„å‘³ç€å¯¹é›†åˆå˜é‡ <code>prods</code> è¿›è¡Œéå†ï¼Œå¾ªç¯å˜é‡æ˜¯ <code>prod</code> åœ¨å¾ªç¯ä½“ä¸­å¯ä»¥é€šè¿‡è¡¨è¾¾å¼è®¿é—®ã€‚</p><p>JAVA ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/loop"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">loop</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">  List&lt;User&gt; users = <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">  users.add(user);</span><br><span class="line">  users.add(User.builder().name(<span class="string">"tony"</span>).age(<span class="number">23</span>).role(<span class="string">"user"</span>).build());</span><br><span class="line">  users.add(User.builder().name(<span class="string">"tom"</span>).age(<span class="number">21</span>).role(<span class="string">"user"</span>).build());</span><br><span class="line"></span><br><span class="line">  model.addAttribute(<span class="string">"users"</span>, users);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"loop"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2018/12/28/167f29c578a82cd4?w=800&amp;h=596&amp;f=png&amp;s=133438" alt="å¾ªç¯"></p><blockquote><p>æ›´å¤šæ ‡ç­¾ç”¨æ³•è¯·å‚è€ƒã€Œ<a href="https://topsale.gitbooks.io/java-cloud-dubbo/content/chapter7/Thymeleaf%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95.html" target="_blank" rel="noopener">Thymeleaf å¸¸ç”¨è¯­æ³•</a>ã€ã€ã€Œ<a href="https://topsale.gitbooks.io/java-cloud-dubbo/content/chapter7/Thymeleaf%E5%8F%82%E8%80%83%E6%89%8B%E5%86%8C.html" target="_blank" rel="noopener">Thymeleaf å‚è€ƒæ‰‹å†Œ</a>ã€è§£é”æ›´å¤šæŠ€å·§ ğŸ˜œ</p></blockquote><hr><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><p><a href="https://segmentfault.com/a/1190000016284066" target="_blank" rel="noopener">Spring Bootï¼ˆå››ï¼‰æ¨¡æ¿å¼•æ“ Thymeleaf é›†æˆ</a></p></li><li><p><a href="https://www.baeldung.com/thymeleaf-in-spring-mvc" target="_blank" rel="noopener">Introduction to Using Thymeleaf in Spring</a></p></li><li><p><a href="http://www.funtl.com/2018/05/28/microservice/%E7%AC%AC%E4%B8%80%E4%B8%AA-Thymeleaf-%E6%A8%A1%E6%9D%BF%E9%A1%B5/" target="_blank" rel="noopener">ç¬¬ä¸€ä¸ª Thymeleaf æ¨¡æ¿é¡µ</a></p></li><li><p><a href="https://segmentfault.com/a/1190000011907375" target="_blank" rel="noopener">Spring Boot é¡¹ç›®æ­å»ºï¼ˆä¸‰ï¼‰æ•´åˆ Thymeleaf æ¨¡æ¿</a></p></li><li><p><a href="http://www.ityouknow.com/springboot/2016/05/01/spring-boot-thymeleaf.html" target="_blank" rel="noopener">Spring Bootï¼ˆå››ï¼‰Thymeleaf ä½¿ç”¨è¯¦è§£</a></p></li><li><p><a href="https://www.tianmaying.com/tutorial/using-thymeleaf" target="_blank" rel="noopener">æ–°ä¸€ä»£ Java æ¨¡æ¿å¼•æ“ Thymeleaf</a></p></li><li><p><a href="https://topsale.gitbooks.io/java-cloud-dubbo/content/chapter7/Thymeleaf%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95.html" target="_blank" rel="noopener">Thymeleaf å¸¸ç”¨è¯­æ³•</a></p></li><li><p><a href="https://topsale.gitbooks.io/java-cloud-dubbo/content/chapter7/Thymeleaf%E5%8F%82%E8%80%83%E6%89%8B%E5%86%8C.html" target="_blank" rel="noopener">Thymeleaf å‚è€ƒæ‰‹å†Œ</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Thymeleaf æ˜¯ä¸€ç§ Java XML / XHTML / HTML5 æ¨¡æ¿å¼•æ“ï¼Œå¯ä»¥åœ¨ Web å’Œé Web ç¯å¢ƒä¸­ä½¿ç”¨ã€‚å®ƒæ›´é€‚åˆåœ¨åŸºäº MVC çš„ Web åº”ç”¨ç¨‹åºçš„è§†å›¾å±‚æä¾› XHTML / HTML5ï¼Œä½†å³ä½¿åœ¨è„±æœºç¯å¢ƒä¸­ï¼Œå®ƒä¹Ÿå¯ä»¥å¤„ç†ä»»ä½•XMLæ–‡ä»¶ã€‚å®ƒæä¾›äº†å®Œ
      
    
    </summary>
    
    
      <category term="java" scheme="https://y0ngb1n.github.io/tags/java/"/>
    
      <category term="spring-boot" scheme="https://y0ngb1n.github.io/tags/spring-boot/"/>
    
      <category term="thymeleaf" scheme="https://y0ngb1n.github.io/tags/thymeleaf/"/>
    
  </entry>
  
</feed>
